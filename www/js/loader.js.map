{"version":3,"sources":["loader.js"],"names":["check","func","eval","e","tests","legacy","i","length","mediaURL","config","hard","HTTP","media","$script","require","window","loadModule","file","cb","url","clientHash","loadDep","base","end","lang"],"mappings":"CAIA,WAEC,QAASA,OAAMC,MACd,IACC,MAAOC,MAAK,eAAiBD,KAAO,SAErC,MAAME,GACL,OAAO,GAuBT,IAAK,GAnBDC,QAEH,wBAEA,qDAEA,uEAEA,yCAEA,iDAEA,6DAEA,0DAEA,uCAEGC,OACKC,EAAI,EAAGA,EAAIF,MAAMG,OAAQD,IACjC,IAAKN,MAAMI,MAAME,IAAK,CAErBD,QAAS,CACT,OAIF,GAAIG,UAAWC,OAAOC,KAAKC,KAAKC,MAC/BC,QAAUC,QAAQ,WAEnBC,QAAOC,WAAa,SAAUC,EAAMC,GACnC,GAAIC,GAAMX,SAAW,SAAWH,OAAS,IAAM,KAAO,IAAMY,EACzD,SAAWG,UACdP,SAAQM,EAAKD,IAGdH,OAAOM,QAAU,SAAUJ,EAAMC,GAC7BL,QAAQL,SAAW,aAAeS,EAAO,SAAWG,WAAYF,GAGpE,IAAII,MAAOd,SAAW,MACrBe,IAAM,SAAWH,UAClBP,SAAQS,KAAO,QAAUE,KAAOD,IAAK,WACpCP,WAAW","file":"loader.js","sourcesContent":["/*\nSelects and loads the client files\n */\n\n(function () {\n\t// Check for browser compatibility by trying to detect some ES6 features\n\tfunction check(func) {\n\t\ttry {\n\t\t\treturn eval('(function(){' + func + '})();')\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn false\n\t\t}\n\t}\n\n\tvar tests = [\n\t\t// Arrow functions\n\t\t'return (()=>5)()===5;',\n\t\t// Constants\n\t\t'\"use strict\"; const foo = 123; return foo === 123;',\n\t\t// Block scoping\n\t\t'\"use strict\";  const bar = 123; {const bar = 456;} return bar===123;',\n\t\t// Computed object properties\n\t\t\"var x='y';return ({ [x]: 1 }).y === 1;\",\n\t\t// Shorthand object properties\n\t\t\"var a=7,b=8,c={a,b};return c.a===7 && c.b===8;\",\n\t\t// Template strings\n\t\t'var a = \"ba\"; return `foo bar${a + \"z\"}` === \"foo barbaz\";',\n\t\t// for...of\n\t\t'var arr = [5]; for (var item of arr) return item === 5;',\n\t\t// Spread operator\n\t\t'return Math.max(...[1, 2, 3]) === 3'\n\t]\n\tvar legacy\n\tfor (var i = 0; i < tests.length; i++) {\n\t\tif (!check(tests[i])) {\n\t\t\t// Load client with full ES5 compliance\n\t\t\tlegacy = true\n\t\t\tbreak\n\t\t}\n\t}\n\n\tvar mediaURL = config.hard.HTTP.media,\n\t\t$script = require('scriptjs')\n\n\twindow.loadModule = function (file, cb) {\n\t\tvar url = mediaURL + 'js/es' + (legacy ? \"5\" : \"6\") + \"/\" + file\n\t\t\t+ \".js?v=\" + clientHash\n\t\t$script(url, cb)\n\t}\n\n\twindow.loadDep = function (file, cb) {\n\t    $script(mediaURL + \"js/vendor/\" + file + \".js?v=\" + clientHash, cb)\n\t}\n\n\tvar base = mediaURL + 'js/',\n\t\tend = '.js?v=' + clientHash\n\t$script(base + 'lang/' + lang + end, function () {\n\t\tloadModule(\"main\")\n\t})\n})()\n"],"sourceRoot":"/source/"}