{"version":3,"sources":["client/options/opts.js"],"names":[],"mappings":"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","file":"client/options/opts.js","sourcesContent":["import * as Cookie from 'js-cookie'\nimport {thumbStyles, resonableLastN, parseEl} from '../util'\nimport {config, isMobile} from '../state'\nimport {langApplied} from 'lang'\n\n// TODO: Send function\n\n/*\n * Full schema of the option interface\n *\n * - id: Identifier of the option. Used for DOM element and localStorage tagging\n * - type: 'checkbox'/'number'/'image'/'shortCut'/array of options\n *\tarrays become a selection list. Defaults to 'checkbox', if omitted.\n * - default: Default value. false, if omitted.\n * - tab: Index of the tab the option belong to.\n * - exec: Function to execute on option change.\n * - execOnStart: Boolean. Should the function be executed on model population?\n *\tDefaults to true.\n * - load: Condition to display and execute the option. Defaults to true(always)\n * - validation: Function that validates the users input. Returns a boolean.\n * - hidden: If true this option won't be shown to the user. Defaults to false\n *\n * Tooltips and lables are defined per language in `lang/`.\n * All arguments except for `id` and `tab` are optional.\n */\n\nconst notMobile = !isMobile\n\nconst opts = [\n\t// LANGUAGE SELECTION\n\t{\n\t\tid: 'lang',\n\t\ttype: config.lang.enabled,\n\t\ttab: 0,\n\t\tdefault: config.lang.default,\n\t\texecOnStart: false,\n\t\texec(type) {\n\t\t\talert(langApplied)\n\t\t\tlocation.reload()\n\t\t}\n\t},\n\t// INLINE EXPANSION\n\t{\n\t\tid: 'inlinefit',\n\t\ttype: ['none', 'full', 'width', 'height', 'both'],\n\t\ttab: 1,\n\t\tdefault: 'width'\n\t},\n\t// THUMBNAIL MODE\n\t{\n\t\tid: 'thumbs',\n\t\ttype: thumbStyles,\n\t\ttab: 1,\n\t\tdefault: 'small'\n\t},\n\t// IMAGE HOVER EXPANSION\n\t{\n\t\tid: 'imageHover',\n\t\tdefault: true,\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t{\n\t\tid: 'webmHover',\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t// Autogif TOGGLE\n\t{\n\t\tid: 'autogif',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t// SPOILER TOGGLE\n\t{\n\t\tid: 'spoilers',\n\t\ttab: 1,\n\t\tdefault: true\n\t},\n\t// LINKIFY TEXT URLS\n\t{\n\t\tid: 'linkify',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// DESKTOP NOTIFICATIONS\n\t{\n\t\tid: 'notification',\n\t\tload: notMobile,\n\t\ttab: 0,\n\t\texec(notifToggle) {\n\t\t\tif (notifToggle && (Notification.permission !== \"granted\"))\n\t\t\t\tNotification.requestPermission()\n\t\t}\n\t},\n\t// ANONIMISE ALL POSTER NAMES\n\t{\n\t\tid: 'anonymise',\n\t\ttab: 0\n\t},\n\t// RELATIVE POST TIMESTAMPS\n\t{\n\t\tid: 'relativeTime',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// R/A/DIO NOW PLAYING BANNER\n\t{\n\t\tid: 'nowPlaying',\n\t\tload: notMobile && config.radio,\n\t\ttab: 3,\n\t\tdefault: true,\n\t\texec(toggle) {\n\t\t\tif (toggle) {\n\t\t\t\t// Query the server for current stream info\n\t\t\t\tsend({type: 'radio'})\n\t\t\t} else {\n\n\t\t\t\t// TODO: System.import().then()\n\t\t\t\t//events.request('banner:radio:clear');\n\t\t\t}\n\t\t}\n\t},\n\t// ILLYA DANCE\n\t{\n\t\tid: 'illyaBGToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t{\n\t\tid: 'illyaMuteToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t// HORIZONTAL POSTING\n\t{\n\t\tid: 'horizontalPosting',\n\t\ttab: 3,\n\t\texec: toggleHeadStyle(\n\t\t\t'horizontal',\n\t\t\t'article,aside{display:inline-block;}'\n\t\t)\n\t},\n\t// REPLY AT RIGHT\n\t{\n\t\tid: 'replyright',\n\t\ttab: 1,\n\t\texec: toggleHeadStyle(\n\t\t\t'reply-at-right',\n\t\t\t'section>aside{margin: -26px 0 2px auto;}'\n\t\t)\n\t},\n\t// THEMES\n\t{\n\t\tid: 'theme',\n\t\ttype: [\n\t\t\t'moe', 'gar', 'mawaru', 'moon', 'ashita', 'console', 'tea',\n\t\t\t'higan', 'ocean', 'rave', 'tavern', 'glass'\n\t\t],\n\t\ttab: 1,\n\t\tdefault: config.defaultCSS,\n\t\texecOnStart: false,\n\t\texec(theme) {\n\t\t\tif (!theme) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tdocument.getElementById('theme')\n\t\t\t\t.setAttribute(\n\t\t\t\t\t'href',\n\t\t\t\t\t`/ass/css/${theme}.css`\n\t\t\t\t)\n\t\t}\n\t},\n\t// CUSTOM USER-SET BACKGROUND\n\t{\n\t\tid: 'userBG',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t{\n\t\tid: 'userBGimage',\n\t\tload: notMobile,\n\t\ttype: 'image',\n\t\ttab: 1,\n\t\texecOnStart: false,\n\t\texec(upload) {\n\t\t\t// TODO: System.import().then()\n\t\t\t//events.request('background:store', upload)\n\t\t}\n\t},\n\t// LAST N CONFIG\n\t{\n\t\tid: 'lastn',\n\t\ttype: 'number',\n\t\ttab: 0,\n\t\tvalidation: resonableLastN,\n\t\tdefault: 100\n\t},\n\t// KEEP THREAD LENGTH WITHIN LASTN\n\t/*\n\t Disabled, until dependancy features are implemnted (see issue #280)\n\t{\n\t\tid: 'postUnloading',\n\t\ttab: 0\n\t},*/\n\t// LOCK TO BOTTOM EVEN WHEN DOCUMENT HIDDEN\n\t{\n\t\tid: 'alwaysLock',\n\t\ttab: 0\n\t}\n]\n\n// IMAGE SEARCH LINK TOGGLE\nfor (let engine of ['google', 'iqdb', 'saucenao', 'desustorage', 'exhentai']) {\n\topts.push({\n\t\tid: engine,\n\t\t// Use a custom internatiolisation function\n\t\tlang: 'imageSearch',\n\t\ttab: 2,\n\t\tdefault: engine === 'google',\n\t\texec: toggleHeadStyle(engine + 'Toggle', `.${engine}{display:initial;}`)\n\t})\n}\n\n// SHORTCUT KEYS\nconst shorts = [\n\t{id: 'new', default: 78},\n\t{id: 'togglespoiler', default: 73},\n\t{id: 'textSpoiler', default: 68},\n\t{id: 'done', default: 83},\n\t{id: 'expandAll', default: 69},\n\t{id: 'workMode', default: 66}\n]\nfor (let short of shorts) {\n\tshort.type = 'shortcut'\n\tshort.tab = 4\n\tshort.load = notMobile\n\topts.push(short)\n}\n\n// Create a function to append and toggle a style element in <head>\nfunction toggleHeadStyle(id, css) {\n\treturn toggle => {\n\t\tif (!document.getElementById(id)) {\n\t\t\tdocument.head.appendChild(\n\t\t\t\tparseEl(`<style id=\"${id}\">${css}</style>`)\n\t\t\t)\n\t\t}\n\n\t\t// The disabled property only exists on elements in the DOM, so we do\n\t\t// another query\n\t\tdocument.getElementById(id).disabled = !toggle\n\t}\n}\n\n// Exports the generated option model templates\nexport default opts\n"],"sourceRoot":"/source/"}