{"version":3,"sources":["client/send.js"],"names":[],"mappings":"qHAIQ,8CAER,MAAM,KAAO,IAAI,cAAJ,EAAP,CAGC,SAAS,IAAT,CAAc,GAAd,CAAmB,SAAnB,CAA8B,CACpC,GAAI,CAAC,SAAD,CAAY,CACf,KAAK,KAAL,CAAW,WAAX,CAAuB,GAAvB,EADe,CAAhB,KAEO,CACN,KAAK,KAAL,CAAW,WAAX,CAAuB,GAAvB,CAA4B,SAA5B,EADM,CAFP,CADM,qBASP,SAAS,WAAT,EAAuB,CACtB,MAAM,KAAO,UAAU,aAAV,CAAwB,UAAxB,CADS,GAElB,CAAC,IAAD,CAAO,CACV,WAAW,WAAX,CAAwB,EAAxB,EADU,QAAX,IAIA,CAAK,WAAL,CAAiB,SAAS,IAAT,CAAe,CAAC,KAAK,KAAL,CAAjC,EANsB,CAAvB,WASA,GAEA,OAAO,gBAAP,CAAwB,cAAxB,CAAwC,MACvC,KAAK,QAAQ,UAAR,CADkC,CAAxC","file":"client/send.js","sourcesContent":["/*\n Communication with the ServiceWorker backend\n*/\n\nimport {message} from '../common'\n\nconst chan = new MessageChannel()\n\n// Send a message to the ServiceWorker thorough the private channel\nexport function send(msg, transfers) {\n\tif (!transfers) {\n\t\tchan.port1.postMessage(msg)\n\t} else {\n\t\tchan.port1.postMessage(msg, transfers)\n\t}\n}\n\n// Establish a private message channel with the ServiceWorker\nfunction connectToSW() {\n\tconst cont = navigator.serviceWorker.controller\n\tif (!cont) {\n\t\tsetTimeout(connectToSW, 10)\n\t\treturn\n\t}\n\tcont.postMessage(location.href, [chan.port2])\n}\n\nconnectToSW()\n\nwindow.addEventListener(\"beforeunload\", () =>\n\tsend(message.disconnect))\n"],"sourceRoot":"/source/"}