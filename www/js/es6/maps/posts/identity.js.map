{"version":3,"sources":["posts/identity.js"],"names":[],"mappings":"iGAII,SAAO,QAAQ,SAAR,CAAP,KACF,EAAgD,KAAhD,MAAG,QAA6C,KAA7C,YAAS,OAAoC,KAApC,WAAQ,MAA4B,KAA5B,UAAO,EAAqB,KAArB,MAAG,OAAkB,KAAlB,WAAQ,OAAU,KAAV,OAExC,SAAS,IAAT,EAAgB,CACf,GAAI,CACH,MAAM,GAAK,KAAK,KAAL,CAAW,aAAa,KAAb,CAAhB,CADH,GAEC,GAAG,IAAH,CACH,MAAM,GAAN,CAAU,GAAG,IAAH,CAAV,CADD,GAEI,GAAG,KAAH,CACH,OAAO,GAAP,CAAW,GAAG,KAAH,CAAX,CADD,CAJD,MAOM,CAAN,CAAS,EAAT,CARD,IAWI,KAAO,EAAE,QAAF,CAAW,UAAW,CAChC,GAAI,CACH,MAAM,KAAO,MAAM,GAAN,EAAP,CADH,IAEC,MAAQ,OAAO,GAAP,EAAR,CAFD,GAIC,QAAU,OAAO,aAAP,CAAsB,CACnC,OAAO,GAAP,CAAW,EAAX,EADmC,OAEnC,CAAQ,0BAAR,EAFmC,KAGnC,CAAQ,KAAR,CAHmC,CAApC,GAMI,MAAQ,KAAR,CAAe,CAClB,IAAI,GAAK,EAAL,CADc,GAEd,IAAJ,CACC,GAAG,IAAH,CAAU,IAAV,CADD,GAEI,KAAJ,CACC,GAAG,KAAH,CAAW,KAAX,CADD,YAEA,CAAa,KAAb,CAAqB,KAAK,SAAL,CAAe,EAAf,CAArB,CANkB,CAAnB,KASC,aAAa,UAAb,CAAwB,OAAxB,EATD,CAVD,MAqBM,CAAN,CAAS,EAAT,CAtBqB,CAuBnB,IAvBQ,CAAP,CA0BJ,SAAS,SAAT,EAAqB,CACpB,IAAI,SAAW,KAAK,OAAL,CAAa,UAAb,CAAX,CADgB,GAEhB,QAAJ,CACC,SAAS,cAAT,GADD,IAEA,GAJoB,CAArB,IAOA,CAAK,KAAL,CAAW,UAAW,CACrB,OADqB,KAErB,CAAM,EAAN,CAAS,OAAT,CAAkB,SAAlB,EAFqB,MAGrB,CAAO,EAAP,CAAU,OAAV,CAAmB,SAAnB,EAHqB,CAAX,CAAX","file":"posts/identity.js","sourcesContent":["/*\n Name, email, tripcode and staff title persistence and postform propagation\n */\n\nlet main = require('../main'),\n\t{$, $script, $email, $name, _, common, config} = main;\n\nfunction load() {\n\ttry {\n\t\tconst id = JSON.parse(localStorage.ident);\n\t\tif (id.name)\n\t\t\t$name.val(id.name);\n\t\tif (id.email)\n\t\t\t$email.val(id.email);\n\t}\n\tcatch(e) {}\n}\n\nlet save = _.debounce(function() {\n\ttry {\n\t\tconst name = $name.val();\n\t\tlet email = $email.val();\n\t\t// Staff login method\n\t\tif (email === config.LOGIN_KEYWORD) {\n\t\t\t$email.val('');\n\t\t\t$script('/ass/js/scripts/login.js');\n\t\t\temail = false;\n\t\t}\n\n\t\tif (name || email) {\n\t\t\tlet id = {};\n\t\t\tif (name)\n\t\t\t\tid.name = name;\n\t\t\tif (email)\n\t\t\t\tid.email = email;\n\t\t\tlocalStorage.ident = JSON.stringify(id);\n\t\t}\n\t\telse\n\t\t\tlocalStorage.removeItem('ident');\n\t}\n\tcatch(e) {}\n}, 1000);\n\n// Sync persistance and postForm with input changes\nfunction propagate() {\n\tlet postForm = main.request('postForm');\n\tif (postForm)\n\t\tpostForm.renderIdentity();\n\tsave();\n}\n\nmain.defer(function() {\n\tload();\n\t$name.on('input', propagate);\n\t$email.on('input', propagate);\n});\n"],"sourceRoot":"/source/"}