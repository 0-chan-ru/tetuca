{"version":3,"sources":["posts/embed.js"],"names":[],"mappings":"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","file":"posts/embed.js","sourcesContent":["/*\nYoutube, soundcloud and pastebin link embeding\n */\n\n// TODO: DRY this shit\n\nlet main = require('../main'),\n\t{$, util} = main;\n\n// >80 char rule\nconst youtube_url_re = exports.youtube_url_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?youtube\\.com\\/watch\\/?\\?((?:[^\\s#&=]+=[^\\s#&]*&)*)?v=([\\w-]{11})((?:&[^\\s#&=]+=[^\\s#&]*)*)&?(#t=[\\dhms]{1,9})?/,\n\tyoutube_short_re = exports.youtube_short_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?youtu.be\\/([\\w-]{11})\\??(t=[\\dhms]{1,9})?/,\n\tyoutube_time_re = exports.youtube_time_re = /^#t=(?:(\\d\\d?)h)?(?:(\\d{1,3})m)?(?:(\\d{1,3})s)?$/,\n\tyoutube_short_time_re = exports.youtube_short_time_re = /^t=(?:(\\d\\d?)h)?(?:(\\d{1,3})m)?(?:(\\d{1,3})s)?$/;\n\nfunction make_video(id, params, start) {\n\tif (!params)\n\t\tparams = {allowFullScreen: 'true'};\n\tparams.allowScriptAccess = 'always';\n\tvar query = {\n\t\tautohide: 1,\n\t\tfs: 1,\n\t\tmodestbranding: 1,\n\t\torigin: document.location.origin,\n\t\trel: 0,\n\t\tshowinfo: 0\n\t};\n\tif (start)\n\t\tquery.start = start;\n\tif (params.autoplay)\n\t\tquery.autoplay = params.autoplay;\n\tif (params.loop) {\n\t\tquery.loop = '1';\n\t\tquery.playlist = id;\n\t}\n\n\treturn $('<iframe></iframe>', {\n\t\ttype: 'text/html',\n\t\tsrc: encodeURI('https://www.youtube.com/embed/' + id) + '?'\n\t\t\t+ $.param(query),\n\t\tframeborder: '0',\n\t\tattr: video_dims(),\n\t\tclass: 'youtube-player'\n\t});\n}\n\nfunction video_dims() {\n\tif (window.screen && screen.width <= 320)\n\t\treturn {width: 250, height: 150};\n\telse\n\t\treturn {width: 560, height: 340};\n}\n\nmain.$threads.on('click', '.watch', function(e) {\n\tif (e.which > 1 || e.metaKey || e.ctrlKey || e.altKey || e.shiftKey)\n\t\treturn;\n\tvar $target = $(e.target);\n\n\t// maybe squash that double-play bug? ugh, really\n\tif (!$target.is('a'))\n\t\treturn;\n\n\tvar $video = $target.find('iframe');\n\tif ($video.length) {\n\t\t$video.siblings('br').andSelf().remove();\n\t\t$target.css('width', 'auto');\n\t\treturn false;\n\t}\n\tif ($target.data('noembed'))\n\t\treturn;\n\t//check if longURL, if that fails, check if shortURL\n\tvar m = $target.attr('href').match(youtube_url_re);\n\tif (!m) {\n\t\tm = $target.attr('href').match(youtube_short_re);\n\t\tif (!m)\n\t\t// Shouldn't happen, but degrade to normal click action\n\t\t\treturn;\n\t\ttimeCall(m[1],m[2],youtube_short_time_re);\n\t}\n\ttimeCall(m[2],m[4],youtube_time_re);\n\tfunction timeCall(url, time, timeRex){\n\t\tvar start = 0;\n\t\tif (time){\n\t\t\tvar t = time.match(timeRex);\n\t\t\tif (t) {\n\t\t\t\tif (t[1])\n\t\t\t\t\tstart += parseInt(t[1], 10) * 3600;\n\t\t\t\tif (t[2])\n\t\t\t\t\tstart += parseInt(t[2], 10) * 60;\n\t\t\t\tif (t[3])\n\t\t\t\t\tstart += parseInt(t[3], 10);\n\t\t\t}\n\t\t}\n\t\t$target\n\t\t\t.css('width', video_dims().width)\n\t\t\t.append('<br>', make_video(url, null, start))\n\t}\n\treturn false;\n});\n\nmain.$threads.on('mouseenter', '.watch', function (event) {\n\tvar $target = $(event.target);\n\tif ($target.data('requestedTitle'))\n\t\treturn;\n\t$target.data('requestedTitle', true);\n\t// Edit textNode in place so that we don't mess with the embed\n\tvar node = $target.contents().filter(function () {\n\t\treturn this.nodeType === 3;\n\t})[0];\n\tif (!node)\n\t\treturn;\n\tconst orig = node.textContent;\n\tnode.textContent = orig + '...';\n\tvar m = $target.attr('href').match(youtube_url_re);\n\tif (!m){\n\t\tm = $target.attr('href').match(youtube_short_re);\n\t\tif(!m)\n\t\t\treturn;\n\t\t$.ajax({\n\t\t\turl: '//gdata.youtube.com/feeds/api/videos/' + m[1],\n\t\t\tdata: {v: '2', alt: 'jsonc'},\n\t\t\tdataType: 'json',\n\t\t\tsuccess: gotInfo,\n\t\t\terror() {\n\t\t\t\tnode.textContent = orig + '???';\n\t\t\t}\n\t\t});\n\t}\n\n\t$.ajax({\n\t\turl: '//gdata.youtube.com/feeds/api/videos/' + m[2],\n\t\tdata: {v: '2', alt: 'jsonc'},\n\t\tdataType: 'json',\n\t\tsuccess: gotInfo,\n\t\terror() {\n\t\t\tnode.textContent = orig + '???';\n\t\t}\n\t});\n\t// Creates the Titles upon hover\n\t// NOTE: Condense gotInfos into single function\n\tfunction gotInfo(data) {\n\t\tvar title = data && data.data && data.data.title;\n\t\tif (title) {\n\t\t\tnode.textContent = orig + ': ' + title;\n\t\t\t$target.css({color: 'black'});\n\t\t}\n\t\telse\n\t\t\tnode.textContent = orig + ' (gone?)';\n\n\t\tif (data\n\t\t\t&& data.data\n\t\t\t&& data.data.accessControl\n\t\t\t&& data.data.accessControl.embed === 'denied'\n\t\t) {\n\t\t\tnode.textContent += ' (EMBEDDING DISABLED)';\n\t\t\t$target.data('noembed', true);\n\t\t}\n\t}\n});\n\nfunction make_embed(uri, params, dims) {\n\tvar $obj = $('<object/>', {attr: dims});\n\tfor (var name in params) {\n\t\t$('<param/>', {\n\t\t\tattr: {\n\t\t\t\tname: name,\n\t\t\t\tvalue: params[name]\n\t\t\t}\n\t\t}).appendTo($obj);\n\t}\n\t$('<embed/>', {\n\t\tsrc: uri,\n\t\ttype: 'application/x-shockwave-flash'\n\t})\n\t\t.attr(dims)\n\t\t.attr(params)\n\t\t.appendTo($obj);\n\treturn $obj;\n}\n\n/* SOUNDCLOUD */\n\nconst soundcloud_url_re = exports.soundcloud_url_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.)?soundcloud\\.com\\/([\\w-]{1,40}\\/[\\w-]{1,80})\\/?/;\n\nfunction fetchSoundcloud(target, width, cb) {\n\tconst url = 'https://soundcloud.com/oembed?url='\n\t\t+ encodeURIComponent(target.getAttribute('href'))\n\t\t+ `&maxwidth=${width}&maxheight=166&auto_play=true&format=json`\n\t\t+ '&show_comments=false';\n\tconst xhr = new XMLHttpRequest();\n\txhr.open('GET', url);\n\txhr.responseType = 'json';\n\txhr.onload = function () {\n\t\tif (this.status !== 200)\n\t\t\treturn cb(this.status);\n\t\tcb(null, this.response);\n\t};\n\txhr.send();\n}\n\nmain.$threads.on('click', '.soundcloud', function (e) {\n\tif (e.which > 1 || e.ctrlKey || e.altKey || e.shiftKey || e.metaKey)\n\t\treturn;\n\tconst {target} = e,\n\t\tiframe = target.query('iframe');\n\te.preventDefault();\n\tif (iframe) {\n\t\tiframe.previousElementSibling.remove();\n\t\tiframe.remove();\n\t\treturn;\n\t}\n\n\tconst width = Math.round(window.innerWidth * 0.75);\n\tfetchSoundcloud(target, width, (err, json) => {\n\t\tif (err)\n\t\t\treturn alert(err);\n\t\ttarget.append(document.createElement('br'));\n\t\ttarget.append(util.parseDOM(json.html));\n\t\ttarget.style.width = width + 'px';\n\t});\n});\n\nmain.$threads.on('mouseenter', '.soundcloud:not(.fetched)', function (event) {\n\tconst {target} = event,\n\t\tnode = target.firstChild,\n\t\ttext = node.textContent;\n\tnode.textContent = text + ' ...';\n\n\t// We should not be doing 2 separate fetches on mouseover and click, but\n\t// what if the user manages to click without mouseenter somehow?\n\tfetchSoundcloud(target, 1000, (err, json) => {\n\t\tif (err)\n\t\t\treturn node.textContent = `${text}: Error: ${err}`;\n\t\tnode.textContent = `${text}: ${json.title}`;\n\t\ttarget.style.color = 'black';\n\t\ttarget.classList.add('fetched');\n\t});\n});\n\n// PASTEBIN\nconst pastebin_re = exports.pastebin_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?pastebin\\.com\\/(.*)/;\n//Pastebin's API seems built for MAKING pastebins but not sharing them\n\n$(document).on('click', '.pastebin', function(event){\n\tif (event.which > 1 || event.ctrlKey || event.altKey || event.shiftKey || event.metaKey)\n\t\treturn;\n\tvar $target = $(event.target);\n\n\tvar $obj = $target.find('iframe');\n\tif ($obj.length) {\n\t\t$obj.siblings('br').andSelf().remove();\n\t\t$target.css({\n\t\t\twidth: 'auto',\n\t\t\theight: 'auto'\n\t\t});\n\t\treturn false;\n\t}\n\n\tvar m = $target.attr('href').match(pastebin_re);\n\tif (!m)\n\t\treturn;\n\tvar $window = $(window),\n\t\twidth = Math.round($window.innerWidth() * 0.65),\n\t\theight = Math.round($window.innerHeight() * 0.65);\n\t$target\n\t\t.css({\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t})\n\t\t.append('<br>', $('<iframe></iframe>', {\n\t\t\ttype: 'text/html',\n\t\t\tsrc: 'https://pastebin.com/embed_iframe.php?i='+ m[1],\n\t\t\tframeborder: '0',\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t}))\n\treturn false;\n});\n"],"sourceRoot":"/source/"}