{"version":3,"sources":["node_modules/browser-pack/_prelude.js","client/main/fsm.js","client/main/memory.js","client/main/modal.js","client/main/options/index.js","client/main/options/opts.js","client/main/options/render.js","client/main/scroll.js","client/main/state.js","client/main/util.js","client/main/main.js"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Finite State Machine\n */\nexport default class FSM {\n    /**\n     * Create a new finite state machine\n     * @param {string} start - Initial state\n     */\n    constructor(start) {\n        this.state = start\n        this.spec = {\n            acts: {},\n            ons: {},\n            wilds: {},\n            preflights: {}\n        }\n    }\n\n    /**\n     * Clone the current FSM\n     * @returns {FSM}\n     */\n    clone() {\n        const second = new FSM(this.state)\n        second.spec = this.spec\n        return second\n    }\n\n    /**\n     * Assign a handler to be execute on arrival to a new state\n     * @param {string} key - Target state\n     * @param {function} f - Handler\n     */\n    on(key, f) {\n        const ons = this.spec.ons[key]\n        if (ons) {\n            ons.push(f)\n        } else {\n            this.spec.ons[key] = [f]\n        }\n    }\n\n    /**\n     * Assign sanity check to perform before transition to a new state\n     * @param {string} key - Target state\n     * @param {function} f - Handler\n     */\n    preflight(key, f) {\n        const pres = this.spec.preflights[key]\n        if (pres) {\n            pres.push(f)\n        } else {\n            this.spec.preflights[key] = [f]\n        }\n    }\n\n    /**\n     * Specify transition and an optional handler to execute on it\n     * @param {string} trans_spec - Transition specification\n     * @param {function=} on_func - Handler\n     */\n    act(trans_spec, on_func) {\n        const halves = trans_spec.split('->')\n        if (halves.length != 2) {\n            throw new Error(\"Bad FSM spec: \" + trans_spec)\n        }\n        const parts = halves[0].split(','),\n            dest = halves[1].match(/^\\s*(\\w+)\\s*$/)[1]\n        let tok\n        for (let i = parts.length - 1; i >= 0; i--) {\n            const part = parts[i],\n                m = part.match(/^\\s*(\\*|\\w+)\\s*(?:\\+\\s*(\\w+)\\s*)?$/)\n            if (!m) {\n                throw new Error(\"Bad FSM spec portion: \" + part)\n            }\n            if (m[2]) {\n                tok = m[2]\n            }\n            if (!tok) {\n                throw new Error(\"Tokenless FSM action: \" + part)\n            }\n            const src = m[1]\n            if (src == '*') {\n                this.spec.wilds[tok] = dest\n            } else {\n                let acts = this.spec.acts[src]\n                if (!acts) {\n                    this.spec.acts[src] = acts = {}\n                }\n                acts[tok] = dest\n            }\n        }\n        if (on_func) {\n            this.on(dest, on_func)\n        }\n    }\n\n    /**\n     * Transition the FSM to a new state\n     * @param {string} ev - Target state\n     * @param {*} param - Argument for the handler functions\n     * @returns {bool} - Passed preflight sanity check, if any\n     */\n    feed(ev, param) {\n        const {spec} = this,\n            from = this.state,\n            acts = spec.acts[from],\n            to = (acts && acts[ev]) || spec.wilds[ev]\n        if (to && from != to) {\n            const ps = spec.preflights[to]\n            for (let i = 0; ps && i < ps.length; i++) {\n                if (!ps[i].call(this, param)) {\n                    return false\n                }\n            }\n            this.state = to\n            const fs = spec.ons[to]\n            for (let i = 0; fs && i < fs.length; i++) {\n                fs[i].call(this, param)\n            }\n        }\n        return true\n    }\n\n    /**\n     * Returns a function that executes FSM.prototype.feed with the suplied\n     * argument\n     * @param {string} ev - Target state\n     * @returns {function}\n     */\n    feeder(ev) {\n        return param =>  this.feed(ev, param)\n    }\n}\n","/*\n * Self-expiring localStorage key controller\n */\n\nlet main = require('./main'),\n\t{_, Cookie} = main;\n\nclass Memory {\n\tconstructor(key, expiry, needCookie) {\n\t\tthis.key = key;\n\t\tthis.expiry = expiry;\n\t\tthis.needCookie = needCookie;\n\t\tmain.defer(this.purgeExpired.bind(this));\n\t}\n\tbakeCookie(object) {\n\t\tif (!this.needCookie)\n\t\t\treturn;\n\t\tlet nums = Object.keys(object);\n\t\tnums.sort(function(a, b) {\n\t\t\treturn parseInt(a, 10) - parseInt(b, 10);\n\t\t});\n\t\tCookie.set(this.key, nums.join('/'));\n\t}\n\tnow() {\n\t\treturn Math.floor(Date.now() / 1000);\n\t}\n\tpurgeAll() {\n\t\tlocalStorage.removeItem(this.key);\n\t\tif (this.needCookie)\n\t\t\tCookie.remove(this.key);\n\t}\n\treadAll() {\n\t\tconst key = localStorage.getItem(this.key);\n\t\tif (!key)\n\t\t\treturn {};\n\t\tlet val;\n\t\ttry {\n\t\t\tval = JSON.parse(key);\n\t\t}\n\t\tcatch(e) {}\n\t\treturn _.isObject(val) ? val : {};\n\t}\n\twriteAll(object) {\n\t\tif (_.isEmpty(object))\n\t\t\treturn this.purgeAll();\n\t\tlocalStorage.setItem(this.key, JSON.stringify(object));\n\t\tthis.bakeCookie(object)\n\t}\n\twrite(key) {\n\t\tlet object = this.readAll();\n\t\tobject[key] = this.now();\n\t\tthis.writeAll(object);\n\t\t// Return number of keys\n\t\treturn _.size(object);\n\t}\n\tsize() {\n\t\treturn _.size(this.readAll());\n\t}\n\tpurgeExpired() {\n\t\tif (!this.expiry)\n\t\t\treturn;\n\t\tlet object = this.readAll();\n\t\tconst now = this.now(),\n\t\t\tlimit = 86400 * this.expiry;\n\t\tlet expired = [];\n\t\tfor (let key in object) {\n\t\t\tconst time = object[key];\n\t\t\tif (time && now > time + limit)\n\t\t\t\texpired.push(key);\n\t\t}\n\t\tif (!expired.length)\n\t\t\treturn;\n\t\tfor (let i = 0, lim = expired.length; i < lim; i++) {\n\t\t\tdelete object[expired[i]];\n\t\t}\n\t\tthis.writeAll(object);\n\t}\n}\nmodule.exports = Memory;\n","/**\n * Various minor windows and the base view for all modals\n */\n\nimport {Backbone, defer} from 'main'\n\nexport default Backbone.View.extend({\n    className: 'modal bmodal glass',\n\n    /**\n     * Calls the subview-specific initialization methods\n     */\n    initialize() {\n        defer(() => {\n            this.render()\n            document.body.append(this.el)\n        })\n    }\n\n    // TODO: Add close button and unify modal structure\n\n})\n","/*\n * Houses both the actual options controler and the options panel renderring\n * logic\n */\n\nimport {_, Backbone, state, defer, events, util, ModalView} from 'main'\nimport opts from './opts'\nimport render from './render'\n\n// Try to get options from local storage\nlet options\ntry {\n\toptions = JSON.parse(localStorage.options)\n}\ncatch(e) {}\nif (!options) {\n\toptions = {}\n}\nexport default options = new Backbone.Model(options)\n\nconst optionModels = {}\n\n/**\n * Coontroler for each individual option\n */\nclass OptionModel {\n\t/**\n\t * Create new option model from template model\n\t * @param {Object} model\n\t */\n    constructor(model) {\n\t\t// Condition for loading option. Optional.\n\t\tif (model.load !== undefined && !model.load) {\n\t\t\treturn\n\t\t}\n\t\t_.extend(this, model)\n\n\t\t// No type = checkbox + default false\n\t\tif (!this.type) {\n\t\t    this.type = 'checkbox'\n\t\t}\n\n\t\t// Store option value in central stotage options Backbone model\n\t\tconst val = options.attributes[this.id] = this.get()\n\t\toptions.on('change:' + this.id, (options, val) =>\n\t\t\tthis.onChange(val))\n\t\tif (this.execOnStart !== false) {\n\t\t    this.execute(val)\n\t\t}\n\t\toptionModels[this.id] = this\n    }\n\n\t/**\n\t * Read value from localStorage\n\t * @returns {string}\n\t */\n\tread() {\n\t    return localStorage.getItem(this.id)\n\t}\n\n\t/**\n\t * Retrieve option value from storage and parse result. If none, return\n\t * default.\n\t * @returns {string|bool|int}\n\t */\n\tget() {\n\t\tconst stored = this.read()\n\t    if (!stored) {\n\t        return this.default\n\t    } else {\n\t\t\tif (stored === 'false') {\n\t\t        return false\n\t\t    }\n\t\t\tif (stored === \"true\") {\n\t\t        return true\n\t\t    }\n\t\t\tconst num = parseInt(stored, 10)\n\t\t\tif (num || num === 0) {\n\t\t\t    return num\n\t\t\t}\n\t\t\treturn this.default\n\t\t}\n\t}\n\n\t/**\n\t * Handler to be executed on field change in central options storage model\n\t * @param {*} val\n\t */\n\tonChange(val) {\n\t    this.execute(val)\n\t\tthis.set(val)\n\t}\n\n\t/**\n\t * Execute handler function, if any\n\t * @param {*} val\n\t */\n\texecute(val) {\n\t    if (this.exec) {\n\t        this.exec(val)\n\t    }\n\t}\n\n\t/**\n\t * Write value to localStorage, if needed\n\t * @param {*} val\n\t */\n\tset(val) {\n\t    if (val !== this.default || this.read()) {\n\t        localStorage.setItem(this.id, val)\n\t    }\n\t}\n\n\t/**\n\t * Perform value validation, if any. Othervise return true.\n\t * @param {*} val\n\t * @returns {bool}\n\t */\n\tvalidate(val) {\n\t    if (this.validation) {\n\t        return this.validation(val)\n\t    }\n\t\treturn true\n\t}\n}\n\n// Highlight options button by fading out and in, if no options are set\n(function() {\n\tif (localStorage.getItem('options')) {\n\t\treturn\n\t}\n\tconst el = document.query('#options')\n\tel.style.opacity = 1\n\tlet out = true,\n\t\tclicked\n\tel.addEventListener(\"click\", () => clicked = true)\n\ttick()\n\n\tfunction tick() {\n\t\t// Stop\n\t\tif (clicked) {\n\t\t    el.style.opacity = 1\n\t\t\treturn\n\t\t}\n\n    \tel.style.opacity = +el.style.opacity + (out ? -0.02 : 0.02)\n\t\tconst now = +el.style.opacity\n\n\t\t// Reverse direction\n\t\tif ((out && now <= 0) || (!out && now >= 1)) {\n\t\t    out = !out\n\t\t}\n\t\trequestAnimationFrame(tick)\n\t}\n})()\n\n// View of the options panel\nconst OptionsView = ModalView.extend({\n\tid: 'options-panel',\n\n\tevents: {\n\t\t'click .option_tab_sel>li>a': 'switchTab',\n\t\t'change': 'applyChange',\n\t\t'click #export': 'export',\n\t\t'click #import': 'import',\n\t\t'click #hidden': 'clearHidden'\n\t},\n\n\t/**\n\t * Render the options panel. Only called once on page load.\n\t */\n\trender() {\n\t    this.el.innerHTML = render()\n\t\tthis.assignValues()\n\t\tthis.hidden = this.el.query('#hidden')\n\t\tevents.reply('hide:render', this.renderHidden, this)\n\t},\n\n\t/**\n\t * Assign loaded option settings to the respective elements in the options\n\t * panel\n\t */\n\tassignValues() {\n\t\tfor (let id in optionModels) {\n\t\t\tconst model = optionModels[id],\n\t\t\t\tel = this.el.query('#' + id)\n\t\t\tconst {type} = model,\n\t\t\t\tval = model.get()\n\t\t\tif (type === 'checkbox') {\n\t\t\t    el.checked = val\n\t\t\t} else if (type === 'number' || type instanceof Array) {\n\t\t\t    el.value = val\n\t\t\t} else if (type === 'shortcut') {\n\t\t\t    el.value = String.fromCharCode(val).toUpperCase()\n\t\t\t}\n\n\t\t\t// 'image' type simply falls through, as those don't need to be set\n\t\t}\n\t},\n\n\t/**\n\t * Switch to a tab, when clicking the tab butt\n\t * @param {Event} event\n\t */\n\tswitchTab(event) {\n\t\tevent.preventDefault()\n\t\tconst el = event.target\n\n\t\t// Deselect previous tab\n\t\t_.each(this.el.children, el =>\n\t\t\tel.query('.tab_sel').classList.remove('tab_sel'))\n\n\t\t// Select the new one\n\t\tel.classList.add('tab_sel')\n\t\t_.find(this.el.lastChild.children, li =>\n\t\t\tli.classList.contains(el.getAttribute('data-content'))\n\t\t)\n\t\t\t.classList.add('tab_sel')\n\t},\n\n\t/**\n\t * Propagate options panel changes through\n\t * options -> optionModels -> localStorage\n\t * @param {Event} event\n\t */\n\tapplyChange(event) {\n\t\tconst el = event.target,\n\t\t\tid = el.getAttribute('id'),\n\t\t\tmodel = optionModels[id]\n\t\tlet val\n\t\tswitch (model.type) {\n\t\t\tcase 'checkbox':\n\t\t\t\tval = el.checked\n\t\t\t\tbreak\n\t\t\tcase 'number':\n\t\t\t\tval = parseInt(el.value)\n\t\t\t\tbreak\n\t\t\tcase 'image':\n\t\t\t\t// Not recorded. Extracted directly by the background handler.\n\t\t\t\treturn events.request('background:store', event.target)\n\t\t\tcase 'shortcut':\n\t\t\t\tval = el.value.toUpperCase().charCodeAt(0)\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tval = el.value\n\t\t}\n\n\t\tif (!model.validate(val)) {\n\t\t\tel.value = ''\n\t\t} else {\n\t\t\toptions.set(id, val)\n\t\t}\n\t},\n\n\t/**\n\t * Dump options to JSON file and upload to user\n\t */\n\texport() {\n\t\tconst a = document.getElementById('export')\n\t\ta.setAttribute('href', window.URL\n\t\t\t.createObjectURL(new Blob([JSON.stringify(localStorage)], {\n\t\t\t\ttype: 'octet/stream'\n\t\t\t}))\n\t\t)\n\t\ta.setAttribute('download', 'meguca-config.json')\n\t},\n\n\t/**\n\t * Import options from uploaded JSON file\n\t * @param {Event} event\n\t */\n\timport(event) {\n\t\t// Proxy to hidden file input\n\t\tevent.preventDefault()\n\t\tconst el = document.query('#importSettings')\n\t\tel.click()\n\t\tutil.once(el, 'change', () => {\n\t\t\tvar reader = new FileReader()\n\t\t\treader.readAsText(input.files[0])\n\t\t\treader.onload = event => {\n\t\t\t\t// In case of curruption\n\t\t\t\tlet json\n\t\t\t\ttry {\n\t\t\t\t\tjson = JSON.parse(event.target.result)\n\t\t\t\t}\n\t\t\t\tcatch(err) {\n\t\t\t\t\talert('Import failed. File corrupt')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tlocalStorage.clear()\n\t\t\t\tfor (let key in json) {\n\t\t\t\t\tlocalStorage[key] = json[key]\n\t\t\t\t}\n\t\t\t\talert('Import successfull. The page will now reload.')\n\t\t\t\tlocation.reload()\n\t\t\t};\n\t\t})\n\t},\n\n\t/**\n\t * Render Hiden posts counter\n\t * @param {int} count\n\t */\n\trenderHidden(count) {\n\t\tconst el = this.hidden\n\t\tel.textContent = el.textContent.replace(/\\d+$/, count)\n\t},\n\n\t/**\n\t * Clear displayed hidden post counter\n\t */\n\tclearHidden() {\n\t\tmain.request('hide:clear')\n\t\tthis.renderHidden(0)\n\t}\n})\n\n// Create and option model for each object in the array\nfor (let spec of opts) {\n\tnew OptionModel(spec)\n}\n\n// Expensive comutation and not emediatly needed. Put off till later.\ndefer(() => new OptionsView())\n","/*\n * This file is used by both the client to populate the Backbone models and the\n * server to render the actual options panel.\n */\n\nimport {\n\tCookie, util, state, config, isMobile, lang, send, events,cssHash\n} from 'main'\n\n/*\n * Full schema of the option interface\n *\n * - id: Identifier of the option. Used for DOM element and localStorage tagging\n * - type: 'checkbox'/'number'/'image'/'shortCut'/array of options\n *\tarrays become a selection list. Defaults to 'checkbox', if omitted.\n * - default: Default value. false, if omitted.\n * - tab: Index of the tab the option belong to.\n * - exec: Function to execute on option change.\n * - execOnStart: Boolean. Should the function be executed on model population?\n *\tDefaults to true.\n * - load: Condition to display and execute the option. Defaults to true(always)\n * - validation: Function that validates the users input. Returns a boolean.\n * - hidden: If true this option won't be shown to the user. Defaults to false\n *\n * Tooltips and lables are defined per language in `lang/`.\n * All arguments except for `id` and `tab` are optional.\n */\n\nconst notMobile = !isMobile\n\nconst opts = [\n\t// LANGUAGE SELECTION\n\t{\n\t\tid: 'lang',\n\t\ttype: config.lang.enabled,\n\t\ttab: 0,\n\t\tdefault: config.lang.default,\n\t\texecOnStart: false,\n\t\texec(type) {\n\t\t\talert(lang.langApplied)\n\t\t\tlocation.reload()\n\t\t}\n\t},\n\t// INLINE EXPANSION\n\t{\n\t\tid: 'inlinefit',\n\t\ttype: ['none', 'full', 'width', 'height', 'both'],\n\t\ttab: 1,\n\t\tdefault: 'width'\n\t},\n\t// THUMBNAIL MODE\n\t{\n\t\tid: 'thumbs',\n\t\ttype: util.thumbStyles,\n\t\ttab: 1,\n\t\tdefault: 'small'\n\t},\n\t// IMAGE HOVER EXPANSION\n\t{\n\t\tid: 'imageHover',\n\t\tdefault: true,\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t{\n\t\tid: 'webmHover',\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t// Autogif TOGGLE\n\t{\n\t\tid: 'autogif',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t// SPOILER TOGGLE\n\t{\n\t\tid: 'spoilers',\n\t\ttab: 1,\n\t\tdefault: true\n\t},\n\t// LINKIFY TEXT URLS\n\t{\n\t\tid: 'linkify',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// DESKTOP NOTIFICATIONS\n\t{\n\t\tid: 'notification',\n\t\tload: notMobile,\n\t\ttab: 0,\n\t\texec(notifToggle) {\n\t\t\tif (notifToggle && (Notification.permission !== \"granted\"))\n\t\t\t\tNotification.requestPermission()\n\t\t}\n\t},\n\t// ANONIMISE ALL POSTER NAMES\n\t{\n\t\tid: 'anonymise',\n\t\ttab: 0\n\t},\n\t// RELATIVE POST TIMESTAMPS\n\t{\n\t\tid: 'relativeTime',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// R/A/DIO NOW PLAYING BANNER\n\t{\n\t\tid: 'nowPlaying',\n\t\tload: notMobile && config.radio,\n\t\ttab: 3,\n\t\tdefault: true,\n\t\texec(toggle) {\n\t\t\tif (toggle) {\n\t\t\t\t// Query the server for current stream info\n\t\t\t\tsend({type: 'radio'})\n\t\t\t} else {\n\t\t\t\tevents.request('banner:radio:clear');\n\t\t\t}\n\t\t}\n\t},\n\t// ILLYA DANCE\n\t{\n\t\tid: 'illyaBGToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t{\n\t\tid: 'illyaMuteToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t// HORIZONTAL POSTING\n\t{\n\t\tid: 'horizontalPosting',\n\t\ttab: 3,\n\t\texec: toggleHeadStyle(\n\t\t\t'horizontal',\n\t\t\t'article,aside{display:inline-block;}'\n\t\t)\n\t},\n\t// REPLY AT RIGHT\n\t{\n\t\tid: 'replyright',\n\t\ttab: 1,\n\t\texec: toggleHeadStyle(\n\t\t\t'reply-at-right',\n\t\t\t'section>aside{margin: -26px 0 2px auto;}'\n\t\t)\n\t},\n\t// THEMES\n\t{\n\t\tid: 'theme',\n\t\ttype: [\n\t\t\t'moe', 'gar', 'mawaru', 'moon', 'ashita', 'console', 'tea',\n\t\t\t'higan', 'ocean', 'rave', 'tavern', 'glass'\n\t\t],\n\t\ttab: 1,\n\t\tdefault: config.defaultCSS,\n\t\texec(theme) {\n\t\t\tif (!theme) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tdocument.getElementById('theme')\n\t\t\t\t.setAttribute(\n\t\t\t\t\t'href',\n\t\t\t\t\t`${config.mediaURL}css/${theme}.css?v=${cssHash}`\n\t\t\t\t)\n\t\t}\n\t},\n\t// CUSTOM USER-SET BACKGROUND\n\t{\n\t\tid: 'userBG',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t{\n\t\tid: 'userBGimage',\n\t\tload: notMobile,\n\t\ttype: 'image',\n\t\ttab: 1,\n\t\texecOnStart: false,\n\t\texec(upload) {\n\t\t\tevents.request('background:store', upload)\n\t\t}\n\t},\n\t// LAST N CONFIG\n\t{\n\t\tid: 'lastn',\n\t\ttype: 'number',\n\t\ttab: 0,\n\t\tvalidation: util.resonableLastN,\n\t\tdefault: 100\n\t},\n\t// KEEP THREAD LENGTH WITHIN LASTN\n\t/*\n\t Disabled, until dependancy features are implemnted (see issue #280)\n\t{\n\t\tid: 'postUnloading',\n\t\ttab: 0\n\t},*/\n\t// LOCK TO BOTTOM EVEN WHEN DOCUMENT HIDDEN\n\t{\n\t\tid: 'alwaysLock',\n\t\ttab: 0\n\t}\n]\n\n// IMAGE SEARCH LINK TOGGLE\nfor (let engine of ['google', 'iqdb', 'saucenao', 'desustorage', 'exhentai']) {\n\topts.push({\n\t\tid: engine,\n\t\t// Use a custom internatiolisation function\n\t\tlang: 'imageSearch',\n\t\ttab: 2,\n\t\tdefault: engine === 'google',\n\t\texec: toggleHeadStyle(engine + 'Toggle', `.${engine}{display:initial;}`)\n\t})\n}\n\n// SHORTCUT KEYS\nconst shorts = [\n\t{id: 'new', default: 78},\n\t{id: 'togglespoiler', default: 73},\n\t{id: 'textSpoiler', default: 68},\n\t{id: 'done', default: 83},\n\t{id: 'expandAll', default: 69},\n\t{id: 'workMode', default: 66}\n]\nfor (let short of shorts) {\n\tshort.type = 'shortcut'\n\tshort.tab = 4\n\tshort.load = notMobile\n\topts.push(short)\n}\n\n/**\n * Create a function to append and toggle a style element in <head>\n */\nfunction toggleHeadStyle(id, css) {\n\treturn function (toggle) {\n\t\tif (!document.getElementById(id)) {\n\t\t\tdocument.head.appendChild(\n\t\t\t\tutil.parseEl(`<style id=\"${id}\">${css}</style>`)\n\t\t\t)\n\t\t}\n\n\t\t// The disabled property only exists on elements in the DOM, so we do\n\t\t// another query\n\t\tdocument.getElementById(id).disabled = !toggle\n\t}\n}\n\nexport default opts\n","import {_, isMobile, lang as ln, parseHTML} from 'main'\nimport {default as options} from \"./opts\"\n\nconst lang = ln.opts\n\n/**\n * Render the options panel\n */\nexport default function () {\n    let html = '<ul class=\"option_tab_sel\">'\n    const {tabs} = lang,\n        opts = []\n\n    // Render tab butts\n    for (let i = 0; i < tabs.length; i++) {\n        // Pick the options for this specific tab, according to current\n        // template and server configuration\n        opts[i] = _.filter(options, opt =>\n            opt.tab === i\n                && (opt.load === undefined  || opt.load)\n                && !opt.hidden)\n\n        if (!opts[i].length) {\n            continue\n        }\n        html += `<li><a data-content=\"tab-${i}\"`\n\n        // Highlight the first tabButt by default\n        if (i === 0) {\n            html += ' class=\"tab_sel\"'\n        }\n\n        html += `>${tabs[i]}</a></li>`;\n    }\n\n    html += '</ul><ul class=\"option_tab_cont\">'\n    for (let i = 0; i < opts.length; i++) {\n        html += renderTab(opts[i], i)\n    }\n    html += '</ul>'\n\n    return html\n}\n\n/**\n * Render tab contents\n */\nfunction renderTab(opts, i) {\n    if (!opts.length) {\n        return ''\n    }\n    let html = \"\"\n    html += `<li class=\"tab-${i}`\n\n    // Show the first tab by default\n    if (i === 0) {\n        html += ' tab_sel'\n    }\n    html += '\">'\n\n    // Render the actual options\n    for (let opt of opts) {\n        html += renderOption(opt)\n    }\n\n    if (i === 0) {\n        html += renderExtras()\n    }\n    html += '</li>'\n\n    return html\n}\n\n/**\n * Render a single option from it's schema\n */\nfunction renderOption(opt) {\n\tlet html = ''\n\tconst isShortcut = opt.type === 'shortcut',\n\t\tisList = opt.type instanceof Array,\n\t\tisCheckbox = opt.type === 'checkbox' || opt.type === undefined,\n\t\tisNumber = opt.type === 'number',\n\t\tisImage = opt.type === 'image'\n\tif (isShortcut) {\n        html += 'Alt+'\n    }\n\tif (!isList) {\n\t\thtml += '<input'\n\t\tif (isCheckbox || isImage)\n\t\t\thtml += ` type=\"${(isCheckbox ? 'checkbox' : 'file')}\"`\n\t\telse if (isNumber)\n\t\t\thtml += ' style=\"width: 4em;\" maxlength=\"4\"'\n\t\telse if (isShortcut)\n\t\t\thtml += ' maxlength=\"1\"'\n\t} else {\n        html += '<select'\n    }\n\n\tconst [label,title] = lang.labels[opt.id]\n\thtml += ` id=\"${opt.id}\" title=\"${title}\">`\n\n\tif (isList) {\n\t\tfor (let item of opt.type) {\n\t\t\thtml += parseHTML\n                `<option value=\"${item}\">\n                    ${lang.modes[item] || item}\n                </option>`\n\t\t}\n\t\thtml += '</select>'\n\t}\n\thtml += `<label for=\"${opt.id}\" title=\"${title}\">${label}</label><br>`\n\n\treturn html\n}\n\n/**\n * Hidden post reset, Export and Import links to first tab\n */\nfunction renderExtras() {\n\tlet html = '<br>'\n\tconst links = ['export', 'import', 'hidden']\n    for (let id of links) {\n        const [label, title] = lang.labels[id]\n        html += `<a id=\"${id}\" title=\"${title}\">${label}</a> `\n    }\n\n    // Hidden file input for uploading the JSON\n    const attrs = {\n        type: 'file',\n        id: 'importSettings',\n        name: \"Import Settings\"\n    }\n\thtml += parseHTML`<input ${attrs}>`\n\n    return html\n}\n","/*\n * Various page scrolling logic\n */\n\nimport {Backbone, options, state, $threads, $banner, events} from 'main'\n\nlet atBottom, lockIndicator, isThread\n\n/**\n * Write the current state to variables\n */\nfunction cacheState() {\n\tlockIndicator = document.query('#lock')\n\tisThread = !!state.posts.get('thread')\n}\n\n// Recache state on page change\nstate.page.on('change', cacheState)\ncacheState()\n\n/**\n * Set the scroll lock position to a post or to the bottom of the document\n */\nfunction checkBottom() {\n\tconst height = document.body.scrollHeight - window.innerHeight\n\tatBottom = height <= window.scrollY\n\tif (lockIndicator) {\n\t\tlockIndicator.style.visibility = atBottom ? 'visible' : 'hidden'\n\t}\n}\n\ncheckBottom()\ndocument.addEventListener('scroll', checkBottom)\n\n// Cache previous reference element to minimize DOM lookup\nlet referenceEl\n\n/**\n * Lock position to the bottom of a thread or keep the viewport from bumping\n * on out of sight DOM mutation.\n * @param {function} func\n * @returns {*}\n */\nexport function followDOM(func) {\n\tconst previous = referenceDistance(),\n\t\tret = func()\n\n\t// Prevent scrolling with new posts, if page isn't visible\n\tif (atBottom && (!document.hidden || options.get('alwaysLock'))) {\n\t\twindow.scrollTo(0,  document.body.scrollHeight)\n\t} else {\n\t\t// Element was removed or something\n\t\tif (!elExists(referenceEl)) {\n\t\t\treturn ret\n\t\t}\n\n\t\t// Only compensate, if the height increased above the viewport\n\t\tconst delta = topDistance(referenceEl, true) - previous\n\t\tif (delta) {\n\t\t\twindow.scrollBy(0, delta)\n\t\t}\n\t}\n\treturn ret\n}\n\n/**\n * Check if element reference exists and is in the DOM\n * @param {Element} el\n */\nfunction elExists(el) {\n\treturn el && document.contains(el)\n}\n\n/**\n * Return element position dimentions against the viewport, if the element\n * is withing the viewport\n * @param {Element} el\n * @param {bool} skipCheck\n * @returns {(Number|null)}\n */\nfunction topDistance(el, skipCheck) {\n\tconst {top} = el.getBoundingClientRect()\n\tif (skipCheck || (top >= 0 && top < window.innerHeight)) {\n\t\treturn top\n\t}\n\treturn null\n}\n\n/**\n * Returns distance of viewport to with current reference element\n * @returns {(Number|null)}\n */\nfunction referenceDistance() {\n\tif (elExists(referenceEl)) {\n\t\tconst bounds = topDistance(referenceEl)\n\t\tif (bounds !== null) {\n\t\t\treturn bounds\n\t\t}\n\t}\n\n\t// Find new reference element (first inside viewport). Account for empty\n\t// threads and boards with no artciles or sections.\n\tfor (let selector of ['article', 'section', 'threads']) {\n\t\tfor (let el of $threads.queryAll(selector)) {\n\t\t\tconst bounds = topDistance(el)\n\t\t\tif (bounds !== null) {\n\t\t\t\treferenceEl = el\n\t\t\t\treturn bounds\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Account for banner height, when scrolling to an anchor\n */\nfunction aboveBanner (){\n\tif (!/^#p\\d+$/.test(location.hash)) {\n\t\treturn\n\t}\n\tconst anchor = document.query(location.hash)\n\tif (!anchor) {\n\t\treturn\n\t}\n\twindow.scrollTo(0, topDistance(anchor) - $banner.height)\n}\nevents.reply('scroll:aboveBanner', aboveBanner)\nwindow.onload = aboveBanner\n","/*\n * Central model keeping the state of the page\n */\n\nimport {_, Backbone, Memory, events} from 'main'\n\n// Read page state by parsing a URL\nexport function read(href) {\n\tconst state = {\n\t\tboard: href.match(/\\/([a-zA-Z0-9]+?)\\//)[1],\n\t\tthread: href.match(/\\/(\\d+)(:?#\\d+)?(?:[\\?&]\\w+=\\w+)*$/),\n\t\t// Displayed last N posts setting on thread pages\n\t\tlastN: href.match(/[\\?&]last=(\\d+)/)\n\t}\n\tfor (let key of ['thread', 'lastN']) {\n\t\tconst val = state[key]\n\t    state[key] = val ? parseInt(val[1]) : 0\n\t}\n\treturn state\n}\n\n// Initial page state\nexport const page = new Backbone.Model(read(location.href))\n\n// Hot-reloadable configuration\n\n// TODO: We need actual listeners to this model for hot reloads\n\n// Tracks the synchronisation counter of each thread\nexport let syncs = {}\n\n// Posts I made in this tab\nexport const ownPosts = {}\n\n// remember which posts are mine for two days\nexport const mine = new Memory('mine', 2, true)\n\n// All posts currently displayed\nexport const posts = new Backbone.Collection()\n\nevents.on('state:clear', () => {\n\t/*\n\t * Emptying the whole element should be faster than removing each post\n\t * individually through models and listeners\n\t */\n\tmain.$threads.innerHTML = ''\n\n\t// The <threads> tag has already been emptied, no need to perform\n\t// element removal with the default `.remove()` method\n\tmodels.each(model =>\n\t\tmodel.dispatch('stopListening'))\n\n\tposts.reset()\n\n\t// Prevent old threads from syncing\n\texports.syncs = {}\n\tmain.request('massExpander:unset')\n})\n\n// Post links verified server-side\nexport const links = {}\n\nexport function addLinks(addition) {\n\tif (addition) {\n\t\t_.extend(links, addition);\n\t}\n}\n","/*\n Client-side helper functions\n */\n\nimport {_, config, state} from 'main'\n\n/**\n * Make spoiler tags toggleable on mobile\n * @param {Element}\n */\nexport function touchable_spoiler_tag(del) {\n\tdel.html = '<del onclick=\"void(0)\">'\n}\n\n/**\n * Return image upload URL\n * @returns {string}\n */\nexport function imageUploadURL() {\n\treturn (config.hard.HTTP.upload || '../upload/') + '?id='\n\t\t+ state.page.get('connID')\n}\n\n/**\n * Retrieve post number of post element\n * @param {Element} el\n * @returns {int}\n */\nexport function getNum(el) {\n\tif (!el) {\n\t    return 0\n\t}\n\treturn parseInt(el.getAttribute('id').slice(1), 10)\n}\n\n/**\n * Retrieve post number of closest parent post\n * @param {Element} el\n * @returns {int}\n */\nexport function getID(el) {\n\tif (!el) {\n    \treturn 0\n\t}\n\treturn getNum(el.closest('article, section'))\n}\n\n/**\n * Retrieve model of closest parent post\n * @param {Element} el\n * @returns {(Backbone.Model|null)}\n */\nexport function getModel(el) {\n\tconst id = getID(el)\n\tif (!id)\n\t\treturn null\n\treturn state.posts.get(id)\n}\n\n/**\n * Parse HTML string to node array\n * @param {string} string\n * @returns {Element[]}\n */\nexport function parseEls(string) {\n\tconst el = document.createElement('div')\n\tel.innerHTML = string\n\tconst children = el.childNodes\n\treturn Array.from(children)\n}\n\n/**\n * Parse HTML string to Element\n * @param {string} string\n * @returns {Element}\n */\nexport function parseEl(string) {\n\tconst el = document.createElement('div')\n\tel.innerHTML = string\n\treturn el.firstChild\n}\n\n/**\n * Add an event listener that filters targets according to a CSS selector\n * @param {Element} el - Target element\n * @param {string} type - Event type\n * @param {string} selector - CSS selector\n * @param {function} handler - Callback function\n */\nexport function listener(el, type, selector, handler) {\n\tel.addEventListener(type, function (event) {\n\t\tif (event.target.matches(selector))\n\t\t\thandler.call(this, event)\n\t})\n}\n\n/**\n * Add event listener to element, that will only be executed once\n * @param {Element} el - Target element\n * @param {string} type\t- Event type\n * @param {function} handler - Callback function\n */\nexport function once(el, type, handler) {\n\tel.addEventListener(type, function (event) {\n\t\thandler.call(this, event)\n\t\tel.removeEventListener(type, handler)\n\t})\n}\n\n/**\n * Return width of element with padding and margin\n * @param {Element} el\n * @returns {int}\n */\nexport function outerWidth(el) {\n\tconst style =  getComputedStyle(el),\n\t\tprops = ['marginLeft', 'marginRight', 'paddingLeft','paddingRight']\n\tlet width = 0\n\tfor (let prop of props) {\n\t\twidth += parseInt(style[prop]);\n\t}\n\treturn width\n}\n\n/**\n * Confirms email is saging\n * @param {string} email\n * @returns {bool}\n */\nexport function isSage(email) {\n\treturn email && email.trim() === 'sage'\n}\n\n\n// TODO: Refactor server time syncronisation\nlet cachedOffset;\nexport function serverTime() {\n\tconst d = Date.now();\n\tif (imports.isNode)\n\t\treturn d;\n\n\t// The offset is intialised as 0, so there is something to return, until\n\t// we get a propper number from the server.\n\tif (!cachedOffset)\n\t\tcachedOffset = imports.main.request('time:offset');\n\treturn d + cachedOffset;\n}\n\nexport function readable_dice(bit, dice) {\n\tlet inner;\n\tswitch (bit) {\n\t\tcase '#flip':\n\t\t\tinner = (dice[2] == 2).toString();\n\t\t\tbreak;\n\t\tcase '#8ball':\n\t\t\tinner = imports.hotConfig.EIGHT_BALL[dice[2] - 1];\n\t\t\tbreak;\n\t\tcase '#pyu':\n\t\tcase '#pcount':\n\t\tcase '#q':\n\t\t\tinner = dice[0];\n\t\t\tbreak;\n\t}\n\tif (inner !== undefined)\n\t\treturn _.escape(`${bit} (${inner})`);\n\tif (/^#sw/.test(bit))\n\t\treturn readableSyncwatch(dice[0]);\n\treturn readableRegularDice(bit, dice);\n}\n\nfunction readableSyncwatch(dice) {\n\tdice.class = 'embed';\n\treturn parseHTML\n\t\t`<syncwatch ${dice}>\n\t\t\tsyncwatch\n\t\t</syncwatch>`;\n}\n\nfunction readableRegularDice(bit, [max, bias, ...rolls]) {\n\tbit += ' (';\n\tconst eq = rolls.length > 1 || bias;\n\tif (eq)\n\t\tbit += rolls.join(', ');\n\tif (bias)\n\t\tbit += (bias < 0 ? ' - ' + (-bias) : ' + ' + bias);\n\tlet sum = bias;\n\tfor (let roll of rolls) {\n\t\tsum += roll;\n\t}\n\treturn bit + (eq ? ' = ' : '') + sum + ')';\n}\n\nexport function pick_spoiler(metaIndex) {\n\tconst imgs = imports.config.SPOILER_IMAGES,\n\t\tn = imgs.length;\n\tlet i;\n\tif (metaIndex < 0)\n\t\ti = Math.floor(Math.random() * n);\n\telse\n\t\ti = metaIndex % n;\n\treturn {\n\t\tindex: imgs[i],\n\t\tnext: (i + 1) % n\n\t};\n}\n\nexport const thumbStyles = ['small', 'sharp', 'hide']\n\nexport function readable_filesize(size) {\n\t/* Dealt with it. */\n\tif (size < 1024)\n\t\treturn size + ' B';\n\tif (size < 1048576)\n\t\treturn Math.round(size / 1024) + ' KB';\n\tsize = Math.round(size / 104857.6).toString();\n\treturn size.slice(0, -1) + '.' + size.slice(-1) + ' MB';\n}\n\nexport function pad(n) {\n\treturn (n < 10 ? '0' : '') + n;\n}\n\n// Various UI-related links wrapped in []\nexport function action_link_html(href, name, id, cls) {\n\treturn parseHTML\n\t\t`<span class=\"act\">\n\t\t\t<a href=\"${href}\"\n\t\t\t\t${id && ` id=\"${id}\"`}\n\t\t\t\t${cls && ` class=\"${cls}\"`}\n\t\t\t>\n\t\t\t\t${name}\n\t\t\t</a>\n\t\t</span>`;\n}\n\n/**\n * Confirm last N posts to view setting matches bounds\n * @param {int} n\n * @returns {bool}\n */\nexport function resonableLastN(n) {\n\treturn Number.isInteger(n) && n <= 500\n}\n\nexport function parse_name(name) {\n\tvar tripcode = '', secure = '';\n\tvar hash = name.indexOf('#');\n\tif (hash >= 0) {\n\t\ttripcode = name.substr(hash + 1);\n\t\tname = name.substr(0, hash);\n\t\thash = tripcode.indexOf('#');\n\t\tif (hash >= 0) {\n\t\t\tsecure = _.escape(tripcode.substr(hash + 1));\n\t\t\ttripcode = tripcode.substr(0, hash);\n\t\t}\n\t\ttripcode = _.escape(tripcode);\n\t}\n\tname = name.trim().replace(imports.hotConfig.EXCLUDE_REGEXP, '');\n\treturn [\n\t\tname.substr(0, 100), tripcode.substr(0, 128),\n\t\tsecure.substr(0, 128)\n\t];\n}\n\n/**\n * Generate a random alphannumeric string of lower and upper case hexadecimal\n * characters\n * @param {int} len\t- String length\n * @returns {string}\n */\nexport function randomID(len) {\n\tlet id = ''\n\tfor (let i = 0; i < len; i++) {\n\t\tlet char = (Math.random() * 36).toString(36)[0]\n\t\tif (Math.random() < 0.5)\n\t\t\tchar = char.toUpperCase()\n\t\tid += char\n\t}\n\treturn id\n}\n\n/**\n * Template string tag function for HTML. Strips indentation and trailing\n * newlines. Based on https://gist.github.com/zenparsing/5dffde82d9acef19e43c\n * @param {*}\n * @returns {string}\n */\nexport function parseHTML(callSite) {\n\t// if arguments.length === 1\n\tif (typeof callSite === 'string') {\n\t\treturn formatHTML(callSite);\n\t}\n\n\t/*\n\t Slicing the arguments object is deoptimising, so we construct a new array\n\t instead.\n\t */\n\tconst len = arguments.length\n\tconst args = []\n\tfor (let i = 1; i < len; i++) {\n\t\targs[i - 1] = arguments[i]\n\t}\n\n\tif (typeof callSite === 'function') {\n\t\treturn formatHTML(callSite(args))\n\t}\n\n\tconst output = callSite\n\t\t.slice(0, len)\n\t\t.map((text, i) => {\n\t\t\tconst arg = args[i - 1]\n\t\t\tlet result\n\n\t\t\t/*\n\t\t\t Simplifies conditionals. If the placeholder returns a non-zero\n\t\t\t falsy value, it is ommitted.\n\t\t\t */\n\t\t\tif (i === 0 || (!arg && arg !== 0)) {\n\t\t\t\tresult = ''\n\t\t\t} else if (arg instanceof Object) {\n\t\t\t\tresult = elementAttributes(arg)\n\t\t\t} else {\n\t\t\t\tresult = arg\n\t\t\t}\n\n\t\t\treturn result + text\n\t\t})\n\t\t.join('')\n\n\treturn formatHTML(output)\n}\n\n/**\n * Strip indentation and remove empty lines from HTML string\n */\nfunction formatHTML(str) {\n\treturn str.replace(/\\s*\\n\\s*/g, '')\n}\n\n/**\n * Generate an HTML element attribute list\n */\nfunction elementAttributes(attrs) {\n\tlet html = ''\n\tfor (let key in attrs) {\n\t\thtml += ' '\n\t\tconst val = attrs[key]\n\t\tif (val === true)\n\t\t\thtml += key\n\t\telse if (val || val === 0)\n\t\t\thtml += `${key}=\"${val}\"`\n\t}\n\treturn html\n}\n\n/**\n * Makes a ', ' seperated list out of on array of strings\n * @param {string[]} items\n * @returns {string}\n */\nexport function commaList(items) {\n\tlet html = ''\n\tfor (let item of items) {\n\t\t// Falsy value. Skip item.\n\t\tif (!item && item !== 0)\n\t\t\tcontinue\n\t\tif (html)\n\t\t\thtml += ', '\n\t\thtml += item\n\t}\n\treturn html\n}\n\n/**\n * Acertains client has the proper authorisation to perfrom task. This is only\n * for rendering. The same validation is performed server-side.\n * @param {string} action - Privilidged action to check permission for\n * @returns {bool}\n */\nexport function checkAuth(action) {\n\tconst cls = config.staff.classes[main.ident && main.ident.auth]\n    return cls && !!cls.rights[action]\n}\n","/*\n * Loads the dependancies in order and aggregates exports from various modules\n */\n\n// NOTE: The entire bundle uses strict mode through the Babel transpiler\n\n/*\n * Because we are going to attach listeners to these all over the place, have\n * to load soome core modules in specific order. Also avoids nasty circular\n * dependancy, by placing some of the exports here and not in child modules.\n */\nconst _ = require('underscore'),\n\tBackbone = require('backbone'),\n\tCookie = require('js-cookie'),\n\tradio = require('backbone.radio')\n\nimport FSM from './fsm'\n\n// Load standard library ES6 polyfills\nrequire('core-js')\n// Load DOM level 4 polyfill\nrequire('dom4')\n// Load Backbone.View native JS replacement\nrequire('backbone.nativeview')\nBackbone.View = Backbone.NativeView\n\n// Central aplication object\nconst main = module.exports = {\n\t// Bind dependancies to main object for pretier destructuring requires\n\t_, Backbone, Cookie, FSM,\n\t$script: require('scriptjs'),\n\tSockJS: require('sockjs-client'),\n\n\t// Message and event bus\n\tevents: radio.channel('main'),\n\n\t/*\n\t Ofload expensive and not that neccessary initialisation logic till\n\t after the core modules are started\n\t */\n\t_deferred: [],\n\tdefer(func) {\n\t\tmain._deferred.push(func)\n\t\treturn main\n\t},\n\texecDefered() {\n\t\tfor (let func of this._deferred) {\n\t\t\tfunc()\n\t\t}\n\t},\n\n\t// Websocket call handler map. Store them here, to avoid requiring\n\t// modules in the wrong order.\n\tdispatcher: {}\n}\n\n// Import configuration variables from the template HTML\n_.extend(main, {config, configHash, clientHash, isMobile})\n\n// Clear cookies, if versions mismatch. Get regenerated each client start\n// anyway.\nconst cookieVersion = 3\nif (localStorage.cookieVersion != cookieVersion) {\n\tfor (let cookie in Cookie.get()) {\n\n\t\t// Clear legacy cookies that were set for each board separatly.\n\t\t// Otherwise, they would override the new ones.\n\t\tconst paths = main.config.boards.enabled.slice()\n\t\tpaths.push('', '/')\n\t\tfor (let path of paths) {\n\t\t\tCookie.remove(cookie, {path})\n\t\t}\n\t}\n\tlocalStorage.cookieVersion = cookieVersion\n}\n\n// You can invoke the client-side debug mode with the `debug=true` query string\nif (/[&\\?]debug=true/.test(location.href))\n\tmain.config.hard.debug = true\nif (main.config.hard.debug) {\n\tradio.DEBUG = true\n\twindow.Backbone = Backbone // Export Backbone instance for easier debugging\n\tradio.tuneIn('main') // Log all channel traffic\n}\n\n/*\n Core modules. The other will be more or less decoupled, but these are the\n monolithic foundation.\n */\nmain.Memory = require('./memory')\nconst lang = main.lang = require('lang'),\n\tstate = main.state = require('./state'),\n\tutil = main.util = require('./util')\n\n// Shorthands\nmain.send = main.events.request.bind(main.events, 'send')\nfor (let fn of ['parseHTML', 'parseEl', 'parseEls']) {\n    main[fn] = util[fn]\n}\nconfig.mediaURL = config.hard.HTTP.media\n\n/*\n// Initialise main rendering object\nlet oneeSama = main.oneeSama = new common.OneeSama({\n\top: state.page.get('thread'),\n\tlang,\n\t// Core post link handler\n\ttamashii(num) {\n\t\tlet frag;\n\t\tconst op = state.links[num];\n\t\tif (op) {\n\t\t\tconst desc = num in state.mine.readAll() && this.lang.you;\n\t\t\tfrag = this.postRef(num, op, desc);\n\t\t}\n\t\telse\n\t\t\tfrag = '>>' + num;\n\t\treturn frag;\n\t}\n});\n*/\n\nmain.ModalView = require('./modal').default\nmain.options = require('./options')\nmain.scroll = require('./scroll')\nmain.follow = main.scroll.followDOM // Shorthand\nstate.page.set('tabID', util.randomID(32))\n\n// Load language-specific CSS\ndocument.head.appendChild(util.parseEl(util.parseHTML\n\t`<style>\n\t\t.locked:after {\n\t\t\tcontent: \"${lang.thread_locked}\";\n\t\t}\n\t\t.locked > header nav:after {\n\t\t\tcontent: \" (${lang.locked})\";\n\t\t}\n\t</style>`))\n\n_.extend(main, {\n\t// Cached DOM elements\n\t$threads: document.query('threads'),\n\t$name: document.query('#name'),\n\t$email: document.query('#email'),\n\t$banner: document.query('#banner'),\n\n\tconnSM: new FSM('load'),\n\tpostSM: new FSM('none')\n})\n\n/*\n// 2nd tier dependacy modules. These are needed before the websocket\n// connection is opened, because they populate the dispatcher handler object.\n_.extend(main, {\n\tloop: require('./loop'),\n\ttime: require('./time'),\n\tamusement: require('./amusement')\n});\n\n// Load post models and views\nmain.posts = require('./posts')\nmain.Extract = require('./extract')\n// Start the client\nmain.client = require('./client')\nmain.conection = require('./connection')\n\n// Load independant auxilary modules\n_.extend(main, {\n\thistory: require('./history'),\n\thide: require('./hide')\n})\n*/\n\nmain.execDefered()\nmain.events.request('loading:hide')\n"]}