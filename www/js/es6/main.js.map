{"version":3,"sources":["node_modules/browser-pack/_prelude.js","client/main/amusement.js","client/main/client.js","client/main/common/index.js","client/main/common/oneesama.js","client/main/common/util.js","client/main/connection.js","client/main/extract.js","client/main/fsm.js","client/main/hide.js","client/main/history.js","client/main/loop.js","client/main/memory.js","client/main/options/index.js","client/main/options/opts.js","client/main/options/render.js","client/main/posts/article.js","client/main/posts/common.js","client/main/posts/embed.js","client/main/posts/identity.js","client/main/posts/imager.js","client/main/posts/index.js","client/main/posts/menu.js","client/main/posts/models.js","client/main/posts/nonce.js","client/main/posts/posting.js","client/main/posts/section.js","client/main/scroll.js","client/main/state.js","client/main/time.js","client/main/util.js","client/main/main.js"],"names":[],"mappings":"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","file":"main.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\n * Dice rolls and fun JS injections\n */\n\nconst main = require('./main'),\n\t{$, common, state, oneeSama} = main;\n\n// Render dice rolls and other hash commands\noneeSama.hook('imouto', function (imouto) {\n\timouto.queueRoll = function (bit) {\n\t\tconst number = this.allRolls.sent++;\n\t\tlet info = this.allRolls[number];\n\t\tif (!info)\n\t\t\tinfo = this.allRolls[number] = {};\n\t\tinfo.bit = bit;\n\t\tinfo.$tag = $(this.callback('<strong>'));\n\t\tthis.strong = true;\n\t\tthis.callback(info.dice ? common.readable_dice(bit, info.dice) : bit);\n\t\tthis.strong = false;\n\t\tthis.callback('</strong>');\n\t};\n\timouto.allRolls = {sent: 0, seen: 0};\n});\n\n// Handle dice in the postForm\noneeSama.hook('insertOwnPost', ({dice}) => {\n\tlet postForm = main.request('postForm');\n\tif (!postForm || !postForm.imouto || !dice)\n\t\treturn;\n\tlet rolls = postForm.imouto.allRolls;\n\tfor (let i = 0, lim = dice.length; i < lim; i++) {\n\t\tconst n = rolls.seen++;\n\t\tlet info = rolls[n];\n\t\tif (!info)\n\t\t\tinfo = rolls[n] = {};\n\t\tinfo.dice = dice[i];\n\t\tif (info.$tag) {\n\t\t\tconst r = common.readable_dice(info.bit, info.dice);\n\t\t\tinfo.$tag.html(r);\n\t\t}\n\t}\n});\n\n// Execute server-sent JS in fun threads\nmain.dispatcher[common.EXECUTE_JS] = ([js]) => {\n\ttry {\n\t\teval(js);\n\t}\n\tcatch (e) {\n\t\tconsole.error(e);\n\t}\n};\n","/*\n * Handles the brunt of the post-related websocket calls\n */\n\nconst main = require('./main'),\n\t{_, common, dispatcher, util, posts, state} = main;\n\nconst online = document.query('#onlineCount');\n\n_.extend(dispatcher, {\n\t[common.INSERT_POST](message) {\n\t\tlet [msg, bump] = message;\n\t\tbump = bump && state.page.get('live');\n\t\tconst isThread = !msg.op,\n\t\t\t{num} = msg;\n\t\tif (isThread)\n\t\t\tstate.syncs[num] = 1;\n\t\tmsg.editing = true;\n\n\t\t// Did I create this post?\n\t\tlet el;\n\t\tconst {nonce} = msg;\n\t\tdelete msg.nonce;\n\t\tconst myNonce = main.request('nonce:get')[nonce];\n\t\tif (myNonce && myNonce.tab === state.page.get('tabID')) {\n\t\t\t// posted in this tab; transform placeholder\n\t\t\tstate.ownPosts[num] = true;\n\t\t\tmain.oneeSama.trigger('insertOwnPost', msg);\n\t\t\tmain.postSM.feed('alloc', msg);\n\t\t\tbump = false;\n\t\t\tmain.request('nonce:destroy', nonce);\n\n\t\t\t// if we've already made a placeholder for this post, use it\n\t\t\tconst postForm = main.request('postForm');\n\t\t\tif (postForm && postForm.el)\n\t\t\t\tel = postForm.el;\n\t\t}\n\n\t\t// Add to my post set. Separate `if`, so posts form other tabs also\n\t\t// register.\n\t\tif (myNonce) {\n\t\t\tmsg.mine = true;\n\t\t\tstate.mine.write(num);\n\t\t}\n\t\tstate.addLinks(msg.links);\n\n\t\t// Create model\n\t\tconst model = new posts.models[isThread ? 'Thread' : 'Post'](msg);\n\t\tconst view = new posts[isThread ? 'Section' : 'Article']({model, el,\n\t\t\tid: num});\n\t\tif (!el)\n\t\t\tview.render().insertIntoDOM();\n\t\tview.clientInit();\n\n\t\tcheckRepliedToMe(msg.links, num);\n\t\tmain.request('post:inserted', model);\n\n\t\tif (isThread)\n\t\t\treturn;\n\t\tconst parent = state.posts.get(msg.op);\n\t\tif (!parent)\n\t\t\treturn;\n\t\tparent.get('replies').push(num);\n\t\tif (state.page.get('thread'))\n\t\t\treturn;\n\t\tparent.dispatch('shiftReplies');\n\n\t\t// Bump thread to page top\n\t\tif (bump)\n\t\t\tparent.dispatch('bumpThread');\n\t},\n\t[common.INSERT_IMAGE](msg) {\n\t\tconst [num, img] = msg;\n\n\t\t// Did I just upload this?\n\t\tconst postModel = main.request('postModel'),\n\t\t\ttoPostForm = postModel && postModel.get('num') == num;\n\t\tif (toPostForm)\n\t\t\tmain.request('postForm').insertUploaded(img);\n\n\t\t// If the image gets inseted into the postForm, we don't need the\n\t\t// generic model to fire a separate image render\n\t\tmodelHandler(num, model => model.setImage(img, toPostForm));\n\t},\n\t[common.UPDATE_POST]([num, frag, extra = {}]) {\n\t\tmodelHandler(num, model => {\n\t\t\tstate.addLinks(extra.links);\n\t\t\tmodel.update(frag, extra);\n\t\t\tcheckRepliedToMe(extra.links, num);\n\n\t\t\t// Am I updating my own post?\n\t\t\tif (num in state.ownPosts)\n\t\t\t\tmain.oneeSama.trigger('insertOwnPost', extra);\n\t\t\telse\n\t\t\t\tmodel.dispatch('updateBody', frag);\n\t\t});\n\t},\n\t[common.FINISH_POST](msg) {\n\t\tconst [num] = msg;\n\t\tdelete state.ownPosts[num];\n\t\tmodelHandler(num, function (model) {\n\t\t\t// No change event listener to avoid extra overhead\n\t\t\tmodel.set('editing', false);\n\t\t\tmodel.dispatch('renderEditing', false);\n\t\t});\n\t},\n\t[common.DELETE_POSTS](msg) {\n\t\tmodelHandler(msg[0], model => model.deletePost(msg[1]));\n\t},\n\t[common.LOCK_THREAD](msg) {\n\t\tmodelHandler(msg[0], model => model.toggleLocked(true, msg[1]));\n\t},\n\t[common.UNLOCK_THREAD](msg) {\n\t\tmodelHandler(msg[0], model => model.toggleLocked(false, msg[1]));\n\t},\n\t[common.DELETE_IMAGES](msg) {\n\t\tmodelHandler(msg[0], model => model.removeImage(msg[1]));\n\t},\n\t[common.SPOILER_IMAGES](msg) {\n\t\tmodelHandler(msg[0], model => model.setSpoiler(msg[1], msg[2]));\n\t},\n\t[common.BAN](msg) {\n\t\t// Only a 0 is passed to unauthenticated clients, if the ban was not\n\t\t// set to be displayed publicly. Otherwise a post number. A side\n\t\t// effect of complying to the existing pub/sub spec. Authenticated\n\t\t// staff receive either a post number or 0 and detailed ban information.\n\t\tlet [num, info] = msg;\n\t\tif (!num) {\n\t\t\tif (!info)\n\t\t\t\treturn;\n\t\t\tinfo = JSON.parse(info);\n\t\t\tnum = info.num;\n\t\t}\n\t\tmodelHandler(num, model => model.setBan(num, info));\n\t},\n\t[common.BACKLINK](msg) {\n\t\tmodelHandler(msg[0], model => model.addBacklink(msg[1], msg[2]));\n\t},\n\t[common.ONLINE_COUNT](msg) {\n\t\tonline.textContent = '['+msg[0]+']';\n\t},\n\t// Sync settings with server\n\t[common.HOT_INJECTION](msg) {\n\t\tconst [force, hash, hotConfig] = msg;\n\n\t\t// Request new varibles, if hashes don't match\n\t\tif (!force && hash !== state.configHash)\n\t\t\tmain.send([common.HOT_INJECTION, true]);\n\t\t// Update variables and hash\n\t\telse if (force) {\n\t\t\tstate.configHash = hash;\n\t\t\tstate.hotConfig.set(hotConfig);\n\t\t}\n\t}\n});\n\ndispatcher[common.SYNCHRONIZE] = main.connSM.feeder('sync');\ndispatcher[common.INVALID] = main.connSM.feeder('invalid');\n\n// Check if new posts links to one of my posts\nfunction checkRepliedToMe(links, sourceNum) {\n\tif (!links)\n\t\treturn;\n\tconst mine = state.mine.readAll();\n\tfor (let num in links) {\n\t\tif (num in mine)\n\t\t\tmain.request('repliedToMe', sourceNum);\n\t}\n}\n\n// Find model and pass it to function, if it exists\nfunction modelHandler(num, func) {\n\tconst model = state.posts.get(num);\n\tif (model)\n\t\tfunc(model);\n}\n\n// Make the text spoilers toggle revealing on click\nutil.listener(document, 'click', 'del', function (event) {\n\tif (event.spoilt)\n\t\treturn;\n\tevent.spoilt = true;\n\tevent.target.classList.toggle('reveal');\n});\n","/*\n This file is used both by the server and client\n Keep that in mind, when making modifications\n */\n\n// Export everything in one big object\nmodule.exports = exports = require('./util')\nexports.OneeSama = require('./oneesama')\n","/*\n Rendering singleton both server and client-side\n */\n\nconst _ = require('underscore'),\n\tindex = require('./index'),\n\tutil = require('./util'),\n\t{config} = imports,\n\t{pad, parseHTML} = util;\n\nconst break_re = new RegExp(\"(\\\\S{\" + index.WORD_LENGTH_LIMIT + \"})\");\n\n// `>>>/${link}/` referal links and embeds\nconst ref_re = (function () {\n\tlet ref_re = String.raw`>>(\\d+|>\\/watch\\?v=[\\w-]{11}(?:#t=[\\dhms]{1,9})?\n\t\t|>\\/soundcloud\\/[\\w-]{1,40}\\/[\\w-]{1,80}|>\\/pastebin\\/\\w+`\n\t\t\t.replace(/[\\n\\t]+/gm, '');\n\n\tfor (let board in config.link_targets) {\n\t\tref_re += String.raw`|>\\/${board}\\/(?:\\w+\\/?)?`;\n\t}\n\n\tref_re += ')';\n\treturn new RegExp(ref_re);\n})();\n\n// Generate the static part of image search links\nconst searchBase = (function() {\n\tconst models = [\n\t\t{\n\t\t\tclass: 'google',\n\t\t\turl: 'https://www.google.com/searchbyimage?image_url=',\n\t\t\ttype: 'thumb',\n\t\t\tsymbol: 'G'\n\t\t},\n\t\t{\n\t\t\tclass: 'iqdb',\n\t\t\turl: 'http://iqdb.org/?url=',\n\t\t\ttype: 'thumb',\n\t\t\tsymbol: 'Iq'\n\t\t},\n\t\t{\n\t\t\tclass: 'saucenao',\n\t\t\turl: 'http://saucenao.com/search.php?db=999&url=',\n\t\t\ttype: 'thumb',\n\t\t\tsymbol: 'Sn'\n\t\t},\n\t\t{\n\t\t\tclass: 'desustorage',\n\t\t\ttype: 'MD5',\n\t\t\turl: 'https://desustorage.org/_/search/image/',\n\t\t\tsymbol: 'Ds'\n\t\t},\n\t\t{\n\t\t\tclass: 'exhentai',\n\t\t\ttype: 'SHA1',\n\t\t\turl: 'http://exhentai.org/?fs_similar=1&fs_exp=1&f_shash=',\n\t\t\tsymbol: 'Ex'\n\t\t}\n\t];\n\n\tlet base = [];\n\tfor (let i = 0, l = models.length; i < l; i++) {\n\t\tlet model = models[i];\n\t\tbase[i] = [\n\t\t\tparseHTML\n\t\t\t`<a target=\"_blank\"\n\t\t\t\t\trel=\"nofollow\"\n\t\t\t\t\tclass=\"imageSearch ${model.class}\"\n\t\t\t\t\thref=\"${model.url}`,\n\t\t\tmodel.type,\n\t\t\t`\">${model.symbol}</a>`\n\t\t];\n\t}\n\treturn base;\n})();\n\nclass OneeSama {\n\tconstructor(args) {\n\t\t_.extend(this, args);\n\t\tthis.hooks = {};\n\t}\n\thook(name, func) {\n\t\tlet hs = this.hooks[name];\n\t\tif (!hs)\n\t\t\tthis.hooks[name] = [func];\n\t\telse if (hs.indexOf(func) < 0)\n\t\t\ths.push(func);\n\t}\n\ttrigger(name, param) {\n\t\tlet hs = this.hooks[name];\n\t\tif (!hs)\n\t\t\treturn;\n\t\tfor (var i = 0; i < hs.length; i++)\n\t\t\ths[i].call(this, param);\n\t}\n\t// Render OP\n\tsection(data, cls = '') {\n\t\tthis.setModel(data);\n\t\tif (data.locked)\n\t\t\tcls += ' locked';\n\t\tif (data.editing)\n\t\t\tcls += ' editing';\n\t\treturn parseHTML\n\t\t\t`<section id=\"p${data.num}\" class=\"${cls}\">\n\t\t\t\t<div class=\"background glass\">\n\t\t\t\t\t${this.monogatari(data)}\n\t\t\t\t\t<span class=\"omit\"></span>\n\t\t\t\t</div>\n\t\t\t</section>`;\n\t}\n\t// Render reply\n\tarticle(data) {\n\t\tthis.setModel(data);\n\t\tlet cls = 'glass';\n\t\tif (data.editing)\n\t\t\tcls += ' editing';\n\t\treturn parseHTML\n\t\t\t`<article id=\"p${data.num}\" class=\"${cls}\">\n\t\t\t\t${this.monogatari(data)}\n\t\t\t</article>`;\n\t}\n\t// Set the current model of the posts we are parsing\n\tsetModel(model) {\n\t\tthis.model = model;\n\n\t\t// Initial post state [new_line, no_qoute, no_spoiler, no_dice]\n\t\tthis.state = [0, 0, 0, 0];\n\t\treturn this;\n\t}\n\t// Render common post components\n\tmonogatari(data) {\n\t\tconst {image, mod, body, backlinks, banned} = data;\n\n\t\t// Larger thumbnails for thread images\n\t\tif (image && !data.op)\n\t\t\timage.large = true;\n\n\t\treturn parseHTML\n\t\t\t`${this.header(data)}\n\t\t\t${image && this.image(image)}\n\t\t\t<div class=\"container\">\n\t\t\t\t${mod && this.modInfo(mod)}\n\t\t\t\t<blockquote>\n\t\t\t\t\t${this.body(body)}\n\t\t\t\t</blockquote>\n\t\t\t\t<small>\n\t\t\t\t\t${this.backlinks(backlinks)}\n\t\t\t\t</small>\n\t\t\t\t${banned && this.banned()}\n\t\t\t</div>`;\n\t}\n\theader(data) {\n\t\treturn parseHTML\n\t\t\t`<header>\n\t\t\t\t<input type=\"checkbox\" class=\"postCheckbox\">\n\t\t\t\t${data.subject && `<h3>「${_.escape(data.subject)}」</h3>`}\n\t\t\t\t${this.name(data)}\n\t\t\t\t${this.time(data.time)}\n\t\t\t\t${this.postNavigation(data)}\n\t\t\t\t${!this.full && !data.op && this.expansionLinks(data.num)}\n\t\t\t</header>\n\t\t\t<span class=\"oi control\" data-glyph=\"chevron-bottom\"></span>`;\n\t}\n\tname(data) {\n\t\tlet html = '<b class=\"name';\n\t\tconst {auth, email} = data;\n\t\tif (auth)\n\t\t\thtml += ` ${auth === 'admin' ? 'admin' : 'moderator'}`;\n\t\thtml += '\">';\n\t\tif (email) {\n\t\t\thtml += parseHTML `<a ${{\n\t\t\t\tclass: 'email',\n\t\t\t\thref: 'mailto:' + encodeURI(email),\n\t\t\t\ttarget: 'blank'\n\t\t\t}}>`;\n\t\t}\n\t\thtml += this.resolveName(data);\n\t\tif (email)\n\t\t\thtml += '</a>';\n\t\thtml += '</b>';\n\t\tif (data.mnemonic)\n\t\t\thtml += ' ' + this.mnemonic(data.mnemonic);\n\t\treturn html;\n\t}\n\tresolveName(data) {\n\t\tlet html = '';\n\t\tconst {trip, name, auth} = data;\n\t\tif (name || !trip) {\n\t\t\tif (name)\n\t\t\t\thtml += _.escape(name);\n\t\t\telse\n\t\t\t\thtml += this.lang.anon;\n\t\t\tif(trip)\n\t\t\t\thtml += ' ';\n\t\t}\n\t\tif (trip)\n\t\t\thtml += `<code>${_.escape(trip)}</code>`;\n\t\tif (auth)\n\t\t\thtml += ` ## ${imports.hotConfig.staff_aliases[auth] || auth}`;\n\t\treturn html;\n\t}\n\ttime(time) {\n\t\t// Format according to client's relative post timestamp setting\n\t\tlet title, text;\n\t\tconst readable = this.readableTime(time);\n\t\tif (this.rTime) {\n\t\t\ttitle = readable;\n\t\t\ttext = this.relativeTime(time, Date.now());\n\t\t}\n\t\treturn parseHTML\n\t\t\t`<time title=\"${title}\">\n\t\t\t\t${text || readable}\n\t\t\t</time>`;\n\t}\n\treadableTime(time) {\n\t\tlet d = new Date(time);\n\t\treturn pad(d.getDate()) + ' '\n\t\t\t+ this.lang.year[d.getMonth()] + ' '\n\t\t\t+ d.getFullYear()\n\t\t\t+ `(${this.lang.week[d.getDay()]})`\n\t\t\t+`${pad(d.getHours())}:${pad(d.getMinutes())}`;\n\t}\n\treadableUTCTime(d, seconds) {\n\t\tlet html = pad(d.getUTCDate()) + ' '\n\t\t\t+ this.lang.year[d.getUTCMonth()] + ' '\n\t\t\t+ d.getUTCFullYear()\n\t\t\t+ `(${this.lang.week[d.getUTCDay()]})`\n\t\t\t+`${pad(d.getUTCHours())}:${pad(d.getUTCMinutes())}`;\n\t\tif (seconds)\n\t\t\thtml += `:${pad(d.getUTCSeconds())}`;\n\t\thtml += ' UTC';\n\t\treturn html;\n\t}\n\t// Readable elapsed time since post\n\trelativeTime(then, now) {\n\t\tlet time = Math.floor((now - then) / 60000),\n\t\t\tisFuture;\n\t\tif (time < 1) {\n\t\t\t// Assume to be client clock imprecission\n\t\t\tif (time > -5)\n\t\t\t\treturn this.lang.just_now;\n\t\t\telse {\n\t\t\t\tisFuture = true;\n\t\t\t\ttime = -time;\n\t\t\t}\n\t\t}\n\n\t\tconst divide = [60, 24, 30, 12],\n\t\t\tunit = ['minute', 'hour', 'day', 'month'];\n\t\tfor (let i = 0; i < divide.length; i++) {\n\t\t\tif (time < divide[i])\n\t\t\t\treturn this.lang.ago(time, this.lang['unit_' + unit[i]],\n\t\t\t\t\tisFuture);\n\t\t\ttime = Math.floor(time / divide[i]);\n\t\t}\n\n\t\treturn this.lang.ago(time, this.lang.unit_year, isFuture);\n\t}\n\tmnemonic(mnem) {\n\t\treturn `<b class=\"mod addr\">${mnem}</b>`;\n\t}\n\tpostNavigation(post) {\n\t\tconst num = post.num,\n\t\t\top = post.op;\n\t\treturn parseHTML\n\t\t\t`<nav>\n\t\t\t\t<a href=\"${this.postURL(num, op)}\" class=\"history\">\n\t\t\t\t\tNo.\n\t\t\t\t</a>\n\t\t\t\t<a href=\"${this.postURL(num, op)}\" class=\"quote\">\n\t\t\t\t\t${num}\n\t\t\t\t</a>\n\t\t\t</nav>`;\n\t}\n\tpostURL(num, op) {\n\t\top = op || num;\n\t\treturn `${this.op == op ? '' : op}#${num}`;\n\t}\n\texpansionLinks(num) {\n\t\treturn parseHTML\n\t\t\t`<span class=\"act expansionLinks\">\n\t\t\t\t<a href=\"${num}\" class=\"history\">\n\t\t\t\t\t${this.lang.expand}\n\t\t\t\t</a>\n\t\t\t\t] [\n\t\t\t\t<a href=\"${num}?last=${this.lastN}\" class=\"history\">\n\t\t\t\t\t${this.lang.last} ${this.lastN}\n\t\t\t\t</a>\n\t\t\t</span>`;\n\t}\n\t// Append moderation information. Only exposed to authenticated staff.\n\tmodInfo(info) {\n\t\tlet html = '<b class=\"modLog admin\">';\n\t\tfor (let action of info) {\n\t\t\thtml += `${this.lang.mod.formatLog(action)}<br>`;\n\t\t}\n\t\thtml += '</b>';\n\t\treturn html;\n\t}\n\tbanned() {\n\t\treturn `<b class=\"admin banMessage\">${this.lang.mod.banMessage}</b>`;\n\t}\n\t// Render full blockqoute contents\n\tbody(body) {\n\t\tlet html = this.fragment(body);\n\t\tif (this.state[1])\n\t\t\thtml += '</em>';\n\t\tif (this.state[2])\n\t\t\thtml += '</del>';\n\t\treturn html;\n\t}\n\t// Parse commited blockqoute fragment\n\tfragment(frag) {\n\t\tconst lines = frag.split('\\n'),\n\t\t\t{state} = this;\n\t\tlet html = '';\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\t// Start a new line\n\t\t\tif (state[0] && i % 2) {\n\t\t\t\t// Close qoute\n\t\t\t\tif (state[1] % 2) {\n\t\t\t\t\thtml += '</em>';\n\t\t\t\t\tstate[1]++;\n\t\t\t\t}\n\t\t\t\thtml += '<br>';\n\t\t\t\tstate[0] = 0;\n\t\t\t}\n\n\t\t\t// Quote or line starts with link/embed\n\t\t\tlet line = lines[i];\n\t\t\tif (!state[0] && line.startsWith('>')) {\n\t\t\t\thtml += '<em>';\n\t\t\t\tstate[1]++;\n\t\t\t}\n\n\t\t\t// Bodies may be empty\n\t\t\tif (frag) {\n\t\t\t\tline.split(' ').forEach(word => html += this.parseWord(word));\n\t\t\t\tstate[0] = 1;\n\t\t\t}\n\t\t}\n\t\treturn html;\n\t}\n\tparseWord(word) {\n\t\tconst split = word.split(/\\[\\/?spoiler]/i);\n\t\tlet html = '';\n\t\tfor (let i = 0; i < split.length; i++) {\n\t\t\t// Insert spoiler tags\n\t\t\tif (i % 2) {\n\t\t\t\thtml += `<${this.state[2] % 2 ? '/' : ''}del>`;\n\n\t\t\t\t// Callback  needs to be executed with the curent state for\n\t\t\t\t// live client-side appends\n\t\t\t\tthis.state[2]++;\n\t\t\t}\n\t\t\tlet bit = split[i];\n\t\t\tconst ref = bit.match(ref_re);\n\t\t\tif (ref) {\n\t\t\t\thtml += this.redString(ref[1]);\n\t\t\t\tbit = bit.replace(ref_re, '');\n\t\t\t}\n\t\t\thtml += this.parseHashes(bit);\n\t\t}\n\t\treturn html;\n\t}\n\t// Resolve internal and external URL references\n\tredString(ref) {\n\t\tlet dest, linkClass;\n\t\tif (/^>\\/watch/.test(ref)) {\n\t\t\tdest = 'https://www.youtube.com/' + ref.slice(2);\n\t\t\tlinkClass = 'embed watch';\n\t\t}\n\t\telse if (/^>\\/soundcloud/.test(ref)) {\n\t\t\tdest = 'https://soundcloud.com/' + ref.slice(13);\n\t\t\tlinkClass = 'embed soundcloud';\n\t\t}\n\t\telse if (/^>\\/pastebin/.test(ref)) {\n\t\t\tdest = 'https://pastebin.com/' + ref.slice(11);\n\t\t\tlinkClass = 'embed pastebin';\n\t\t}\n\n\t\t// Linkify other `>>>/${link}/` URLs\n\t\tfor (let link in config.link_targets) {\n\t\t\tconst m = ref.match(new RegExp(String\n\t\t\t\t.raw`^>\\/(${link})\\/(\\w+\\/?)?`));\n\t\t\tif (!m)\n\t\t\t\tcontinue;\n\t\t\tdest = config.link_targets[link];\n\t\t\tif (m[2])\n\t\t\t\tdest += m[2];\n\t\t\tbreak;\n\t\t}\n\n\t\tif (!dest)\n\t\t\treturn this.tamashii(parseInt(ref, 10));\n\n\t\tconst attrs = {\n\t\t\thref: encodeURI(dest),\n\t\t\ttarget: '_blank',\n\t\t\trel: 'nofollow',\n\t\t\tclass: linkClass\n\t\t};\n\t\treturn parseHTML\n\t\t\t`<a ${attrs}>\n\t\t\t\t>>${_.escape(ref)}\n\t\t\t</a>`;\n\t}\n\t// Render hash commands\n\tparseHashes(text) {\n\t\tif (!this.model.dice)\n\t\t\treturn this.linkify(text);\n\n\t\tlet html = '';\n\t\tconst bits = text.split(util.dice_re);\n\t\tfor (let i = 0; i < bits.length; i++) {\n\t\t\tconst bit = bits[i];\n\t\t\tif (!(i % 2) || !util.parse_dice(bit))\n\t\t\t\thtml += this.linkify(bit);\n\t\t\telse if (this.queueRoll)\n\t\t\t\tthis.queueRoll(bit);\n\t\t\telse {\n\t\t\t\tif (this.state[0])\n\t\t\t\t\thtml += ' ';\n\t\t\t\tconst dice = this.model.dice[this.state[3]++];\n\t\t\t\thtml += `<strong>${util.readable_dice(bit, dice)}</strong>`;\n\t\t\t}\n\t\t}\n\t\treturn html;\n\t}\n\t// Render external URLs as links\n\tlinkify(text) {\n\t\t// Disabled in client options\n\t\tif (!this.eLinkify)\n\t\t\treturn this.padWord(_.escape(text));\n\n\t\tlet html = '';\n\t\tconst bits = text.split(/(https?:\\/\\/[^\\s\"<>]*[^\\s\"<>'.,!?:;])/);\n\t\tfor (let i = 0, len = bits.length; i < len; i++) {\n\t\t\tlet escaped = _.escape(bits[i]);\n\t\t\tif (i % 2) {\n\t\t\t\thtml += parseHTML\n\t\t\t\t\t`<a href=\"${escaped}\" rel=\"nofollow\" target=\"_blank\">\n\t\t\t\t\t\t${this.padWord(escaped)}\n\t\t\t\t\t</a>`;\n\t\t\t}\n\t\t\telse if (escaped)\n\t\t\t\thtml += this.padWord(escaped);\n\t\t}\n\t\treturn html;\n\t}\n\tpadWord(word) {\n\t\tif (this.state[0])\n\t\t\tword = ' ' + word;\n\t\treturn word;\n\t}\n\tbacklinks(links) {\n\t\tif (!links)\n\t\t\treturn '';\n\t\tlet html = '';\n\t\tfor (let num in links) {\n\t\t\tif (html)\n\t\t\t\thtml += ' ';\n\t\t\thtml += this.postRef(num, links[num]);\n\t\t}\n\t\treturn html;\n\t}\n\t// Central image rendering method\n\timage(data, reveal) {\n\t\tconst showThumb = this.thumbStyle !== 'hide' || reveal;\n\t\treturn parseHTML\n\t\t\t`<figure>\n\t\t\t\t${this.figcaption(data, reveal)}\n\t\t\t\t${showThumb && config.IMAGE_HATS && '<span class=\"hat\"></span>'}\n\t\t\t\t${showThumb && this.thumbnail(data)}\n\t\t\t</figure>`;\n\t}\n\t// Image header\n\tfigcaption(data, reveal) {\n\t\tconst list = util.commaList([\n\t\t\tdata.audio && '\\u266B',\n\t\t\tdata.length,\n\t\t\tutil.readable_filesize(data.size),\n\t\t\t`${data.dims[0]}x${data.dims[1]}`,\n\t\t\tdata.apng && 'APNG'\n\t\t]);\n\t\treturn parseHTML\n\t\t\t`<figcaption>\n\t\t\t\t${this.thumbStyle === 'hide' && this.hiddenToggle(reveal)}\n\t\t\t\t${this.imageSearch(data)}\n\t\t\t\t<span>\n\t\t\t\t\t(${list})\n\t\t\t\t</span>\n\t\t\t\t${this.imageLink(data)}\n\t\t\t</figcaption>`;\n\t}\n\thiddenToggle(reveal) {\n\t\treturn parseHTML\n\t\t\t`<a class=\"imageToggle\">\n\t\t\t\t[${this.lang[reveal ? 'hide' : 'show']}]\n\t\t\t</a>`;\n\t}\n\timageSearch(data) {\n\t\tlet html = '';\n\t\tlet base = searchBase;\n\t\t// Only render google for PDFs and MP3s\n\t\tif (['.pdf', '.mp3'].indexOf(data.ext) > -1)\n\t\t\tbase = [base[0]];\n\t\t// Only use HTTP for thumbnail image search, because IQDB and\n\t\t// Saucenao can't into certain SSL cyphers\n\t\tconst imageURl = this.thumbPath(data)\n\t\tfor (let i = 0, l = base.length; i < l; i++) {\n\t\t\tlet parts = base[i];\n\t\t\thtml += parts[0]\n\t\t\t\t+ encodeURI(parts[1] !== 'thumb' ?  data[parts[1]] : imageURl)\n\t\t\t\t+ parts[2];\n\t\t}\n\n\t\treturn html;\n\t}\n\t// Get thumbnail path, even if no thumbnail generated\n\tthumbPath(data, mid) {\n\t\tlet type = 'thumb';\n\t\tif (mid && data.mid)\n\t\t\ttype = 'mid';\n\t\telse if (!data.thumb)\n\t\t\ttype = 'src';\n\n\t\treturn this.imagePaths()[type] + data[type];\n\t}\n\timagePaths() {\n\t\tif (!this._imgPaths) {\n\t\t\tconst mediaURL = config.MEDIA_URL;\n\t\t\tthis._imgPaths = {\n\t\t\t\tsrc: mediaURL + 'src/',\n\t\t\t\tthumb: mediaURL + 'thumb/',\n\t\t\t\tmid: mediaURL + 'mid/',\n\t\t\t\tspoil: mediaURL + 'spoil/spoiler'\n\t\t\t};\n\t\t}\n\t\treturn this._imgPaths;\n\t}\n\timageLink(data) {\n\t\tlet name = '',\n\t\t\timgnm = data.imgnm;\n\t\tconst m = imgnm.match(/^(.*)\\.\\w{3,4}$/);\n\t\tif (m)\n\t\t\tname = m[1];\n\t\tconst fullName = _.escape(imgnm),\n\t\t\ttooLong = name.length >= 38;\n\t\tif (tooLong)\n\t\t\timgnm = _.escape(name.slice(0, 30))\n\t\t\t\t+ '(&hellip;)'\n\t\t\t\t+ _.escape(data.ext);\n\t\tconst attrs = {\n\t\t\thref: `${config.SECONDARY_MEDIA_URL}src/${data.src}`,\n\t\t\trel: 'nofollow',\n\t\t\tdownload: fullName\n\t\t};\n\t\tif (tooLong)\n\t\t\tattrs.title = fullName;\n\n\t\treturn parseHTML\n\t\t\t`<a ${attrs}>\n\t\t\t\t${imgnm}\n\t\t\t</a>`;\n\t}\n\tthumbnail(data, href) {\n\t\tconst paths = this.imagePaths(),\n\t\t\tdims = data.dims;\n\t\tlet src = paths.src + (data.src),\n\t\t\tthumb,\n\t\t\twidth = dims[0],\n\t\t\theight = dims[1],\n\t\t\tthumbWidth = dims[2],\n\t\t\tthumbHeight = dims[3];\n\n\t\t// Spoilered and spoilers enabled\n\t\tif (data.spoiler && this.spoilToggle) {\n\t\t\tlet sp = this.spoilerInfo(data);\n\t\t\tthumb = sp.thumb;\n\t\t\tthumbWidth = sp.dims[0];\n\t\t\tthumbHeight = sp.dims[1];\n\t\t}\n\t\t// Animated GIF thumbnails\n\t\telse if (data.ext === '.gif' && this.autoGif)\n\t\t\tthumb = src;\n\t\telse\n\t\t\tthumb = this.thumbPath(data, this.thumbStyle !== 'small');\n\n\t\t// Source image smaller than thumbnail and other fallbacks\n\t\tif (!thumbWidth) {\n\t\t\tthumbWidth = width;\n\t\t\tthumbHeight = height;\n\t\t}\n\n\t\tlet linkAttrs = {\n\t\t\ttarget: '_blank',\n\t\t\trel: 'nofollow',\n\t\t\thref: href || src\n\t\t};\n\t\tlet imgAttrs = {\n\t\t\tsrc: thumb,\n\t\t\twidth: thumbWidth,\n\t\t\theight: thumbHeight\n\t\t};\n\t\t// Catalog pages\n\t\tif (href) {\n\t\t\t// Handle the thumbnails with the HTML5 History controller\n\t\t\tlinkAttrs.class = 'history';\n\t\t\t// No image hover previews\n\t\t\timgAttrs.class = 'expanded';\n\t\t\tif(this.thumbStyle == 'hide')\n\t\t\t\timgAttrs.style= 'display: none';\n\t\t}\n\n\t\treturn parseHTML\n\t\t\t`<a ${linkAttrs}>\n\t\t\t\t<img ${imgAttrs}>\n\t\t\t</a>`\n\t}\n\tspoilerInfo(data) {\n\t\tlet highDef = data.large || this.thumbStyle !== 'small';\n\t\treturn {\n\t\t\tthumb: parseHTML\n\t\t\t\t`${this.imagePaths().spoil}${highDef && 's'}${data.spoiler}.png`,\n\t\t\tdims: config[data.large ? 'THUMB_DIMENSIONS' : 'PINKY_DIMENSIONS']\n\t\t};\n\t}\n\tpostRef(num, op, desc_html) {\n\t\tlet ref = '&gt;&gt;' + num;\n\t\tif (desc_html)\n\t\t\tref += ' ' + desc_html;\n\t\tif (this.op && this.op != op)\n\t\t\tref += ' \\u27a1';\n\t\telse if (num == op && this.op == op)\n\t\t\tref += ' (OP)';\n\t\treturn `<a href=\"${this.postURL(num, op)}\" class=\"history\">${ref}</a>`;\n\t}\n\tasideLink(inner, href, cls, innerCls) {\n\t\treturn parseHTML\n\t\t\t`<aside class=\"act glass ${cls}\">\n\t\t\t\t<a ${href && `href=\"${href}\"`}\n\t\t\t\t\t${innerCls && ` class=\"${innerCls}\"`}\n\t\t\t\t>\n\t\t\t\t\t${this.lang[inner] || inner}\n\t\t\t\t</a>\n\t\t\t</aside>`\n\t}\n\treplyBox() {\n\t\treturn this.asideLink('reply', null, 'posting');\n\t}\n\tnewThreadBox() {\n\t\treturn this.asideLink('newThread', null, 'posting');\n\t}\n}\nmodule.exports = OneeSama;\n","\"use strict\";\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJ1dGlsLmpzIiwic291cmNlc0NvbnRlbnQiOltdfQ==","/*\n * Websocket controller and connection notifier\n */\n\nconst main = require('./main'),\n\t{_, common, config, connSM, state, SockJS} = main,\n\tlang = main.lang.sync;\n\nlet socket, attempts, attemptTimer;\n\nfunction send(msg) {\n\t// need deferral or reporting on these lost messages...\n\tif (connSM.state != 'synced' && connSM.state != 'syncing')\n\t\treturn;\n\tif (socket.readyState != SockJS.OPEN) {\n\t\tif (console)\n\t\t\tconsole.warn(\"Attempting to send while socket closed\");\n\t\treturn;\n\t}\n\n\tmsg = JSON.stringify(msg);\n\tif (config.DEBUG)\n\t\tconsole.log('<', msg);\n\tsocket.send(msg);\n}\nmain.reply('send', send);\n\nfunction on_message(e) {\n\tif (config.DEBUG)\n\t\tconsole.log('>', e.data);\n\n\tconst msg = JSON.parse(e.data)[0],\n\t\top = msg.shift(),\n\t\ttype = msg.shift(),\n\t\tisPubSub = common.is_pubsub(type);\n\n\tif (isPubSub && connSM.state === 'locked')\n\t\treturn;\n\n\t// Some handlers are optional and/or dynamic. Ignore them silently.\n\tconst handler = main.dispatcher[type];\n\tif (!handler)\n\t\treturn;\n\tif (isPubSub && op in state.syncs)\n\t\tstate.syncs[op]++;\n\tmain.follow(() => handler(msg, op));\n}\n\nconst sync = document.getElementById('sync');\nfunction sync_status(msg) {\n\tsync.textContent = msg;\n}\n\nconnSM.act('load + start -> conn', function () {\n\tsync_status(lang.connecting);\n\tattempts = 0;\n\tconnect();\n});\n\nfunction connect() {\n\tif (socket) {\n\t\tsocket.onclose = null;\n\t\tsocket.onmessage = null;\n\t}\n\tif (window.location.protocol == 'file:') {\n\t\tconsole.log(\"Page downloaded locally; refusing to sync.\");\n\t\treturn;\n\t}\n\tsocket = new_socket();\n\tsocket.onopen = connSM.feeder('open');\n\tsocket.onclose = connSM.feeder('close');\n\tsocket.onmessage = on_message;\n\tif (config.DEBUG)\n\t\twindow.socket = socket;\n}\n\nfunction new_socket() {\n\tconst transports = ['xdr-streaming', 'xhr-streaming', 'iframe-eventsource',\n\t\t'iframe-htmlfile', 'xdr-polling', 'xhr-polling', 'iframe-xhr-polling',\n\t\t'jsonp-polling'];\n\tif (config.USE_WEBSOCKETS)\n\t\ttransports.unshift('websocket');\n\treturn new SockJS(config.SOCKET_URL || config.SOCKET_PATH, null, {\n\t\ttransports\n\t});\n}\n\nconnSM.act('conn, reconn + open -> syncing', () => {\n\tsync_status(lang.syncing);\n\tconst connID = common.randomID(32),\n\t\t{page} = state;\n\tpage.set('connID', connID);\n\tsend([common.SYNCHRONIZE, connID, page.get('board'), state.syncs,\n\t\tpage.get('live'), document.cookie]);\n});\n\nconnSM.act('syncing + sync -> synced', function () {\n\tsync_status(lang.synced);\n\tattemptTimer = setTimeout(function () {\n\t\tattemptTimer = 0;\n\t\treset_attempts();\n\t}, 10000);\n});\n\nfunction reset_attempts() {\n\tif (attemptTimer) {\n\t\tclearTimeout(attemptTimer);\n\t\tattemptTimer = 0;\n\t}\n\tattempts = 0;\n}\n\n// Prevent pub/sub mesages from being handled\nconnSM.act('synced, syncing + lock -> locked');\nconnSM.act('locked + unlock -> synced');\nmain.reply('connection:lock', () => send([common.DESYNC]), connSM.feed('lock'));\nmain.reply('connection:unlock', msg => send(msg), connSM.feed('unlock'));\n\nconnSM.act('* + close -> dropped',  error => {\n\tif (socket) {\n\t\tsocket.onclose = null;\n\t\tsocket.onmessage = null;\n\t}\n\tif (config.DEBUG)\n\t\tconsole.error('E:', error);\n\tif (attemptTimer) {\n\t\tclearTimeout(attemptTimer);\n\t\tattemptTimer = 0;\n\t}\n\tsync_status(lang.dropped);\n\n\t// Wait maxes out at ~1min\n\tconst wait = 500 * Math.pow(1.5, Math.min(Math.floor(++attempts / 2), 12));\n\tsetTimeout(connSM.feeder('retry'), wait);\n});\n\nconnSM.act('dropped + retry -> reconn', function () {\n\tconnect();\n\t/* Don't show this immediately so we don't thrash on network loss */\n\tsetTimeout(function () {\n\t\tif (connSM.state == 'reconn')\n\t\t\tsync_status(lang.reconnecting);\n\t}, 100);\n});\n\nconnSM.act('* + invalid, desynced + close -> desynced', msg => {\n\tmsg = (msg && msg[0]) ? 'Out of sync: ' + msg[0] : 'Out of sync';\n\tsync_status(msg);\n\tif (attemptTimer) {\n\t\tclearTimeout(attemptTimer);\n\t\tattemptTimer = 0;\n\t}\n\tsocket.onclose = null;\n\tsocket.onmessage = null;\n\tsocket.close();\n\tsocket = null;\n\tif (config.DEBUG)\n\t\twindow.socket = null;\n});\n\nfunction window_focused() {\n\tswitch (connSM.state) {\n\t\tcase 'desynced':\n\t\t\treturn;\n\t\t// might have just been suspended;\n\t\t// try to get our FSM up to date if possible\n\t\tcase 'synced':\n\t\tcase 'syncing':\n\t\tcase 'conn':\n\t\t\tconst rs = socket.readyState;\n\t\t\tif (rs != SockJS.OPEN && rs != SockJS.CONNECTING) {\n\t\t\t\tconnSM.feed('close');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (navigator.onLine === false) {\n\t\t\t\tconnSM.feed('close');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tbreak;\n\t}\n\tconnSM.feed('retry');\n}\n\n// Connect to server\nconnSM.feed('start');\n\n// Check for connectivity each time tab visibility changes to visible\n// A bit of an overhead, but should prevent unregistered disconnects,\n// especially on mobile.\ndocument.addEventListener('visibilitychange', e => {\n\tif (e.target.hidden)\n\t\treturn;\n\tsetTimeout(window_focused, 20);\n});\nwindow.addEventListener('online', () => reset_attempts(), connSM.feed('retry'));\nwindow.addEventListener('offline', connSM.feeder('close'));\n","/*\n * Extact model data from the thread tree HTML and populate models and views\n */\n\nconst main = require('./main'),\n\t{_, util, options, state, posts} = main;\n\nclass Extract {\n\tconstructor(catalog) {\n\t\tconst el = main.$threads[0];\n\n\t\t// Read serialised model data\n\t\tconst json = JSON.parse(document.getElementById('postData').innerHTML);\n\t\tmain.request('notify:title', json.title);\n\n\t\t// We don't need models on catalog pages\n\t\tif (catalog)\n\t\t\treturn;\n\n\t\tconst mine = this.mine = state.mine.readAll(),\n\t\t\tposts = this.posts = json.posts;\n\t\tthis.extractReplies(el);\n\t\tthis.extractThreads(el);\n\n\t\tstate.addLinks(json.links);\n\t\t// Forward posts that replied to my post\n\t\tfor (let post in posts) {\n\t\t\tconst links = posts[post].links;\n\t\t\tif (!links)\n\t\t\t\tcontinue;\n\t\t\tfor (let num in links) {\n\t\t\t\tif (num in mine)\n\t\t\t\t\tmain.request('repliedToMe', posts[post].num);\n\t\t\t}\n\t\t}\n\n\t\t// Apply various client-only DOM modifications\n\t\tif (options.get('anonymise'))\n\t\t\tmain.request('loop:anonymise');\n\t\tmain.request('time:render');\n\t}\n\textractReplies(el) {\n\t\tlet articles = el.getElementsByTagName('article');\n\t\tfor (let i = 0, l = articles.length; i < l; i++) {\n\t\t\tlet article = articles[i];\n\t\t\tnew posts.Article({\n\t\t\t\tmodel: new posts.models.Post(this.extractModel(article)),\n\t\t\t\tel: article\n\t\t\t});\n\t\t}\n\t}\n\textractThreads(el) {\n\t\tlet sections = el.getElementsByTagName('section');\n\t\tfor (let i = 0; i < sections.length ; i++) {\n\t\t\tlet section = sections[i];\n\t\t\tconst model = this.extractModel(section);\n\t\t\tnew posts.Section({\n\t\t\t\tmodel: new posts.models.Thread(model),\n\t\t\t\tel: section\n\t\t\t})\n\t\t\t\t .renderOmit();\n\t\t\t// Read the sync ID of the thread. Used later for syncronising\n\t\t\t// with the server.\n\t\t\tstate.syncs[model.num] = model.hctr;\n\t\t}\n\t}\n\textractModel(el) {\n\t\tlet info = this.posts[util.getNum(el)];\n\t\t// Did I make this post?\n\t\tif (info.num in this.mine)\n\t\t\tinfo.mine = true;\n\t\treturn info;\n\t}\n}\nmodule.exports = Extract;\n\n// Initial extraction. No need to defer, as we actually want it to hit ASAP.\nnew Extract(state.page.get('catalog'));\n","3/**\n * Finite State Machine\n */\nexport default class FSM {\n    /**\n     * Create a new finite state machine\n     * @param {string} start - Initial state\n     */\n    constructor(start) {\n        this.state = start\n        this.spec = {\n            acts: {},\n            ons: {},\n            wilds: {},\n            preflights: {}\n        }\n    }\n\n    /**\n     * Clone the current FSM\n     * @returns {FSM}\n     */\n    clone() {\n        const second = new FSM(this.state)\n        second.spec = this.spec\n        return second\n    }\n\n    /**\n     * Assign a handler to be execute on arrival to a new state\n     * @param {string} key - Target state\n     * @param {function} f - Handler\n     */\n    on(key, f) {\n        const ons = this.spec.ons[key]\n        if (ons) {\n            ons.push(f)\n        } else {\n            this.spec.ons[key] = [f]\n        }\n    }\n\n    /**\n     * Assign sanity check to perform before transition to a new state\n     * @param {string} key - Target state\n     * @param {function} f - Handler\n     */\n    preflight(key, f) {\n        const pres = this.spec.preflights[key]\n        if (pres) {\n            pres.push(f)\n        } else {\n            this.spec.preflights[key] = [f]\n        }\n    }\n\n    /**\n     * Specify transition and an optional handler to execute on it\n     * @param {string} trans_spec - Transition specification\n     * @param {function=} on_func - Handler\n     */\n    act(trans_spec, on_func) {\n        const halves = trans_spec.split('->')\n        if (halves.length != 2) {\n            throw new Error(\"Bad FSM spec: \" + trans_spec)\n        }\n        const parts = halves[0].split(','),\n            dest = halves[1].match(/^\\s*(\\w+)\\s*$/)[1]\n        let tok\n        for (let i = parts.length - 1; i >= 0; i--) {\n            const part = parts[i],\n                m = part.match(/^\\s*(\\*|\\w+)\\s*(?:\\+\\s*(\\w+)\\s*)?$/)\n            if (!m) {\n                throw new Error(\"Bad FSM spec portion: \" + part)\n            }\n            if (m[2]) {\n                tok = m[2]\n            }\n            if (!tok) {\n                throw new Error(\"Tokenless FSM action: \" + part)\n            }\n            const src = m[1]\n            if (src == '*') {\n                this.spec.wilds[tok] = dest\n            } else {\n                let acts = this.spec.acts[src]\n                if (!acts) {\n                    this.spec.acts[src] = acts = {}\n                }\n                acts[tok] = dest\n            }\n        }\n        if (on_func) {\n            this.on(dest, on_func)\n        }\n    }\n\n    /**\n     * Transition the FSM to a new state\n     * @param {string} ev - Target state\n     * @param {*} param - Argument for the handler functions\n     * @returns {bool} - Passed preflight sanity check, if any\n     */\n    feed(ev, param) {\n        const {spec} = this,\n            from = this.state,\n            acts = spec.acts[from],\n            to = (acts && acts[ev]) || spec.wilds[ev]\n        if (to && from != to) {\n            const ps = spec.preflights[to]\n            for (let i = 0; ps && i < ps.length; i++) {\n                if (!ps[i].call(this, param)) {\n                    return false\n                }\n            }\n            this.state = to\n            const fs = spec.ons[to]\n            for (let i = 0; fs && i < fs.length; i++) {\n                fs[i].call(this, param)\n            }\n        }\n        return true\n    }\n\n    /**\n     * Returns a function that executes FSM.prototype.feed with the suplied\n     * argument\n     * @param {string} ev - Target state\n     * @returns {function}\n     */\n    feeder(ev) {\n        return param =>  this.feed(ev, param)\n    }\n}\n","/*\n Hide posts you don't like\n */\n\nlet main = require('./main');\n\n// Remember hidden posts for 7 days only to prevent the cookie from\n// eclipsing the Sun\nlet hidden = new main.Memory('hide', 7, true);\n\nmain.reply('hide', function(model) {\n\t// Hiding your own posts would open up the gates for a ton of bugs. Fuck\n\t// that.\n\tif (model.get('mine'))\n\t\treturn;\n\tconst count = hidden.write(model.get('num'));\n\tmodel.remove();\n\n\t// Forward number to options menu\n\tmain.request('hide:render', count);\n});\n\nmain.reply('hide:clear', () => hidden.purgeAll());\n\n// Initial render\nmain.defer(() => main.request('hide:render', hidden.size()));\n","/*\n * Inter board/page/thread navigation with HTML5 history\n */\n\nlet main = require('./main'),\n\t{$, _, common, Extract, state} = main;\n\n// Click handler for post/thread/board links\nmain.$doc.on ('click', 'a.history', function(event) {\n\tif (event.ctrlKey)\n\t\treturn;\n\treadingSteiner(this.href, event);\n});\n\n// Loading status GIF\nlet $loading = $('#loadingImage');\nmain.reply('loading:show', () => $loading.show());\nmain.reply('loading:hide', () => $loading.hide());\n\n// Navigate to the URL\nfunction readingSteiner(url, event) {\n\tlet nextState = state.read(url);\n\t// Does the link point to the same page as this one?\n\tif (_.isMatch(state.page.attributes, nextState))\n\t\treturn;\n\n\t// Disconnect server-side Yakusoku in preparation for navigating away.\n\t// This helps avoid duplicate messages mid-navigation.\n\tmain.request('connection:lock');\n\n\tif (event)\n\t\tevent.preventDefault();\n\n\t// Deal with hashes and query strings\n\tconst split = url.split('#');\n\tlet address = split[0] + (/\\?/.test(split[0]) ? '&' : '?') + 'minimal=true';\n\tif (split.length !== 1)\n\t\taddress += '#' + split[1];\n\n\t/*\n\t * Fetch new DOM from the server\n\t * Decided to go withthout dedicated caching and use etags for browser\n\t * cache verification.\n\t */\n\t$loading.show();\n\tconst xhr = new XMLHttpRequest();\n\txhr.open('GET', address);\n\txhr.onload = function () {\n\t\t// In case the thread is dead, moderatator cookie expired or some\n\t\t// other shenanigans\n\t\tif (this.status !== 200) {\n\t\t\t$loading.hide()\n\t\t\treturn alert(this.status)\n\t\t}\n\n\t\t// Was redirected to different thread/board\n\t\tif (baseURL(url) !== baseURL(this.responseURL))\n\t\t\tnextState = state.read(this.responseURL);\n\t\tmain.request('postSM:feed', 'done');\n\t\tmain.trigger('state:clear');\n\n\t\t// Apply new DOM and load models\n\t\tmain.$threads[0].innerHTML = this.response;\n\n\t\t// Set new page state\n\t\tstate.page.set(nextState);\n\n\t\t// Reconfigure rendering singleton\n\t\tmain.oneeSama.op = nextState.thread;\n\t\tnew Extract(nextState.catalog);\n\n\t\t// Swap the database controller server-side. Catalog does not use a\n\t\t// Yakusoku(), so not needed.\n\t\tif (!nextState.catalog) {\n\t\t\tmain.request('connection:unlock', [common.RESYNC, nextState.board,\n\t\t\t\tstate.syncs, nextState.live]);\n\t\t}\n\n\t\tif (event) {\n\t\t\thistory.pushState(null, null, nextState.href);\n\n\t\t\t// Scroll to top on new pages with no hashes\n\t\t\tif (location.hash)\n\t\t\t\tmain.request('scroll:aboveBanner');\n\t\t\telse\n\t\t\t\twindow.scrollTo(0, 0);\n\t\t}\n\t\t$loading.hide();\n\t};\n\txhr.send();\n}\n\nfunction baseURL(url) {\n\treturn url.split(/[\\?#]/)[0];\n}\n\n// For back and forward history events\nwindow.onpopstate = function(event) {\n\treadingSteiner(event.target.location.href);\n\tmain.request('scroll:aboveBanner');\n};\n","/*\n It is not very efficient to spam liteners to the options object. This\n module loops through the post models and calls the appropriate methods in\n batch.\n */\n\nconst main = require('./main'),\n\t{util, follow, options, oneeSama} = main,\n\t{posts} = main.state;\n\noptions.on({\n\t'change:thumbs': reRenderImages,\n\t'change:spoilers': toggleSpoilers,\n\t'change:autogif': toggleAutoGIF,\n\t'change:anonymise': toggleAnonymisation,\n\t'workModeTOG': reRenderImages\n});\nfunction reRenderImages() {\n\tif(main.state.page.get('catalog')){\n\t\t//quick render, because we don't have models in the catalog\n\t\tconst show = (options.get(\"thumbs\")!=='hide' && !main.oneeSama.workMode)? '':'none';\n\t\tdocument.queryAll(\".expanded\").forEach(el => el.style.display=show);\n\t}else\n\t\tfollow(() => getImages((image, model) =>\n\t\t\timage && model.dispatch('renderImage', image)));\n}\n\nfunction getImages(func) {\n\tposts.each(model => func(model.get('image'), model));\n}\n\nfunction toggleSpoilers() {\n\tfollow(() => getImages((image, model) =>\n\t\timage && image.spoiler && model.dispatch('renderImage', image)));\n}\n\n// Toggle animated GIF thumbnails\nfunction toggleAutoGIF() {\n\tfollow(() => getImages((image, model) =>\n\t\timage && image.ext === '.gif' && model.dispatch('renderImage', image)));\n}\n\nfunction toggleAnonymisation(source, toggle) {\n\tfollow(() => {\n\t\tconst command = toggle ? 'anonymise' : 'renderName';\n\t\tposts.each(function(model) {\n\t\t\tconst {name, trip} = model.attributes;\n\t\t\tif (name || trip)\n\t\t\t\tmodel.dispatch(command);\n\t\t});\n\t});\n}\nmain.reply('loop:anonymise', () =>\n\toptions.get('anonymise') && toggleAnonymisation(null, true));\n","/*\n * Self-expiring localStorage key controller\n */\n\nlet main = require('./main'),\n\t{_, Cookie} = main;\n\nclass Memory {\n\tconstructor(key, expiry, needCookie) {\n\t\tthis.key = key;\n\t\tthis.expiry = expiry;\n\t\tthis.needCookie = needCookie;\n\t\tmain.defer(this.purgeExpired.bind(this));\n\t}\n\tbakeCookie(object) {\n\t\tif (!this.needCookie)\n\t\t\treturn;\n\t\tlet nums = Object.keys(object);\n\t\tnums.sort(function(a, b) {\n\t\t\treturn parseInt(a, 10) - parseInt(b, 10);\n\t\t});\n\t\tCookie.set(this.key, nums.join('/'));\n\t}\n\tnow() {\n\t\treturn Math.floor(Date.now() / 1000);\n\t}\n\tpurgeAll() {\n\t\tlocalStorage.removeItem(this.key);\n\t\tif (this.needCookie)\n\t\t\tCookie.remove(this.key);\n\t}\n\treadAll() {\n\t\tconst key = localStorage.getItem(this.key);\n\t\tif (!key)\n\t\t\treturn {};\n\t\tlet val;\n\t\ttry {\n\t\t\tval = JSON.parse(key);\n\t\t}\n\t\tcatch(e) {}\n\t\treturn _.isObject(val) ? val : {};\n\t}\n\twriteAll(object) {\n\t\tif (_.isEmpty(object))\n\t\t\treturn this.purgeAll();\n\t\tlocalStorage.setItem(this.key, JSON.stringify(object));\n\t\tthis.bakeCookie(object)\n\t}\n\twrite(key) {\n\t\tlet object = this.readAll();\n\t\tobject[key] = this.now();\n\t\tthis.writeAll(object);\n\t\t// Return number of keys\n\t\treturn _.size(object);\n\t}\n\tsize() {\n\t\treturn _.size(this.readAll());\n\t}\n\tpurgeExpired() {\n\t\tif (!this.expiry)\n\t\t\treturn;\n\t\tlet object = this.readAll();\n\t\tconst now = this.now(),\n\t\t\tlimit = 86400 * this.expiry;\n\t\tlet expired = [];\n\t\tfor (let key in object) {\n\t\t\tconst time = object[key];\n\t\t\tif (time && now > time + limit)\n\t\t\t\texpired.push(key);\n\t\t}\n\t\tif (!expired.length)\n\t\t\treturn;\n\t\tfor (let i = 0, lim = expired.length; i < lim; i++) {\n\t\t\tdelete object[expired[i]];\n\t\t}\n\t\tthis.writeAll(object);\n\t}\n}\nmodule.exports = Memory;\n","/*\n * Houses both the actual options controler and the options panel renderring\n * logic\n */\n\nimport {_, Backbone, state} from 'main'\nimport opts from './opts'\n\n// Try to get options from local storage\nlet options\ntry {\n\toptions = JSON.parse(localStorage.options)\n}\ncatch(e) {}\nif (!options)\n\toptions = {};\nexport default options = new Backbone.Model(options)\n\nvar OptionsCollection = Backbone.Collection.extend({\n\tpersist() {\n\t\tvar opts = {};\n\t\tthis.forEach(function(model) {\n\t\t\tconst val = model.getValue();\n\t\t\tif (val === model.get('default'))\n\t\t\t\treturn;\n\t\t\topts[model.get('id')] = val;\n\t\t});\n\t\tlocalStorage.options = JSON.stringify(opts);\n\t}\n});\n\nvar optionsCollection = new OptionsCollection();\n\n// Controller template for each individual option\nvar OptionModel = Backbone.Model.extend({\n\tinitialize(opts) {\n\t\t// Condition for loading option. Optional.\n\t\tif (opts.load !== undefined && !opts.load)\n\t\t\treturn;\n\n\t\t// No type = checkbox + default false\n\t\tif (!opts.type)\n\t\t\tthis.set('type', 'checkbox');\n\n\t\tconst val = this.getValue();\n\t\tthis.setValue(val);\n\t\tif (opts.exec !== undefined) {\n\t\t\tthis.listenTo(options, 'change:' + opts.id, this.execListen);\n\t\t\t// Execute with current value\n\t\t\tif (opts.execOnStart !== false)\n\t\t\t\topts.exec(val);\n\t\t}\n\t\toptionsCollection.add(this);\n\t},\n\t// Set the option, taking into acount board specifics\n\tsetValue(val) {\n\t\toptions.set(this.get('id'), val);\n\t},\n\t// Return default, if unset\n\tgetValue() {\n\t\tconst val = options.get(this.get('id'));\n\t\treturn val === undefined ? this.get('default') : val;\n\t},\n\tvalidate(val) {\n\t\tconst valid = this.get('validation');\n\t\treturn valid ? valid(val) : true;\n\t},\n\t// Exec wrapper for listening events\n\texecListen(model, val) {\n\t\tthis.get('exec')(val);\n\t}\n});\n\n// Highlight options button, if no options are set\n(function() {\n\tif (localStorage.getItem('options'))\n\t\treturn;\n\tvar $el = $('#options');\n\t$el.addClass('noOptions');\n\n\tfunction fadeout() {\n\t\t$el.filter('.noOptions').fadeOut(fadein);\n\t}\n\n\tfunction fadein() {\n\t\t$el.fadeIn();\n\t\t// Stop animation, if options pannel is opened\n\t\tif ($el.filter('.noOptions').length)\n\t\t\tfadeout();\n\t}\n\n\tfadeout();\n\n\t$el.click(function() {\n\t\t$el.removeClass('noOptions');\n\t});\n})();\n\n// View of the options panel\nvar OptionsView = Backbone.View.extend({\n\tinitialize() {\n\t\t// Render the options panel\n\t\tthis.setElement(util.parseEl(require('./render')()))\n\t\tdocument.body.append(this.el)\n\n\t\t// Set the options in the panel to their appropriate values\n\t\toptionsCollection.each(model => {\n\t\t\tlet $el = this.$el.find('#' + model.get('id'));\n\t\t\t/*\n\t\t\t * No corresponding element in panel. Can be caused by config\n\t\t\t * mismatches.\n\t\t\t */\n\t\t\tif (!$el.length)\n\t\t\t\treturn;\n\t\t\tconst type = model.get('type'),\n\t\t\t\tval = model.getValue();\n\t\t\tif (type == 'checkbox')\n\t\t\t\t$el.prop('checked', val);\n\t\t\telse if (type == 'number' || type instanceof Array)\n\t\t\t\t$el.val(val);\n\t\t\telse if (type == 'shortcut')\n\t\t\t\t$el.val(String.fromCharCode(val).toUpperCase());\n\t\t\t// 'image' type simply falls through, as those don't need to be set\n\t\t});\n\t\tthis.$hidden = this.$el.find('#hidden');\n\t\tmain.reply('hide:render', this.renderHidden, this);\n\t},\n\tevents: {\n\t\t'click .option_tab_sel>li>a': 'switchTab',\n\t\t'change': 'applyChange',\n\t\t'click #export': 'export',\n\t\t'click #import': 'import',\n\t\t'click #hidden': 'clearHidden'\n\t},\n\tswitchTab(event) {\n\t\tevent.preventDefault();\n\t\tvar $a = $(event.target);\n\t\t// Unhighight all tabs\n\t\tthis.$el.children('.option_tab_sel').find('a').removeClass('tab_sel');\n\t\t// Hightlight the new one\n\t\t$a.addClass('tab_sel');\n\t\t// Switch tabs\n\t\tvar $li = this.$el.children('.option_tab_cont').children('li');\n\t\t$li.removeClass('tab_sel');\n\t\t$li.filter('.' + $a.data('content')).addClass('tab_sel');\n\t},\n\t// Propagate options panel changes to the models and localStorage\n\tapplyChange(event) {\n\t\tvar $target = $(event.target),\n\t\t\tmodel = optionsCollection.get($target.attr('id')),\n\t\t\tval;\n\t\tif (!model)\n\t\t\treturn;\n\t\tconst type = model.get('type');\n\t\tif (type == 'checkbox')\n\t\t\tval = $target.prop('checked');\n\t\telse if (type == 'number')\n\t\t\tval = parseInt($target.val());\n\t\t// Not recorded; extracted directly by the background handler\n\t\telse if (type == 'image')\n\t\t\treturn main.request('background:store', event.target);\n\t\telse if (type == 'shortcut')\n\t\t\tval = $target.val().toUpperCase().charCodeAt(0);\n\t\telse\n\t\t\tval = $target.val();\n\n\t\tif (!model.validate(val))\n\t\t\treturn $target.val('');\n\t\tmodel.setValue(val);\n\t\toptionsCollection.persist();\n\t},\n\t// Dump options to file\n\texport() {\n\t\tvar a = document.getElementById('export')\n\t\ta.setAttribute('href', window.URL\n\t\t\t.createObjectURL(new Blob([JSON.stringify(localStorage)], {\n\t\t\t\ttype: 'octet/stream'\n\t\t\t}))\n\t\t);\n\t\ta.setAttribute('download', 'meguca-config.json');\n\t},\n\t// Import options from file\n\timport(event) {\n\t\t// Proxy to hidden file input\n\t\tevent.preventDefault();\n\t\tvar $input = this.$el.find('#importSettings');\n\t\t$input.click();\n\t\t$input.one('change', function() {\n\t\t\tvar reader = new FileReader();\n\t\t\treader.readAsText($input[0].files[0]);\n\t\t\treader.onload = function(e) {\n\t\t\t\tvar json;\n\t\t\t\t// In case of curruption\n\t\t\t\ttry {\n\t\t\t\t\tjson = JSON.parse(e.target.result);\n\t\t\t\t}\n\t\t\t\tcatch(e) {\n\t\t\t\t\talert('Import failed. File corrupt');\n\t\t\t\t}\n\t\t\t\tif (!json)\n\t\t\t\t\treturn;\n\t\t\t\tlocalStorage.clear();\n\t\t\t\tfor (let key in json) {\n\t\t\t\t\tlocalStorage[key] = json[key];\n\t\t\t\t}\n\t\t\t\talert('Import successfull. The page will now reload.');\n\t\t\t\tlocation.reload(true);\n\t\t\t};\n\t\t});\n\t},\n\t// Hiden posts counter and reset link\n\trenderHidden(count) {\n\t\tlet $el = this.$hidden;\n\t\t$el.text($el.text().replace(/\\d+$/, count));\n\t},\n\tclearHidden() {\n\t\tmain.request('hide:clear');\n\t\tthis.renderHidden(0);\n\t}\n});\n\n// Create and option model for each object in the array\nfor (let spec of opts) {\n\tnew OptionModel(spec);\n}\n\nmain.defer(function() {\n\tnew OptionsView()\n});\n","/*\n * This file is used by both the client to populate the Backbone models and the\n * server to render the actual options panel.\n */\n\nimport {Cookie, util, state, config, isMobile, lang} from 'main'\n\n/*\n * Full schema of the option interface\n *\n * - id: Identifier of the option. Used for DOM element and localStorage tagging\n * - type: 'checkbox'/'number'/'image'/'shortCut'/array of options\n *\tarrays become a selection list. Defaults to 'checkbox', if omitted.\n * - default: Default value. false, if omitted.\n * - tab: Index of the tab the option belong to.\n * - exec: Function to execute on option change.\n * - execOnStart: Boolean. Should the function be executed on model population?\n *\tDefaults to true.\n * - load: Condition to display and execute the option. Defaults to true(always)\n * - validation: Function that validates the users input. Returns a boolean.\n * - hidden: If true this option won't be shown to the user. Defaults to false\n *\n * Tooltips and lables are defined per language in `lang/`.\n * All arguments except for `id` and `tab` are optional.\n */\n\nconst notMobile = !isMobile\n\nexport default opts = [\n\t// LANGUAGE SELECTION\n\t{\n\t\tid: 'lang',\n\t\ttype: config.lang.enabled,\n\t\ttab: 0,\n\t\tdefault: config.lang.default,\n\t\texecOnStart: false,\n\t\texec(type) {\n\t\t\talert(lang.langApplied)\n\t\t\tlocation.reload()\n\t\t}\n\t},\n\t// INLINE EXPANSION\n\t{\n\t\tid: 'inlinefit',\n\t\ttype: ['none', 'full', 'width', 'height', 'both'],\n\t\ttab: 1,\n\t\tdefault: 'width'\n\t},\n\t// THUMBNAIL MODE\n\t{\n\t\tid: 'thumbs',\n\t\ttype: util.thumbStyles,\n\t\ttab: 1,\n\t\tdefault: 'small'\n\t},\n\t// IMAGE HOVER EXPANSION\n\t{\n\t\tid: 'imageHover',\n\t\tdefault: true,\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t{\n\t\tid: 'webmHover',\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t// Autogif TOGGLE\n\t{\n\t\tid: 'autogif',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t// SPOILER TOGGLE\n\t{\n\t\tid: 'spoilers',\n\t\ttab: 1,\n\t\tdefault: true\n\t},\n\t// LINKIFY TEXT URLS\n\t{\n\t\tid: 'linkify',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// DESKTOP NOTIFICATIONS\n\t{\n\t\tid: 'notification',\n\t\tload: notMobile,\n\t\ttab: 0,\n\t\texec(notifToggle) {\n\t\t\tif (notifToggle && (Notification.permission !== \"granted\"))\n\t\t\t\tNotification.requestPermission()\n\t\t}\n\t},\n\t// ANONIMISE ALL POSTER NAMES\n\t{\n\t\tid: 'anonymise',\n\t\ttab: 0\n\t},\n\t// RELATIVE POST TIMESTAMPS\n\t{\n\t\tid: 'relativeTime',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// R/A/DIO NOW PLAYING BANNER\n\t{\n\t\tid: 'nowPlaying',\n\t\tload: notMobile && config.radio,\n\t\ttab: 3,\n\t\tdefault: true,\n\t\texec(toggle) {\n\t\t\tif (toggle) {\n\t\t\t\t// Query the server for current stream info\n\t\t\t\tmain.send({type: 'radio'})\n\t\t\t} else {\n\t\t\t\tmain.request('banner:radio:clear');\n\t\t\t}\n\t\t}\n\t}\n];\n\n// IMAGE SEARCH LINK TOGGLE\nfor (let engine of ['google', 'iqdb', 'saucenao', 'desustorage', 'exhentai']) {\n\topts.push({\n\t\tid: engine,\n\t\t// Use a custom internatiolisation function\n\t\tlang: 'imageSearch',\n\t\ttab: 2,\n\t\tdefault: engine === 'google',\n\t\texec: toggleHeadStyle(engine + 'Toggle', `.${engine}{display:initial;}`)\n\t})\n}\n\nopts.push(\n\t// ILLYA DANCE\n\t{\n\t\tid: 'illyaBGToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t{\n\t\tid: 'illyaMuteToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t// HORIZONTAL POSTING\n\t{\n\t\tid: 'horizontalPosting',\n\t\ttab: 3,\n\t\texec: toggleHeadStyle(\n\t\t\t'horizontal',\n\t\t\t'article,aside{display:inline-block;}'\n\t\t)\n\t},\n\t// REPLY AT RIGHT\n\t{\n\t\tid: 'replyright',\n\t\ttab: 1,\n\t\texec: toggleHeadStyle(\n\t\t\t'reply-at-right',\n\t\t\t'section>aside{margin: -26px 0 2px auto;}'\n\t\t)\n\t},\n\t// THEMES\n\t{\n\t\tid: 'theme',\n\t\ttype: [\n\t\t\t'moe', 'gar', 'mawaru', 'moon', 'ashita', 'console', 'tea',\n\t\t\t'higan', 'ocean', 'rave', 'tavern', 'glass'\n\t\t],\n\t\ttab: 1,\n\t\tdefault: config.defaultCSS,\n\t\texec(theme) {\n\t\t\tif (!theme) {\n\t\t\t    return\n\t\t\t}\n\t\t\tdocument.getElementById('theme')\n\t\t\t\t.setAttribute(\n\t\t\t\t\t'href',\n\t\t\t\t\t`${config.MEDIA_URL}css/${theme}.css?v=${main.cssHash}`\n\t\t\t\t)\n\t\t}\n\t},\n\t// CUSTOM USER-SET BACKGROUND\n\t{\n\t\tid: 'userBG',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t{\n\t\tid: 'userBGimage',\n\t\tload: notMobile,\n\t\ttype: 'image',\n\t\ttab: 1,\n\t\texecOnStart: false,\n\t\texec(upload) {\n\t\t\tmain.request('background:store', upload)\n\t\t}\n\t},\n\t// LAST N CONFIG\n\t{\n\t\tid: 'lastn',\n\t\ttype: 'number',\n\t\ttab: 0,\n\t\tvalidation: util.resonableLastN,\n\t\tdefault: config.posts.lastN\n\t},\n\t// KEEP THREAD LENGTH WITHIN LASTN\n\t/*\n\t Disabled, until dependancy features are implemnted (see issue #280)\n\t{\n\t\tid: 'postUnloading',\n\t\ttab: 0\n\t},*/\n\t// LOCK TO BOTTOM EVEN WHEN DOCUMENT HIDDEN\n\t{\n\t\tid: 'alwaysLock',\n\t\ttab: 0\n\t}\n);\n\n// SHORTCUT KEYS\nconst shorts = [\n\t{id: 'new', default: 78},\n\t{id: 'togglespoiler', default: 73},\n\t{id: 'textSpoiler', default: 68},\n\t{id: 'done', default: 83},\n\t{id: 'expandAll', default: 69},\n\t{id: 'workMode', default: 66}\n]\nfor (let short of shorts) {\n\tshort.type = 'shortcut'\n\tshort.tab = 4\n\tshort.load = notMobile\n\topts.push(short)\n}\n\n/**\n * Create a function to append and toggle a style element in <head>\n */\nfunction toggleHeadStyle(id, css) {\n\treturn function (toggle) {\n\t\tif (!document.getElementById(id)) {\n\t\t\tdocument.head.appendChild(\n\t\t\t\tutil.parseEl(`<style id=\"${id}\">${css}</style>`)\n\t\t\t)\n\t\t}\n\n\t\t// The disabled property only exists on elements in the DOM, so we do\n\t\t// another query\n\t\tdocument.getElementById(id).disabled = !toggle;\n\t}\n}\n","import {_, isMobile, options} from 'main'\n\nconst lang = main.lang.opts\n\n/**\n * Render the options panel\n */\nexport default function render() {\n    let html = `<div class=\"bmodal glass\" id=\"options-panel\">`\n        + `<ul class=\"option_tab_sel\">`\n    const {tabs} = lang,\n        opts = []\n\n    // Render tab butts\n    for (let i = 0; i < tabs.length; i++) {\n        // Pick the options for this specific tab, according to current\n        // template and server configuration\n        opts[i] = _.filter(options, opt =>\n            opt.tab === i\n                && (opt.load === undefined  || opt.load)\n                && !opt.hidden)\n\n        if (!opts[i].length) {\n            continue\n        }\n        html += `<li><a data-content=\"tab-${i}\"`\n\n        // Highlight the first tabButt by default\n        if (i === 0) {\n            html += ' class=\"tab_sel\"'\n        }\n\n        html += `>${tabs[i]}</a></li>`;\n    }\n\n    html += '</ul><ul class=\"option_tab_cont\">'\n    for (let i = 0; i < opts.length; i++) {\n        html += renderTab(opt, i)\n    }\n    html += '</ul></div>'\n\n    return html\n}\n\n/**\n * Render tab contents\n */\nfunction renderTab(opt, i) {\n    if (!opts[i].length) {\n        return ''\n    }\n    let html = \"\"\n    html += `<li class=\"tab-${i}`\n\n    // Show the first tab by default\n    if (i === 0) {\n        html += ' tab_sel'\n    }\n    html += '\">'\n\n    // Render the actual options\n    for (let opt of opts[i]) {\n        html += renderOption(opt)\n    }\n\n    if (i === 0) {\n        html += renderExtras()\n    }\n    html += '</li>'\n\n    return html\n}\n\n/**\n * Render a single option from it's schema\n */\nfunction renderOption(opt) {\n\tlet html = ''\n\tconst isShortcut = opt.type === 'shortcut',\n\t\tisList = opt.type instanceof Array,\n\t\tisCheckbox = opt.type === 'checkbox' || opt.type === undefined,\n\t\tisNumber = opt.type === 'number',\n\t\tisImage = opt.type === 'image'\n\tif (isShortcut) {\n        html += 'Alt+'\n    }\n\tif (!isList) {\n\t\thtml += '<input'\n\t\tif (isCheckbox || isImage)\n\t\t\thtml += ` type=\"${(isCheckbox ? 'checkbox' : 'file')}\"`\n\t\telse if (isNumber)\n\t\t\thtml += ' style=\"width: 4em;\" maxlength=\"4\"'\n\t\telse if (isShortcut)\n\t\t\thtml += ' maxlength=\"1\"'\n\t} else {\n        html += '<select'\n    }\n\n\tconst [label,title] = lang[opt.id]\n\thtml += ` id=\"${opt.id}\" title=\"${title}\">`\n\n\tif (isList) {\n\t\tfor (let item of opt.type) {\n\t\t\thtml += `<option value=\"${item}\">${lang[item] || item}</option>`\n\t\t}\n\t\thtml += '</select>'\n\t}\n\thtml += `<label for=\"${opt.id}\" title=\"${title}\">${label}</label><br>`\n\n\treturn html\n}\n\n/**\n * Hidden post reset, Export and Import links to first tab\n */\nfunction renderExtras() {\n\tlet html = '<br>'\n\tconst links = ['export', 'import', 'hidden']\n    for (let id of links) {\n        const [label, title] = lang[id]\n        html += `<a id=\"${id}\" title=\"${ln[1]}\">${ln[0]}</a> `\n    }\n\n    // Hidden file input for uploading the JSON\n    const attrs = {\n        type: 'file',\n        id: 'importSettings',\n        name: \"Import Settings\"\n    }\n\thtml += common.parseHTML`<input ${attrs}>`\n\n    return html\n}\n","/*\n * Reply posts\n */\n\nconst main = require('../main'),\n\tPostCommon = require('./common'),\n\t{_, Backbone} = main;\n\nmodule.exports = PostCommon.extend({\n\ttagName: 'article',\n\trender() {\n\t\tthis.setElement(main.oneeSama.article(this.model.attributes));\n\t\treturn this;\n\t},\n\tinsertIntoDOM() {\n\t\t_.last(document.query('#p' + this.model.get('op')).queryAll('article'))\n\t\t\t.after(this.el);\n\t\tthis.autoExpandImage().fun();\n\t}\n});\n","/*\n * Common methods to both OP and regular posts\n */\n\nconst main = require('../main'),\n\timager = require('./imager'),\n\t{_, Backbone, common, util, lang, oneeSama, options, state} = main;\n\nmodule.exports = imager.Hidamari.extend({\n\tclassName: 'glass',\n\t// One-way communication channel to the model\n\tinitialize() {\n\t\tthis.listenTo(this.model, 'dispatch', this.redirect);\n\t},\n\t// Extra initialisation logic for posts renderred client-side\n\tclientInit() {\n\t\tif (options.get('anonymise'))\n\t\t\tthis.anonymise();\n\t\treturn this;\n\t},\n\t// Proxy to the appropriate method\n\tredirect(command, ...args) {\n\t\tthis[command](...args);\n\t},\n\t// Update the post's text body\n\tupdateBody(frag) {\n\t\tif (!this.blockquote)\n\t\t\tthis.blockquote = this.el.query('blockquote');\n\n\t\t// This will rerender the HTML content on each update. Might be\n\t\t// some overhead involved, but simplifies live updates greatly.\n\t\tconst model = this.model.attributes;\n\t\tthis.blockquote.innerHTML = oneeSama.setModel(model).body(model.body);\n\t},\n\trenderTime() {\n\t\tthis.el.query('time').outerHTML = oneeSama.time(this.model.get('time'));\n\t},\n\trenderBacklinks(links) {\n\t\tthis.el.query('small').innerHTML = oneeSama.backlinks(links);\n\t},\n\t// Admin JS injections\n\tfun() {\n\t\t// Fun goes here\n\t},\n\t// Self-delusion tripfag filter\n\tanonymise() {\n\t\tthis.el.query('.name').innerHTML = `<b class=\"name\">${lang.anon}<b>`;\n\t},\n\t// Restore regular name\n\trenderName() {\n\t\tthis.el.query('.name').outerHTML = oneeSama.name(this.model.attributes);\n\t},\n\trenderModerationInfo(info) {\n\t\tconst el = this.getContainer();\n\t\tel.query('.modLog').remove();\n\t\tel.query('blockquote').before(util.parseDOM(oneeSama.modInfo(info)));\n\t},\n\tgetContainer() {\n\t\treturn this.el.query('.container');\n\t},\n\trenderBan() {\n\t\tconst el = this.getContainer();\n\t\tel.query('.banMessage').remove();\n\t\tel.query('blockquote').after(util.parseDOM(oneeSama.banned()));\n\t},\n\trenderEditing(editing) {\n\t\tconst {el} = this;\n\t\tif (editing)\n\t\t\tel.classList.add('editing');\n\t\telse {\n\t\t\tel.classList.remove('editing');\n\t\t\tel.query('blockquote').normalize();\n\t\t}\n\t}\n});\n","/*\nYoutube, soundcloud and pastebin link embeding\n */\n\n// TODO: DRY this shit\n\nlet main = require('../main'),\n\t{$, util} = main;\n\n// >80 char rule\nconst youtube_url_re = exports.youtube_url_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?youtube\\.com\\/watch\\/?\\?((?:[^\\s#&=]+=[^\\s#&]*&)*)?v=([\\w-]{11})((?:&[^\\s#&=]+=[^\\s#&]*)*)&?(#t=[\\dhms]{1,9})?/,\n\tyoutube_short_re = exports.youtube_short_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?youtu.be\\/([\\w-]{11})\\??(t=[\\dhms]{1,9})?/,\n\tyoutube_time_re = exports.youtube_time_re = /^#t=(?:(\\d\\d?)h)?(?:(\\d{1,3})m)?(?:(\\d{1,3})s)?$/,\n\tyoutube_short_time_re = exports.youtube_short_time_re = /^t=(?:(\\d\\d?)h)?(?:(\\d{1,3})m)?(?:(\\d{1,3})s)?$/;\n\nfunction make_video(id, params, start) {\n\tif (!params)\n\t\tparams = {allowFullScreen: 'true'};\n\tparams.allowScriptAccess = 'always';\n\tvar query = {\n\t\tautohide: 1,\n\t\tfs: 1,\n\t\tmodestbranding: 1,\n\t\torigin: document.location.origin,\n\t\trel: 0,\n\t\tshowinfo: 0\n\t};\n\tif (start)\n\t\tquery.start = start;\n\tif (params.autoplay)\n\t\tquery.autoplay = params.autoplay;\n\tif (params.loop) {\n\t\tquery.loop = '1';\n\t\tquery.playlist = id;\n\t}\n\n\treturn $('<iframe></iframe>', {\n\t\ttype: 'text/html',\n\t\tsrc: encodeURI('https://www.youtube.com/embed/' + id) + '?'\n\t\t\t+ $.param(query),\n\t\tframeborder: '0',\n\t\tattr: video_dims(),\n\t\tclass: 'youtube-player'\n\t});\n}\n\nfunction video_dims() {\n\tif (window.screen && screen.width <= 320)\n\t\treturn {width: 250, height: 150};\n\telse\n\t\treturn {width: 560, height: 340};\n}\n\nmain.$threads.on('click', '.watch', function(e) {\n\tif (e.which > 1 || e.metaKey || e.ctrlKey || e.altKey || e.shiftKey)\n\t\treturn;\n\tvar $target = $(e.target);\n\n\t// maybe squash that double-play bug? ugh, really\n\tif (!$target.is('a'))\n\t\treturn;\n\n\tvar $video = $target.find('iframe');\n\tif ($video.length) {\n\t\t$video.siblings('br').andSelf().remove();\n\t\t$target.css('width', 'auto');\n\t\treturn false;\n\t}\n\tif ($target.data('noembed'))\n\t\treturn;\n\t//check if longURL, if that fails, check if shortURL\n\tvar m = $target.attr('href').match(youtube_url_re);\n\tif (!m) {\n\t\tm = $target.attr('href').match(youtube_short_re);\n\t\tif (!m)\n\t\t// Shouldn't happen, but degrade to normal click action\n\t\t\treturn;\n\t\ttimeCall(m[1],m[2],youtube_short_time_re);\n\t}\n\ttimeCall(m[2],m[4],youtube_time_re);\n\tfunction timeCall(url, time, timeRex){\n\t\tvar start = 0;\n\t\tif (time){\n\t\t\tvar t = time.match(timeRex);\n\t\t\tif (t) {\n\t\t\t\tif (t[1])\n\t\t\t\t\tstart += parseInt(t[1], 10) * 3600;\n\t\t\t\tif (t[2])\n\t\t\t\t\tstart += parseInt(t[2], 10) * 60;\n\t\t\t\tif (t[3])\n\t\t\t\t\tstart += parseInt(t[3], 10);\n\t\t\t}\n\t\t}\n\t\t$target\n\t\t\t.css('width', video_dims().width)\n\t\t\t.append('<br>', make_video(url, null, start))\n\t}\n\treturn false;\n});\n\nmain.$threads.on('mouseenter', '.watch', function (event) {\n\tvar $target = $(event.target);\n\tif ($target.data('requestedTitle'))\n\t\treturn;\n\t$target.data('requestedTitle', true);\n\t// Edit textNode in place so that we don't mess with the embed\n\tvar node = $target.contents().filter(function () {\n\t\treturn this.nodeType === 3;\n\t})[0];\n\tif (!node)\n\t\treturn;\n\tconst orig = node.textContent;\n\tnode.textContent = orig + '...';\n\tvar m = $target.attr('href').match(youtube_url_re);\n\tif (!m){\n\t\tm = $target.attr('href').match(youtube_short_re);\n\t\tif(!m)\n\t\t\treturn;\n\t\t$.ajax({\n\t\t\turl: '//gdata.youtube.com/feeds/api/videos/' + m[1],\n\t\t\tdata: {v: '2', alt: 'jsonc'},\n\t\t\tdataType: 'json',\n\t\t\tsuccess: gotInfo,\n\t\t\terror() {\n\t\t\t\tnode.textContent = orig + '???';\n\t\t\t}\n\t\t});\n\t}\n\n\t$.ajax({\n\t\turl: '//gdata.youtube.com/feeds/api/videos/' + m[2],\n\t\tdata: {v: '2', alt: 'jsonc'},\n\t\tdataType: 'json',\n\t\tsuccess: gotInfo,\n\t\terror() {\n\t\t\tnode.textContent = orig + '???';\n\t\t}\n\t});\n\t// Creates the Titles upon hover\n\t// NOTE: Condense gotInfos into single function\n\tfunction gotInfo(data) {\n\t\tvar title = data && data.data && data.data.title;\n\t\tif (title) {\n\t\t\tnode.textContent = orig + ': ' + title;\n\t\t\t$target.css({color: 'black'});\n\t\t}\n\t\telse\n\t\t\tnode.textContent = orig + ' (gone?)';\n\n\t\tif (data\n\t\t\t&& data.data\n\t\t\t&& data.data.accessControl\n\t\t\t&& data.data.accessControl.embed === 'denied'\n\t\t) {\n\t\t\tnode.textContent += ' (EMBEDDING DISABLED)';\n\t\t\t$target.data('noembed', true);\n\t\t}\n\t}\n});\n\nfunction make_embed(uri, params, dims) {\n\tvar $obj = $('<object/>', {attr: dims});\n\tfor (var name in params) {\n\t\t$('<param/>', {\n\t\t\tattr: {\n\t\t\t\tname: name,\n\t\t\t\tvalue: params[name]\n\t\t\t}\n\t\t}).appendTo($obj);\n\t}\n\t$('<embed/>', {\n\t\tsrc: uri,\n\t\ttype: 'application/x-shockwave-flash'\n\t})\n\t\t.attr(dims)\n\t\t.attr(params)\n\t\t.appendTo($obj);\n\treturn $obj;\n}\n\n/* SOUNDCLOUD */\n\nconst soundcloud_url_re = exports.soundcloud_url_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.)?soundcloud\\.com\\/([\\w-]{1,40}\\/[\\w-]{1,80})\\/?/;\n\nfunction fetchSoundcloud(target, width, cb) {\n\tconst url = 'https://soundcloud.com/oembed?url='\n\t\t+ encodeURIComponent(target.getAttribute('href'))\n\t\t+ `&maxwidth=${width}&maxheight=166&auto_play=true&format=json`\n\t\t+ '&show_comments=false';\n\tconst xhr = new XMLHttpRequest();\n\txhr.open('GET', url);\n\txhr.responseType = 'json';\n\txhr.onload = function () {\n\t\tif (this.status !== 200)\n\t\t\treturn cb(this.status);\n\t\tcb(null, this.response);\n\t};\n\txhr.send();\n}\n\nmain.$threads.on('click', '.soundcloud', function (e) {\n\tif (e.which > 1 || e.ctrlKey || e.altKey || e.shiftKey || e.metaKey)\n\t\treturn;\n\tconst {target} = e,\n\t\tiframe = target.query('iframe');\n\te.preventDefault();\n\tif (iframe) {\n\t\tiframe.previousElementSibling.remove();\n\t\tiframe.remove();\n\t\treturn;\n\t}\n\n\tconst width = Math.round(window.innerWidth * 0.75);\n\tfetchSoundcloud(target, width, (err, json) => {\n\t\tif (err)\n\t\t\treturn alert(err);\n\t\ttarget.append(document.createElement('br'));\n\t\ttarget.append(util.parseDOM(json.html));\n\t\ttarget.style.width = width + 'px';\n\t});\n});\n\nmain.$threads.on('mouseenter', '.soundcloud:not(.fetched)', function (event) {\n\tconst {target} = event,\n\t\tnode = target.firstChild,\n\t\ttext = node.textContent;\n\tnode.textContent = text + ' ...';\n\n\t// We should not be doing 2 separate fetches on mouseover and click, but\n\t// what if the user manages to click without mouseenter somehow?\n\tfetchSoundcloud(target, 1000, (err, json) => {\n\t\tif (err)\n\t\t\treturn node.textContent = `${text}: Error: ${err}`;\n\t\tnode.textContent = `${text}: ${json.title}`;\n\t\ttarget.style.color = 'black';\n\t\ttarget.classList.add('fetched');\n\t});\n});\n\n// PASTEBIN\nconst pastebin_re = exports.pastebin_re = /(?:>>>*?)?(?:https?:\\/\\/)?(?:www\\.|m.)?pastebin\\.com\\/(.*)/;\n//Pastebin's API seems built for MAKING pastebins but not sharing them\n\n$(document).on('click', '.pastebin', function(event){\n\tif (event.which > 1 || event.ctrlKey || event.altKey || event.shiftKey || event.metaKey)\n\t\treturn;\n\tvar $target = $(event.target);\n\n\tvar $obj = $target.find('iframe');\n\tif ($obj.length) {\n\t\t$obj.siblings('br').andSelf().remove();\n\t\t$target.css({\n\t\t\twidth: 'auto',\n\t\t\theight: 'auto'\n\t\t});\n\t\treturn false;\n\t}\n\n\tvar m = $target.attr('href').match(pastebin_re);\n\tif (!m)\n\t\treturn;\n\tvar $window = $(window),\n\t\twidth = Math.round($window.innerWidth() * 0.65),\n\t\theight = Math.round($window.innerHeight() * 0.65);\n\t$target\n\t\t.css({\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t})\n\t\t.append('<br>', $('<iframe></iframe>', {\n\t\t\ttype: 'text/html',\n\t\t\tsrc: 'https://pastebin.com/embed_iframe.php?i='+ m[1],\n\t\t\tframeborder: '0',\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t}))\n\treturn false;\n});\n","/*\n Name, email, tripcode and staff title persistence and postform propagation\n */\n\nlet main = require('../main'),\n\t{$, $script, $email, $name, _, common, config} = main;\n\nfunction load() {\n\ttry {\n\t\tconst id = JSON.parse(localStorage.ident);\n\t\tif (id.name)\n\t\t\t$name.val(id.name);\n\t\tif (id.email)\n\t\t\t$email.val(id.email);\n\t}\n\tcatch(e) {}\n}\n\nlet save = _.debounce(function() {\n\ttry {\n\t\tconst name = $name.val();\n\t\tlet email = $email.val();\n\t\t// Staff login method\n\t\tif (email === config.LOGIN_KEYWORD) {\n\t\t\t$email.val('');\n\t\t\t$script(config.MEDIA_URL + 'js/login.js?v=' + main.clientHash);\n\t\t\temail = false;\n\t\t}\n\n\t\tif (name || email) {\n\t\t\tlet id = {};\n\t\t\tif (name)\n\t\t\t\tid.name = name;\n\t\t\tif (email)\n\t\t\t\tid.email = email;\n\t\t\tlocalStorage.ident = JSON.stringify(id);\n\t\t}\n\t\telse\n\t\t\tlocalStorage.removeItem('ident');\n\t}\n\tcatch(e) {}\n}, 1000);\n\n// Sync persistance and postForm with input changes\nfunction propagate() {\n\tlet postForm = main.request('postForm');\n\tif (postForm)\n\t\tpostForm.renderIdentity();\n\tsave();\n}\n\nmain.defer(function() {\n\tload();\n\t$name.on('input', propagate);\n\t$email.on('input', propagate);\n});\n","/*\n * Thumbnail and image renderring\n */\n\nconst main = require('../main'),\n\t{$threads, _, Backbone, common, util, oneeSama, options, state} = main;\n\nexports.Hidamari = Backbone.View.extend({\n\t/*\n\t Render entire <figure>. Rerenderring completely each time is considerable\n\t overhed, but the alternative is very convoluted logic. I don't really want\n\t to attach a FSM to each view, just for image renderring.\n\t */\n\trenderImage(arg, image, manual) {\n\t\t/*\n\t\t All kinds of listeners call this method, so we need to ensure we\n\t\t always get the appropriate image object.\n\t\t */\n\t\tconst reveal = arg === true,\n\t\t\t{model, el} = this;\n\t\tif (!image || !image.src)\n\t\t\timage = model.get('image');\n\t\tconst figure = el.query('figure');\n\t\tif (figure)\n\t\t\tfigure.remove();\n\n\t\t// Remove image on mod deletion\n\t\tif (!image)\n\t\t\treturn;\n\t\tel.query('blockquote')\n\t\t\t.before(util.parseDOM(oneeSama.image(image, reveal)));\n\n\t\t// Scroll the post back into view, if contracting images taller than\n\t\t// the viewport\n\t\tif (manual && model.get('tallImage')) {\n\t\t\twindow.scrollTop = el.getBoundingClientRect().top\n\t\t\t\t+ document.body.scrollTop\n\t\t\t\t- document.query('#banner').height;\n\t\t}\n\n\t\tmodel.set({\n\t\t\t// Only used in hidden thumbnail mode\n\t\t\tthumbnailRevealed: reveal,\n\t\t\timageExpanded: false,\n\t\t\ttallImage: false\n\t\t});\n\t},\n\tautoExpandImage() {\n\t\tconst img = this.model.get('image');\n\t\tif (!img\n\t\t\t|| !massExpander.get('expand')\n\t\t\t// Don't auto expand webm/PDF/MP3\n\t\t\t|| ['.webm', '.pdf', '.mp3'].indexOf(img.ext) > -1\n\t\t)\n\t\t\treturn this;\n\t\tthis.toggleImageExpansion(true, img);\n\t\treturn this;\n\t},\n\ttoggleImageExpansion(expand, img, manual) {\n\t\tconst fit = options.get('inlinefit');\n\t\tif (!img || fit === 'none')\n\t\t\treturn;\n\t\tif (expand)\n\t\t\tthis.fitImage(img, fit);\n\t\telse\n\t\t\tthis.renderImage(null, img, manual);\n\t},\n\tfitImage(img, fit){\n\t\t// Open PDF in a new tab on click\n\t\tif (img.ext === '.pdf')\n\t\t\treturn window.open(oneeSama.imagePaths().src + img.src, '_blank');\n\n\t\t// Audio controls are always the same height and do not need to be\n\t\t// fitted\n\t\tif (img.ext === '.mp3')\n\t\t\treturn this.renderAudio(img);\n\n\t\tlet newWidth, newHeight,\n\t\t\twidth = newWidth = img.dims[0],\n\t\t\theight = newHeight = img.dims[1];\n\t\tif (fit === 'full')\n\t\t\treturn this.expandImage(img, {width, height});\n\n\t\tconst both = fit === 'both',\n\t\t\twidthFlag = both || fit === 'width',\n\t\t\theightFlag = both || fit === 'height',\n\t\t\taspect = width / height;\n\t\tlet fullWidth, fullHeight;\n\t\tif (widthFlag) {\n\t\t\tconst maxWidth = this.imageMaxWidth();\n\t\t\tif (newWidth > maxWidth) {\n\t\t\t\tnewWidth = maxWidth;\n\t\t\t\tnewHeight = newWidth / aspect;\n\t\t\t\tfullWidth = true;\n\t\t\t}\n\t\t}\n\t\tif (heightFlag) {\n\t\t\tlet maxHeight = window.innerHeight\n\t\t\t\t- document.query('#banner').offsetHeight;\n\t\t\tif (newHeight > maxHeight) {\n\t\t\t\tnewHeight = maxHeight;\n\t\t\t\tnewWidth = newHeight * aspect;\n\t\t\t\tfullHeight = true;\n\t\t\t}\n\t\t}\n\t\tif (newWidth > 50 && newHeight > 50) {\n\t\t\twidth = newWidth;\n\t\t\theight = newHeight;\n\t\t}\n\t\tthis.expandImage(img, width, height, fullHeight && !fullWidth);\n\t},\n\t// Calculate maximum horizontal dimension an image can be expanded to\n\timageMaxWidth() {\n\t\tconst {el, model} = this;\n\t\treturn window.innerWidth\n\t\t\t- parseInt(el.closest('section').getBoundingClientRect().left) * 2\n\t\t\t- util.outerWidth(model.get('op') ? el : el.query('.background'));\n\t},\n\texpandImage(img, width, height, noMargin) {\n\t\tconst isVideo = img.ext === '.webm';\n\t\tconst attrs = {\n\t\t\tsrc: oneeSama.imagePaths().src + img.src,\n\t\t\twidth,\n\t\t\theight\n\t\t};\n\t\tlet cls = 'expanded';\n\t\tif (noMargin)\n\t\t\tcls += ' noMargin';\n\t\tattrs.class = cls;\n\n\t\tif (isVideo)\n\t\t\tattrs.autoplay = attrs.loop = attrs.controls = true\n\n\t\tthis.el.query('figure').lastChild.innerHTML = common.parseHTML\n\t\t\t`<${isVideo ? 'video' : 'img'} ${attrs}>`;\n\t\tthis.model.set({\n\t\t\timageExpanded: true,\n\t\t\ttallImage: height > window.innerHeight\n\t\t});\n\t},\n\trenderAudio(img) {\n\t\tthis.el.query('figure').append(util.parseDOM(common.parseHTML\n\t\t\t`<audio src=\"${oneeSama.imagePaths().src + img.src}\"\n\t\t\t\twidth=\"300\"\n\t\t\t\theight=\"3em\"\n\t\t\t\tautoplay loop controls\n\t\t\t>\n\t\t\t</audio>`));\n\t\tthis.model.set('imageExpanded', true);\n\t}\n});\n\n// Expand all images\nconst ExpanderModel = Backbone.Model.extend({\n\tinitialize() {\n\t\t$threads.on('click', '#expandImages', e => {\n\t\t\te.preventDefault();\n\t\t\tthis.toggle();\n\t\t});\n\t},\n\ttoggle() {\n\t\tconst expand = !this.get('expand');\n\t\tthis.set('expand', expand).massToggle(expand);\n\t\t$threads\n\t\t\t.find('#expandImages')\n\t\t\t.text(main.lang.expander[+expand]);\n\t},\n\t// More efficent than individual listeners\n\tmassToggle(expand) {\n\t\tconst fit = options.get('inlinefit');\n\t\tif (fit === 'none')\n\t\t\treturn;\n\t\tlet models = state.posts.models;\n\t\tfor (let i = 0, l = models.length; i < l; i++) {\n\t\t\tlet model = models[i],\n\t\t\t\timg = model.get('image');\n\t\t\tif (!img)\n\t\t\t\tcontinue;\n\t\t\tif (expand)\n\t\t\t\tmodel.dispatch('fitImage', img, fit);\n\t\t\telse\n\t\t\t\tmodel.dispatch('renderImage', null, img);\n\t\t}\n\t}\n});\n\nconst massExpander = exports.massExpander = new ExpanderModel();\nmain.reply('massExpander:unset', () => massExpander.unset());\n\n// Proxy image clicks to views. More performant than dedicated listeners for\n// each view.\n$threads.on('click', 'img, video', function(e) {\n\tif (options.get('inlinefit') == 'none' || e.which !== 1)\n\t\treturn;\n\tlet model = util.getModel(e.target);\n\tif (!model)\n\t\treturn;\n\te.preventDefault();\n\n\t// Remove image hover preview, if any\n\tmain.request('imager:clicked');\n\tmodel.dispatch('toggleImageExpansion', !model.get('imageExpanded'),\n\t\tmodel.get('image'), true);\n});\n\n// Reveal/hide thumbnail by clicking [Show]/[Hide] in hidden thumbnail mode\n$threads.on('click', '.imageToggle', function(e) {\n\te.preventDefault();\n\tlet model = util.getModel(e.target);\n\tif (!model)\n\t\treturn;\n\tmain.follow(() =>\n\t\tmodel.dispatch('renderImage', !model.get('thumbnailRevealed')));\n});\n","/*\nExports submodules from the posts module\n */\n\nmodule.exports = {\n\timager: require('./imager'),\n\tMenu: require('./menu'),\n\tcommon: require('./common'),\n\tArticle: require('./article'),\n\tSection: require('./section'),\n\tmodels: require('./models'),\n\tnonce: require('./nonce'),\n\tembed: require('./embed'),\n\tposting: require('./posting')\n};\n","/*\n Post action header dropdown menu\n */\n\nconst main = require('../main'),\n\t{$, _, Backbone, common, util, lang, state} = main;\n\nconst MenuView = module.exports = Backbone.View.extend({\n\tclassName: 'popup-menu glass',\n\ttagName: 'ul',\n\t// Post menu items\n\tactions: ['report', 'hide'],\n\tevents: {\n\t\tclick: 'handleClick'\n\t},\n\tinitialize({parent}) {\n\t\tparent._popup_menu = this;\n\t\tthis.parent = parent;\n\t\tthis.render();\n\t},\n\trender() {\n\t\tlet html = '';\n\t\tfor (let action of this.actions) {\n\t\t\thtml += `<li data-type=\"${action}\">${lang[action]}</li>`\n\t\t}\n\t\tconst {el, parent} = this;\n\t\tel.innerHTML = html;\n\t\tparent.append(el);\n\n\t\t// Calculate position. Can't use CSS translate, because it shifts\n\t\t// the background.\n\t\tel.style.left = el.getBoundingClientRect().left\n\t\t\t- (util.outerWidth(el) + el.offsetWidth) * 0.6\n\t\t\t+ 'px';\n\t},\n\t// Forward post model to appropriate handler\n\thandleClick(e) {\n\t\te.stopPropagation();\n\t\tmain.request(e.target.getAttribute('data-type'), this.model);\n\t\tthis.remove();\n\t},\n\tremove() {\n\t\tthis.parent._popup_menu = null;\n\t\tthis.el.remove();\n\t\tthis.stopListening();\n\t}\n});\n\nmain.reply('menu:extend', action =>\n\t_.extend(MenuView.prototype.actions, action));\n\nmain.$threads.on('click', '.control', event => {\n\tconst {target} = event;\n\n\t// Menu already exists on the element. Remove it instead.\n\tif (target._popup_menu)\n\t\treturn target._popup_menu.remove();\n\n\tconst model = util.getModel(target);\n\tif (model)\n\t\tnew MenuView({parent: target, model});\n});\n","/*\nGeneral post backbone models\n */\n\nlet main = require('../main'),\n\t{_, Backbone, state} = main;\n\nexports.Post = Backbone.Model.extend({\n\tidAttribute: 'num',\n\tinitialize() {\n\t\tstate.posts.add(this);\n\t},\n\t// Proxy commands to the view(s). Using a central channel helps us reduce\n\t// listener count overhead.\n\tdispatch(command, ...args) {\n\t\tthis.trigger('dispatch', command, ...args);\n\t},\n\tremove() {\n\t\t// Remove view\n\t\tthis.stopListening().dispatch('remove');\n\t\t// Remove from post collection\n\t\tstate.posts.remove(this);\n\t},\n\tupdate(frag, links, dice) {\n\t\tconst updates = {\n\t\t\tbody: this.get('body') + frag\n\t\t};\n\t\tif (links)\n\t\t\t_.extend(this.get('links'), links);\n\t\tif (dice)\n\t\t\tupdates.dice = (this.get('dice') || []).concat(dice);\n\t\tthis.set(updates);\n\t},\n\t// Calling a method is always less overhead than binding a dedicated\n\t// listener for each post's image\n\tsetImage(image, silent) {\n\t\tthis.set('image', image);\n\t\tif (!silent)\n\t\t\tthis.dispatch('renderImage', image);\n\t},\n\tsetSpoiler(spoiler, info) {\n\t\tlet image = this.get('image');\n\t\timage.spoiler = spoiler;\n\t\tthis.dispatch('renderImage', image);\n\t\tthis.moderationInfo(info);\n\t},\n\tremoveImage(info) {\n\t\t// Staff won't have the image removed, but rerendered with\n\t\t// indication, that it has been deleted and extra information\n\t\tthis.moderationInfo(info) \n\t\t\t|| this.unset('image').dispatch('renderImage');\n\t},\n\tdeletePost(info) {\n\t\tthis.moderationInfo(info) || this.remove();\n\t},\n\tsetBan(display, info) {\n\t\t// Displaying the 'USER WAS BANNED FOR THIS POST' message and\n\t\t// renderring the moderation info are independant actions\n\t\tif (display)\n\t\t\tthis.set('ban', true).dispatch('renderBan');\n\t\tthis.moderationInfo(info);\n\t},\n\taddBacklink(num, op) {\n\t\tlet backlinks = this.get('backlinks') || {};\n\t\tbacklinks[num] = op;\n\t\tthis.set({backlinks})\n\t\t\t.dispatch('renderBacklinks', backlinks);\n\t},\n\t// Add info about the moderation action taken. This is only used on\n\t// authenticated staff clients, but for sanity, lets keep it here in\n\t// common model methods.\n\tmoderationInfo(info) { \n\t\tif (!info)\n\t\t\treturn false;\n\t\tconst mod = this.get('mod') || [];\n\t\tmod.push(info);\n\t\tthis.set('mod', mod)\n\t\t\t.dispatch('renderModerationInfo', mod);\n\t\treturn true;\n\t}\n});\n\nexports.Thread = exports.Post.extend({\n\tdefaults: {\n\t\treplies: [],\n\t\tomit: 0,\n\t\timage_omit: 0\n\t},\n\tinitialize() {\n\t\t// Omitted images can only be calculated, if there are omitted posts\n\t\tif (this.get('omit'))\n\t\t\tthis.getImageOmit();\n\t\tstate.posts.add(this);\n\t},\n\tremove() {\n\t\tthis.stopListening().dispatch('remove');\n\t\tstate.posts.remove(this);\n\n\t\t// Propagate model removal to all replies\n\t\tconst replies = this.get('replies');\n\t\tfor (let i = 0, lim = replies.length; i < lim; i++) {\n\t\t\tlet model = state.posts.get(replies[i]);\n\t\t\tif (model)\n\t\t\t\tmodel.remove();\n\t\t}\n\t},\n\t/*\n\t With the current renderring and storage implementations we can not get the\n\t image omit count during the server-side render.\n\t */\n\tgetImageOmit() {\n\t\tlet image_omit = this.get('imgctr') -1;\n\t\tconst replies = this.get('replies');\n\n\t\tfor (let i = 0, lim = replies.length; i < lim; i++) {\n\t\t\tlet model = state.posts.get(replies[i]);\n\t\t\tif (!model)\n\t\t\t\tcontinue;\n\t\t\tif (model.get('image'))\n\t\t\t\timage_omit--;\n\t\t}\n\t\tthis.set('image_omit', image_omit);\n\t},\n\ttoggleLocked(val, info) {\n\t\tthis.moderationInfo(info);\n\t\tthis.set('locked', val).dispatch('renderLocked', val);\n\t}\n});\n","/*\nCryptographic nonces for websocket transactions\n */\n\nlet main = require('../main'),\n\t{common, state} = main;\n\nlet nonceCache = {};\n\nfunction get() {\n\tvar nonces;\n\tif (window.localStorage) {\n\t\ttry {\n\t\t\tnonces = JSON.parse(localStorage.postNonces);\n\t\t}\n\t\tcatch (e) {}\n\t}\n\telse\n\t\tnonces = nonceCache;\n\treturn nonces || {};\n}\nmain.reply('nonce:get', get);\n\nfunction save_nonces(nonces) {\n\tif (window.localStorage)\n\t\tlocalStorage.postNonces = JSON.stringify(nonces);\n\telse\n\t\tnonceCache = nonces;\n}\n\nfunction today_id() {\n\treturn Math.floor(Date.now() / (1000*60*60*24));\n}\n\nfunction create() {\n\tconst nonces = get(),\n\t\tnonce = common.randomID(32);\n\tnonces[nonce] = {\n\t\ttab: state.page.get('tabID'),\n\t\tday: today_id()\n\t};\n\tsave_nonces(nonces);\n\treturn nonce;\n}\nmain.reply('nonce:create', create);\n\n// Expire old nonces\nsetTimeout(function() {\n\tif (!window.localStorage)\n\t\treturn;\n\t// we need a lock on postNonces really\n\tlet nonces = get();\n\n\t// people messing with their system clock will mess with expiry, doh\n\tlet changed;\n\tconst yesterday = today_id() - 1;\n\tfor (let nonce in nonces) {\n\t\tif (nonces[nonce].day >= yesterday)\n\t\t\tcontinue;\n\t\tdelete nonces[nonce];\n\t\tchanged = true;\n\t}\n\n\tif (changed)\n\t\tsave_nonces(nonces);\n}, Math.floor(Math.random()*5000));\n\nfunction destroy(nonce) {\n\t// delete only after a delay so all tabs notice that it's ours\n\tsetTimeout(function() {\n\t\tlet nonces = get();\n\t\tif (!nonces[nonce])\n\t\t\treturn;\n\t\tdelete nonces[nonce];\n\t\tsave_nonces(nonces);\n\t}, 10000);\n}\nmain.reply('nonce:destroy', destroy);\n","/*\n * Evertything related to writing and commiting posts\n */\n\nconst Article = require('./article'),\n\tmain = require('../main'),\n\tembed = require('./embed'),\n\tident = require('./identity'),\n\timager = require('./imager'),\n\t{$, _, Backbone, Cookie, common, config, connSM, util, lang, oneeSama,\n\t\toptions, postSM, state} = main;\n\nlet postForm, postModel;\n/*\n The variable gets overwritten, so a simple refference will not do. Calling a\n fucntion to retrieve the var each time solves the problem.\n */\nmain.reply('postForm', () => postForm)\n\t.reply('postModel', () => postModel)\n\t.reply('postForm:indentity', () => postForm && postForm.renderIdentity());\n\n// Minimal size of the input buffer\nlet\tinputMinSize = 300;\n// For mobile\nif (window.screen && screen.width <= 320)\n\tinputMinSize = 50;\n\nconst ComposerModel = Backbone.Model.extend({idAttribute: 'num'});\n\n// Synchronyse postform state with websocket connectivity\nconnSM.on('synced', postSM.feeder('sync'));\nconnSM.on('dropped', postSM.feeder('desync'));\nconnSM.on('desynced', postSM.feeder('desync'));\n\n// Allow remotely altering posting FSM state\nmain.reply('postSM:feed', state => postSM.feed(state));\n\npostSM.act('* + desync -> none', () => {\n\t// TODO: Desync logic\n\tif (postForm) {\n\t\tpostForm.el.classList.remove('editing');\n\t\tpostForm.$input.val('');\n\t\tpostForm.finish();\n\t}\n\tmain.$threads.find('aside.posting').hide();\n});\n\npostSM.act('none + sync, draft, alloc + done -> ready', () => {\n\t// TODO: Add unfinished post checking\n\n\tif (postForm) {\n\t\tpostForm.remove();\n\t\tpostForm = postModel = null;\n\t}\n\tfor (let el of main.$threads[0].queryAll('aside.posting')) {\n\t\tel.style.display = '';\n\t}\n});\n\n// Make new postform\npostSM.act('ready + new -> draft', aside => {\n\tlet op,\n\t\tsection = aside.closest('section');\n\tif (section)\n\t\top = util.getNum(section);\n\telse\n\t\tsection = document.createElement('section');\n\n\t// Shift OP's replies on board pages\n\tif (op && !state.page.get('thread'))\n\t\tstate.posts.get(op).dispatch('shiftReplies', true);\n\n\tpostForm = new ComposerView({\n\t\tmodel: postModel = new ComposerModel({op}),\n\t\tdestination: aside,\n\t\tsection\n\t});\n});\n\npostSM.preflight('draft', aside => aside.matches('aside'));\n\npostSM.act('draft + alloc -> alloc', msg => postForm.onAllocation(msg));\n\n// Render image upload status messages\nmain.dispatcher[common.IMAGE_STATUS] = msg =>\n\tpostForm && postForm.dispatch(msg[0]);\n\nmain.$doc.on('click', 'aside.posting a', function () {\n\tpostSM.feed('new', this.parentNode);\n});\n\nmain.$doc.on('keydown', handle_shortcut);\n\nfunction handle_shortcut(event) {\n\tif (!event.altKey)\n\t\treturn;\n\n\tconst opts = options.attributes;\n\tswitch(event.which) {\n\t\tcase opts.new:\n\t\t\tconst aside = document.query('aside.posting');\n\t\t\tif (aside) {\n\t\t\t\tpostSM.feed('new', aside);\n\t\t\t\tprevent();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opts.togglespoiler:\n\t\t\tif (postForm) {\n\t\t\t\tpostForm.onToggle(event);\n\t\t\t\tprevent();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opts.done:\n\t\t\tif (postForm && !postForm.$submit.attr('disabled')) {\n\t\t\t\tpostForm.finish();\n\t\t\t\tprevent();\n\t\t\t}\n\t\t\tbreak;\n\t\t// Insert text spoiler\n\t\tcase opts.textSpoiler:\n\t\t\tif (postForm) {\n\t\t\t\tvar postState = this.imouto.state2.spoiler;\n\t\t\t\t// Was spoiler already started?\n\t\t\t\tvar sp = (postState ? '[/' : ' [') + 'spoiler]';\n\t\t\t\tthis.imouto.state2.spoiler = !postState;\n\t\t\t\tthis.$input.val(this.$input.val() + sp);\n\t\t\t\tprevent();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase opts.expandAll:\n\t\t\timager.massExpander.toggle();\n\t\t\tprevent();\n\t\t\tbreak;\n\t\tcase opts.workMode:\n\t\t\tconst val = main.oneeSama.workMode = !main.oneeSama.workMode;\n\t\t\tCookie.set('workModeTOG', val);\n\t\t\tconst banner = document.querySelector(\"h1 > img\");\n\t\t\tif(banner!=null)\n\t\t\t\tbanner.style.display =  val? 'none':'';\n\t\t\tdocument.getElementById('theme').setAttribute('href',\n\t\t\t\t\t`${config.MEDIA_URL}css/${val? state.hotConfig.get('DEFAULT_CSS'): main.options.get(\"theme\")}.css?v=${main.cssHash}`);\n\t\t\toneeSama.thumbStyle = val? 'hide': main.options.get('thumbs');\n\t\t\tmain.options.trigger(\"workModeTOG\");\n\t\t\twindow.addEventListener('beforeunload', function () {\n\t\t\t\tCookie.set(\"workModeTOG\",false);\n\t\t\t});\n\t\t\tprevent()\n\t\t\tbreak;\n\t}\n\n\tfunction prevent() {\n\t\tevent.stopImmediatePropagation();\n\t\tevent.preventDefault();\n\t}\n}\n\n// TODO: Unify self-updates with OneeSama; this is redundant\nmain.oneeSama.hook('insertOwnPost', ({links}) => {\n\tif (!postForm || !links)\n\t\treturn;\n\tpostForm.$buffer.find('.nope').each(function () {\n\t\tvar $a = $(this);\n\t\tconst text = $a.text(),\n\t\t\tm = text.match(/^>>(\\d+)/);\n\t\tif (!m)\n\t\t\treturn;\n\t\tconst num = m[1],\n\t\t\top = links[num];\n\t\tif (!op)\n\t\t\treturn;\n\t\tlet $ref = $(common.join([postForm.imouto.postRef(num, op, false)]));\n\t\t$a.attr('href', $ref.attr('href')).attr('class', 'history');\n\t\tconst refText = $ref.text();\n\t\tif (refText != text)\n\t\t\t$a.text(refText);\n\t});\n});\n\nconst ArticleComposer = Article.extend({\n\tevents: {\n\t\t'click #cancel': 'cancel',\n\t\t'change #imageInput': 'onImageChosen',\n\t\t'input #trans': 'onInput',\n\t\t'keydown #trans': 'onKeyDown',\n\t\t'click #done': 'finish',\n\t\t'click #toggle': 'onToggle'\n\t},\n\tinitialize(args) {\n\t\t// super() call\n\t\tArticle.prototype.initialize.call(this);\n\t\tthis.listenTo(this.model, {\n\t\t\t'change': this.renderButtons,\n\t\t\t'change:spoiler': this.renderSpoilerPane\n\t\t});\n\t\tthis.render(args).insertIntoDOM(args);\n\t\tthis.model.set({\n\t\t\tspoiler: 0,\n\t\t\tnextSpoiler: -1\n\t\t});\n\n\t\tthis.pending = '';\n\t\tthis.line_count = 1;\n\t\tthis.char_count = 0;\n\n\t\t// Initialize the form's private rendering singleton instance\n\t\tconst imouto = this.imouto = new common.OneeSama({\n\t\t\tcallback: inject,\n\t\t\top: state.page.get('thread'),\n\t\t\tblockqoute: this.blockqoute,\n\t\t\teLinkify: main.oneeSama.eLinkify,\n\t\t\tlang: main.lang,\n\t\t\ttamashii(num) {\n\t\t\t\tlet section = document.query('#p' + num);\n\t\t\t\tsection = section && section.closest('section');\n\t\t\t\tif (section) {\n\t\t\t\t\tconst desc = num in state.mine.readAll() && lang.you;\n\t\t\t\t\treturn this.postRef(num, util.getNum(section), desc);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\treturn `<a class=\"nope\">&gt;&gt;${num}</a>`;\n\t\t\t}\n\t\t});\n\t\timouto.setModel(this.model);\n\t},\n\t// Initial render\n\trender() {\n\t\t// Define attributes separatly for readbility\n\t\tconst attrs = {\n\t\t\tinput: {\n\t\t\t\tname: 'body',\n\t\t\t\tid: 'input',\n\t\t\t\trows: 1,\n\t\t\t\tclass: 'themed exclude',\n\t\t\t\tautocomplete: main.isMobile\n\t\t\t},\n\t\t\tform: {\n\t\t\t\tmethod: 'post',\n\t\t\t\tenctype: 'multipart/form-data',\n\t\t\t\ttarget: 'upload',\n\t\t\t\tid: 'uploadForm'\n\t\t\t},\n\t\t\tcancel: {\n\t\t\t\ttype: 'buttom',\n\t\t\t\tvalue: lang.cancel,\n\t\t\t\tid: 'cancel'\n\t\t\t},\n\t\t\timageInput: {\n\t\t\t\ttype:'file',\n\t\t\t\tid: 'imageInput',\n\t\t\t\tname: 'image',\n\t\t\t\taccept: 'image/*;.webm;.pdf;.mp3'\n\t\t\t},\n\t\t\ttoggle: {\n\t\t\t\ttype: 'button',\n\t\t\t\tid: 'toggle'\n\t\t\t}\n\t\t};\n\n\t\tthis.el.innerHTML = parseHTML\n\t\t\t`<header>\n\t\t\t\t<a class=\"name nope\" target=\"_blank\">\n\t\t\t\t\t<b></b>\n\t\t\t\t</a>\n\t\t\t</header>\n\t\t\t<span class=\"oi control\" data-glyph=\"chevron-bottom\"></span>\n\t\t\t<div class=\"container\">\n\t\t\t\t<blockquote>\n\t\t\t\t\t<p id=\"buffer\" class=\"exclude\"></p>\n\t\t\t\t\t<p id=\"lineBuffer\" class=\"exclude\"></p>\n\t\t\t\t\t<textarea ${attrs.input}></textarea>\n\t\t\t\t</blockquote>\n\t\t\t\t<form ${attrs.form}>\n\t\t\t\t\t<input ${attrs.cancel}>\n\t\t\t\t\t<input ${attrs.imageInput}>\n\t\t\t\t\t<input ${attrs.toggle}>\n\t\t\t\t\t<strong id=\"uploadStatus\"></strong>\n\t\t\t\t</form>\n\t\t\t\t<small></small>\n\t\t\t</div>`;\n\n\t\t// Cache elements to avoid lookup\n\t\tconst els = ['buffer', 'lineBuffer', 'input', 'uploadForm', 'cancel',\n\t\t\t'imageInput', 'toggle', 'uploadStatus', 'hiddenUpload', 'sizer'];\n\t\tfor (let el of els) {\n\t\t\tthis[el] = document.query('#' + el);\n\t\t}\n\t\tthis.renderIdentity();\n\t\treturn this;\n\t},\n\t// Name, emaail and tripcode field\n\trenderIdentity() {\n\t\t// Model has already been alocated and has a proper identity rendered\n\t\tif (this.model.get('num'))\n\t\t\treturn;\n\t\tconst parsed = common.parse_name(main.$name.val(), main.$email.val()),\n\t\t\thaveTrip = !!(parsed[1] || parsed[2]);\n\t\tconst el = this.el.query('.name'),\n\t\t\tname = el.query('a');\n\t\tif (parsed[0])\n\t\t\tname.textContent = parsed[0] + ' ';\n\t\telse\n\t\t\tname.tetxContent = haveTrip ? '' : lang.anon;\n\t\tif (haveTrip)\n\t\t\tutil.parseDOM(' <code>!?</code>').forEach(el => name.after(el));\n\n\t\t// Insert staff title\n\t\tmain.oneeSama.trigger('fillMyName', name);\n\t\tconst email = main.$email.val().trim();\n\t\tif (email) {\n\t\t\tel.setAttribute('href', 'mailto:' + email);\n\t\t\tel.classList.remove('nope');\n\t\t\tel.classList.add('email');\n\t\t}\n\t\telse {\n\t\t\tel.removeAttribute('href');\n\t\t\tel.classList.add('nope');\n\t\t\tel.classList.remove('email');\n\t\t}\n\t},\n\tinsertIntoDOM({destination}) {\n\t\tdestination.before(this.el);\n\t\tthis.resizeInput();\n\t\tmain.$threads.queryAll('aside.postsing').forEach(el =>\n\t\t\tel.style.display = 'none');\n\t\tthis.fun();\n\t},\n\t/*\n\t Allows keeping the input buffer sized as if the text was monospace,\n\t without actually displaying monospace font. Keeps the input buffer from\n\t shifting around needlessly.\n\t */\n\tresizeInput(val) {\n\t\tconst {sizer, input} = this;\n\t\tif (typeof val !== 'string')\n\t\t\tval = input.value;\n\t\tsizer.textContent = val;\n\t\tlet size = sizer.width + common.INPUT_ROOM;\n\t\tsize = Math.max(size, inputMinSize\n\t\t\t- input.getBoundingClientRect().left\n\t\t\t- this.el.getBoundingClientRect().left);\n\t\tthis.input.style.width = size + 'px';\n\t},\n\trenderButtons() {\n\t\tconst {num, uploading, uploaded, uploadStatus, sentAllocRequest}\n\t\t\t= this.model.attributes;\n\t\tconst allocWait = sentAllocRequest && !num;\n\t\tthis.submit.disabled = !!(uploading || allocWait);\n\t\tif (uploaded)\n\t\t\tthis.submit.style.marginLeft = 0;\n\t\tthis.cancel.disabled = !!allocWait;\n\t\tthis.cancel.style.display = (!num || uploading) ? '' : 'none';\n\t\tthis.imageInput.disabled = !!uploading;\n\t\tthis.uploadStatus.innerHTML = uploadStatus;\n\t},\n\trenderSpoilerPane(model, spoiler) {\n\t\tconst background = spoiler\n\t\t\t? `${config.MEDIA_URL}spoil/spoil${spoiler}.png`\n\t\t\t: config.MEDIA_URL + 'css/ui/pane.png';\n\t\tthis.toggle.style.backgroundImage = `url(\"${background}\")`;\n\t}\n});\n\nconst ComposerView = Backbone.View.extend({\n\tevents: {\n\t\t'input #trans': 'onInput',\n\t\t'keydown #trans': 'onKeyDown',\n\t\t'click #done': 'finish',\n\t\t'click #toggle': 'onToggle'\n\t},\n\tinitialize(args) {\n\t\tthis.listenTo(this.model, {\n\t\t\t'change': this.renderButtons,\n\t\t\t'change:spoiler': this.renderSpoilerPane\n\t\t});\n\n\t\tthis.render(args);\n\n\t\tthis.pending = '';\n\t\tthis.line_count = 1;\n\t\tthis.char_count = 0;\n\n\t\t// Initialize the form's private rendering singleton instance\n\t\tlet imouto = this.imouto = new common.OneeSama({\n\t\t\tcallback: inject,\n\t\t\top: state.page.get('thread'),\n\t\t\tstate: [common.S_BOL, 0],\n\n\t\t\t// TODO: Convert current OneeSama.state array to more flexible\n\t\t\t// object\n\t\t\tstate2: {spoiler: 0},\n\t\t\t$buffer: this.$buffer,\n\t\t\teLinkify: main.oneeSama.eLinkify,\n\t\t\tlang: main.lang,\n\t\t\ttamashii(num) {\n\t\t\t\tlet section = document.query('#p' + num);\n\t\t\t\tsection = section && section.closest('section');\n\t\t\t\tif (section) {\n\t\t\t\t\tconst desc = num in state.mine.readAll() && this.lang.you;\n\t\t\t\t\treturn this.postRef(num, util.getNum(section), desc);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\treturn `<a class=\"nope\">&gt;&gt;${num}</a>`;\n\t\t\t}\n\t\t});\n\t\timouto.hook('spoilerTag', util.touchable_spoiler_tag);\n\t\tmain.oneeSama.trigger('imouto', imouto);\n\t},\n\t// Initial render\n\trender({destination, section}) {\n\t\tconst op = this.model.get('op');\n\t\tthis.setElement((op ? document.createElement('article') : section));\n\n\t\t// A defined op means the post is a reply, not a new thread\n\t\tthis.isThread = !op;\n\n\t\tthis.$buffer = $('<p/>');\n\t\tthis.$lineBuffer = $('<p/>');\n\t\tthis.$meta = $('<header><a class=\"nope\"><b/></a> <time/></header>');\n\t\tthis.$input = $('<textarea/>', {\n\t\t\tname: 'body',\n\t\t\tid: 'trans',\n\t\t\trows: '1',\n\t\t\tclass: 'themed',\n\t\t\tautocomplete: main.isMobile\n\t\t});\n\t\tthis.$submit = $('<input/>', {\n\t\t\tid: 'done',\n\t\t\ttype: 'button',\n\t\t\tvalue: main.lang.done\n\t\t});\n\t\tthis.$subject = $('<input/>', {\n\t\t\tid: 'subject',\n\t\t\tclass: 'themed',\n\t\t\tmaxlength: state.hotConfig.SUBJECT_MAX_LENGTH,\n\t\t\twidth: '80%'\n\t\t});\n\t\tthis.$blockquote = $('<blockquote/>');\n\n\t\t/*\n\t\t Allows keeping the input buffer sized as if the text was monospace,\n\t\t without actually displaying monospace font. Keeps the input buffer from\n\t\t shifting around needlessly.\n\t\t */\n\t\tthis.$sizer = $('<pre/>').appendTo('body');\n\n\t\tthis.$blockquote.append(this.$buffer, this.$lineBuffer, this.$input);\n\t\tthis.$el.append(this.$meta, this.$blockquote, '<small/>');\n\t\tif (this.isThread) {\n\t\t\tthis.$el.append(`<label for=\"subject\">${lang.subject}: </label>`,\n\t\t\t\tthis.$subject);\n\t\t\tthis.$blockquote.hide();\n\t\t}\n\t\tthis.$uploadForm = this.renderUploadForm();\n\t\tthis.$el.append(this.$uploadForm);\n\n\t\t// Add a menu to the postform\n\t\tmain.oneeSama.trigger('draft', this.$el);\n\t\tthis.renderIdentity();\n\n\t\t// Insert into the DOM\n\t\tdestination.style.display = 'none';\n\t\tif (this.isThread) {\n\t\t\tdestination.after(this.el);\n\t\t\tthis.el.after(document.createElement('hr'));\n\t\t\tthis.$subject.focus();\n\t\t}\n\t\telse {\n\t\t\tdestination.before(this.el);\n\t\t\tthis.resizeInput();\n\t\t\tthis.$input.focus();\n\t\t}\n\n\t\tmain.$threads.find('aside.posting').hide();\n\t\tthis.fun();\n\t},\n\t// Render the name, email, and admin title, if any\n\trenderIdentity() {\n\t\t// Model has already been alocated and has a proper identity rendered\n\t\tif (this.model.get('num'))\n\t\t\treturn;\n\t\tconst parsed = common.parse_name(main.$name.val(), main.$email.val()),\n\t\t\thaveTrip = !!(parsed[1] || parsed[2]);\n\t\tlet $b = this.$meta.find('b');\n\t\tif (parsed[0])\n\t\t\t$b.text(parsed[0] + ' ');\n\t\telse\n\t\t\t$b.text(haveTrip ? '' : main.lang.anon);\n\t\tif (haveTrip)\n\t\t\t$b.append(' <code>!?</code>');\n\t\t\n\t\t// Insert staff title\n\t\tmain.oneeSama.trigger('fillMyName', $b);\n\t\tconst email = main.$email.val().trim();\n\t\tlet $tag = this.$meta.children('a').first();\n\t\tif (email) {\n\t\t\t$tag.attr({\n\t\t\t\thref: 'mailto:' + email,\n\t\t\t\ttarget: '_blank',\n\t\t\t\tclass: 'email'\n\t\t\t});\n\t\t}\n\t\telse\n\t\t\t$tag.removeAttr('href').removeAttr('target').attr('class', 'nope');\n\t},\n\trenderButtons() {\n\t\tconst attrs = this.model.attributes,\n\t\t\tallocWait = attrs.sentAllocRequest && !attrs.num,\n\t\t\td = attrs.uploading || allocWait;\n\t\t// Beware of undefined!\n\t\tthis.$submit.prop('disabled', !!d);\n\t\tif (attrs.uploaded)\n\t\t\tthis.$submit.css({'margin-left': '0'});\n\t\tthis.$cancel.prop('disabled', !!allocWait);\n\t\tthis.$cancel.toggle(!!(!attrs.num || attrs.uploading));\n\t\tthis.$imageInput.prop('disabled', !!attrs.uploading);\n\t\tthis.$uploadStatus.html(attrs.uploadStatus);\n\t},\n\trenderSpoilerPane(model, sp) {\n\t\tconst background = sp ? `${config.MEDIA_URL}spoil/spoil${sp}.png`\n\t\t\t: config.MEDIA_URL + 'css/ui/pane.png';\n\t\tthis.$toggle.css('background-image', `url(\"${background}\")`);\n\t},\n\trenderUploadForm() {\n\t\tvar $form = $('<form method=\"post\" enctype=\"multipart/form-data\" '\n\t\t\t+ 'target=\"upload\"></form>');\n\t\tthis.$cancel = $('<input/>', {\n\t\t\ttype: 'button',\n\t\t\tvalue: lang.cancel,\n\t\t\tclick: $.proxy(this, 'cancel')\n\t\t});\n\t\tthis.$imageInput = $('<input/>', {\n\t\t\ttype: 'file',\n\t\t\tid: 'image',\n\t\t\tname: 'image',\n\t\t\taccept: config.WEBM ? 'imager/*;.webm' : 'image/*',\n\t\t\tchange: $.proxy(this, 'onImageChosen')\n\t\t});\n\t\tthis.$toggle = $('<input/>', {\n\t\t\ttype: 'button',\n\t\t\tid: 'toggle'\n\t\t});\n\t\tthis.$uploadStatus = $('<strong/>');\n\t\t$form.append(this.$cancel,\n\t\t\tthis.$imageInput,\n\t\t\tthis.$toggle, ' ',\n\t\t\tthis.$uploadStatus);\n\t\tthis.$iframe = $('<iframe/>', {\n\t\t\tsrc: '',\n\t\t\tname: 'upload',\n\t\t\tid: 'hidden-upload'\n\t\t}).appendTo('body');\n\t\tthis.model.set({\n\t\t\tspoiler: 0,\n\t\t\tnextSpoiler: -1\n\t\t});\n\t\treturn $form;\n\t},\n\t// Cancel file upload\n\tcancel() {\n\t\tif (this.model.get('uploading')) {\n\t\t\tthis.$iframe.remove();\n\t\t\tthis.$iframe = $('<iframe></iframe>', {\n\t\t\t\tsrc: '',\n\t\t\t\tname: 'upload',\n\t\t\t\tid: 'hidden-upload'\n\t\t\t}).appendTo('body');\n\t\t\tthis.uploadError('');\n\t\t\tthis.model.set({cancelled: true});\n\t\t}\n\t\telse\n\t\t\tthis.finish();\n\t},\n\tonImageChosen() {\n\t\tif (this.model.get('uploading') || this.model.get('uploaded'))\n\t\t\treturn;\n\t\tif (!this.$imageInput.val()) {\n\t\t\tthis.model.set('uploadStatus', '');\n\t\t\treturn;\n\t\t}\n\t\tconst extra = this.prepareUpload();\n\t\tfor (var k in extra) {\n\t\t\t$('<input type=hidden>')\n\t\t\t\t.attr('name', k)\n\t\t\t\t.val(extra[k])\n\t\t\t\t.appendTo(this.$uploadForm);\n\t\t}\n\t\tthis.$uploadForm.prop('action', util.uploadURL());\n\t\tthis.$uploadForm.submit();\n\t\tthis.$iframe.load(function() {\n\t\t\tif (!postForm)\n\t\t\t\treturn;\n\t\t\tvar doc = this.contentWindow || this.contentDocument;\n\t\t\tif (!doc)\n\t\t\t\treturn;\n\t\t\ttry {\n\t\t\t\tvar error = $(doc.document || doc).text();\n\t\t\t\t/*\n\t\t\t\t if it's a real response, it'll postMessage to us, so we don't have\n\t\t\t\t to do anything.\n\t\t\t\t */\n\t\t\t\tif (/legitimate imager response/.test(error))\n\t\t\t\t\treturn;\n\t\t\t\t// sanity check for weird browser responses\n\t\t\t\tif (error.length < 5 || error.length > 100)\n\t\t\t\t\terror = lang.unknownUpload;\n\t\t\t\tpostForm.uploadError(error);\n\t\t\t}\n\t\t\tcatch(e) {\n\t\t\t\t/*\n\t\t\t\t likely cross-origin restriction\n\t\t\t\t wait before erroring in case the message shows up\n\t\t\t\t */\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tpostForm.uploadFallbackMessage();\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t});\n\t\tthis.notifyUploading();\n\t},\n\tprepareUpload() {\n\t\tthis.model.set('uploadStatus', lang.uploading);\n\t\tthis.$input.focus();\n\t\tconst attrs = this.model.attributes;\n\t\treturn {spoiler: attrs.spoiler, op: attrs.op || 0};\n\t},\n\t/*\n\t this is just a fallback message for when we can't tell, if there was an\n\t error due to cross-origin restrictions\n\t */\n\tuploadFallbackMessage() {\n\t\tvar a = this.model.attributes,\n\t\t\tstat = a.uploadStatus;\n\t\tif (!a.cancelled && a.uploading && (!stat || stat == lang.uploading))\n\t\t\tthis.model.set('uploadStatus', lang.unknownResult);\n\t},\n\tnotifyUploading() {\n\t\tthis.model.set({uploading: true, cancelled: false});\n\t\tthis.$input.focus();\n\t},\n\tresizeInput(val) {\n\t\tif (typeof val !== 'string')\n\t\t\tval = this.$input.val();\n\t\tthis.$sizer.text(val);\n\t\tvar size = this.$sizer.width() + common.INPUT_ROOM;\n\t\tsize = Math.max(size, inputMinSize\n\t\t\t- this.$input.offset().left - this.$el.offset().left);\n\t\tthis.$input.css('width', size + 'px');\n\t},\n\tonInput(val) {\n\t\tif (val === undefined || val instanceof $.Event)\n\t\t\tval = this.$input.val();\n\t\tvar start = this.$input[0].selectionStart,\n\t\t\tend = this.$input[0].selectionEnd;\n\n\t\tvar changed = false,\n\t\t\tm, time, video;\n\n\t\t// Turn YouTube links into proper refs\n\t\twhile(true) {\n\t\t\tm = val.match(embed.youtube_url_re);\n\t\t\tif (!m)\n\t\t\t\tbreak;\n\t\t\t// Substitute\n\t\t\ttime = this.findTimeArg(m[3])\n\t\t\t\t|| this.findTimeArg(m[1])\n\t\t\t\t|| m[4]\n\t\t\t\t|| '';\n\t\t\tvideo = '>>>/watch?v=' + m[2] + time;\n\t\t\tval = embedRewrite(m, video);\n\t\t}\n\n\t\t//Youtu.be links\n\t\twhile(true) {\n\t\t\tm = val.match(embed.youtube_short_re);\n\t\t\tif (!m)\n\t\t\t\tbreak;\n\t\t\t// Substitute\n\t\t\ttime = this.findTimeArg(m[2]) || '';\n\t\t\tvideo = '>>>/watch?v=' + m[1] + time;\n\t\t\tval = embedRewrite(m, video);\n\t\t}\n\n\t\t// SoundCloud links\n\t\twhile(true) {\n\t\t\tm = val.match(embed.soundcloud_url_re);\n\t\t\tif (!m)\n\t\t\t\tbreak;\n\t\t\tvar sc = '>>>/soundcloud/' + m[1];\n\t\t\tval = embedRewrite(m, sc);\n\t\t}\n\n\t\t// Pastebin links\n\t\twhile(true) {\n\t\t\tm = val.match(embed.pastebin_re);\n\t\t\tif (!m)\n\t\t\t\tbreak;\n\t\t\tvar pbin = '>>>/pastebin/' + m[1];\n\t\t\tval = embedRewrite(m, pbin);\n\t\t}\n\n\t\t// Rewite embedable URLs to native embed URL syntax\n\t\tfunction embedRewrite(m, rw) {\n\t\t\tvar old = m[0].length;\n\t\t\tvar newVal = val.substr(0, m.index) + rw + val.substr(m.index + old);\n\t\t\tchanged = true;\n\t\t\tif (m.index < start) {\n\t\t\t\tvar diff = old - rw.length;\n\t\t\t\tstart -= diff;\n\t\t\t\tend -= diff;\n\t\t\t}\n\t\t\treturn newVal;\n\t\t}\n\n\t\tif (changed)\n\t\t\tthis.$input.val(val);\n\n\t\tvar nl = val.lastIndexOf('\\n');\n\t\tif (nl >= 0) {\n\t\t\tvar ok = val.substr(0, nl);\n\t\t\tval = val.substr(nl + 1);\n\t\t\tthis.$input.val(val);\n\t\t\tif (this.model.get('sentAllocRequest') || /[^ ]/.test(ok))\n\t\t\t\tthis.commit(ok + '\\n');\n\t\t}\n\t\telse {\n\t\t\tm = val\n\t\t\t\t.split('')\n\t\t\t\t.reverse()\n\t\t\t\t.join('')\n\t\t\t\t.match(/^(\\s*\\S+\\s+\\S+)\\s+(?=\\S)/);\n\t\t\tif (m) {\n\t\t\t\tvar lim = val.length - m[1].length;\n\t\t\t\tthis.commit(val.substr(0, lim));\n\t\t\t\tval = val.substr(lim);\n\t\t\t\tstart -= lim;\n\t\t\t\tend -= lim;\n\t\t\t\tthis.$input.val(val);\n\t\t\t\tthis.$input[0].setSelectionRange(start, end);\n\t\t\t}\n\t\t}\n\n\t\tthis.$input.attr('maxlength', common.MAX_POST_CHARS - this.char_count);\n\t\tthis.resizeInput(val);\n\t},\n\tfindTimeArg(params) {\n\t\tif (!params || params.indexOf('t=') < 0)\n\t\t\treturn false;\n\t\tparams = params.split('&');\n\t\tfor (let i = 0, len = params.length; i < len; i++) {\n\t\t\tlet pair = '#p' + params[i];\n\t\t\tif (embed.youtube_time_re.test(pair))\n\t\t\t\treturn pair;\n\t\t}\n\t\treturn false;\n\t},\n\t// Commit any staged words to the server\n\tcommit(text) {\n\t\tvar lines;\n\t\tif (text.indexOf('\\n') >= 0) {\n\t\t\tlines = text.split('\\n');\n\t\t\tthis.line_count += lines.length - 1;\n\t\t\tconst breach = this.line_count - common.MAX_POST_LINES + 1;\n\t\t\tif (breach > 0) {\n\t\t\t\tfor (var i = 0; i < breach; i++)\n\t\t\t\t\tlines.pop();\n\t\t\t\ttext = lines.join('\\n');\n\t\t\t\tthis.line_count = common.MAX_POST_LINES;\n\t\t\t}\n\t\t}\n\t\tconst left = common.MAX_POST_CHARS - this.char_count;\n\t\tif (left < text.length)\n\t\t\ttext = text.substr(0, left);\n\t\tif (!text)\n\t\t\treturn;\n\t\tthis.char_count += text.length;\n\n\t\t// Either get an allocation or send the committed text\n\t\tconst attrs = this.model.attributes;\n\t\tif (!attrs.num && !attrs.sentAllocRequest) {\n\t\t\tmain.send([common.INSERT_POST, this.allocationMessage(text, null)]);\n\t\t\tthis.model.set({sentAllocRequest: true});\n\t\t}\n\t\telse if (attrs.num)\n\t\t\tmain.send(text);\n\t\telse\n\t\t\tthis.pending += text;\n\n\t\t// Add it to the user's display\n\t\tif (lines) {\n\t\t\tlines[0] = this.$lineBuffer.text() + lines[0];\n\t\t\tthis.$lineBuffer.text(lines.pop());\n\t\t\tfor (let o = 0, len = lines.length; o < len; o++)\n\t\t\t\tthis.imouto.fragment(lines[o] + '\\n');\n\t\t}\n\t\telse {\n\t\t\tthis.$lineBuffer.append(document.createTextNode(text));\n\t\t\tthis.$lineBuffer[0].normalize();\n\t\t}\n\t},\n\t// Construct the message for post allocation in the database\n\tallocationMessage(text, image) {\n\t\tvar msg = {nonce: main.request('nonce:create')};\n\n\t\tfunction opt(key, val) {\n\t\t\tif (val)\n\t\t\t\tmsg[key] = val;\n\t\t}\n\n\t\topt('name', main.$name.val().trim());\n\t\topt('email', main.$email.val().trim());\n\t\topt('subject', this.$subject.val().trim());\n\t\topt('frag', text);\n\t\topt('image', image);\n\t\topt('op', this.model.get('op'));\n\n\t\treturn msg;\n\t},\n\tonKeyDown(event) {\n\t\tmain.follow(() => {\n\t\t\tswitch(event.which) {\n\t\t\t\tcase 13:\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t// fall-through\n\t\t\t\tcase 32:\n\t\t\t\t\t// predict result\n\t\t\t\t\tvar input = this.$input[0];\n\t\t\t\t\tvar val = this.$input.val();\n\t\t\t\t\tval = val.slice(0, input.selectionStart)\n\t\t\t\t\t\t+ (event.which == 13 ? '\\n' : ' ')\n\t\t\t\t\t\t+ val.slice(input.selectionEnd);\n\t\t\t\t\tthis.onInput(val);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\thandle_shortcut.bind(this)(event);\n\t\t\t}\n\t\t});\n\t},\n\tfinish() {\n\t\tif (this.model.get('num')) {\n\t\t\tthis.flushPending();\n\t\t\tthis.commit(this.$input.val());\n\t\t\tthis.$input.remove();\n\t\t\tthis.$submit.remove();\n\t\t\tif (this.$uploadForm)\n\t\t\t\tthis.$uploadForm.remove();\n\t\t\tif (this.$iframe) {\n\t\t\t\tthis.$iframe.remove();\n\t\t\t\tthis.$iframe = null;\n\t\t\t}\n\t\t\tthis.imouto.fragment(this.$lineBuffer.text());\n\t\t\tthis.$buffer.replaceWith(this.$buffer.contents());\n\t\t\tthis.$lineBuffer.remove();\n\t\t\tthis.$blockquote.css({\n\t\t\t\t'margin-left': '', 'padding-left': ''\n\t\t\t}\n\t\t\t);\n\t\t\tmain.send([common.FINISH_POST]);\n\t\t\tthis.preserve = true;\n\t\t\tif (this.isThread)\n\t\t\t\tthis.$el.append(main.oneeSama.replyBox());\n\n\t\t\tlet missing = this.imouto.allRolls.sent - this.imouto.allRolls.seen;\n\t\t\t//if missing>0 we have to wait until insertOwnPosts \"sees\" the\n\t\t\t// dice\n\t\t\tif (missing > 0) {\n\t\t\t\tlet checkAgain;\n\t\t\t\t(checkAgain= (n) => {\n\t\t\t\t\tsetTimeout(()=> {\n\t\t\t\t\t\tif (this.imouto.allRolls.seen == this.imouto.allRolls.sent || n ==0)\n\t\t\t\t\t\t\tpostSM.feed('done');\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcheckAgain(n - 1);\n\t\t\t\t\t}, 100);\n\t\t\t\t})(5); //retry 5 times\n\t\t\t}\n\t\t\telse\n\t\t\t\tpostSM.feed('done');\n\t\t}else\n\t\t\tpostSM.feed('done');\n\t},\n\t// Send any unstaged words\n\tflushPending() {\n\t\tif (this.pending) {\n\t\t\tmain.send(this.pending);\n\t\t\tthis.pending = '';\n\t\t}\n\t},\n\tonToggle(event) {\n\t\tconst attrs = this.model.attributes;\n\t\tif (attrs.uploading || attrs.uploaded)\n\t\t\treturn;\n\t\tevent.preventDefault();\n\t\tevent.stopImmediatePropagation();\n\t\tif (attrs.spoiler) {\n\t\t\tthis.model.set({spoiler: 0});\n\t\t\treturn;\n\t\t}\n\t\tconst pick = common.pick_spoiler(attrs.nextSpoiler);\n\t\tthis.model.set({\n\t\t\tspoiler: pick.index,\n\t\t\tnextSpoiler: pick.next\n\t\t});\n\t},\n\tonAllocation(msg) {\n\t\tconst num = msg.num;\n\t\tstate.ownPosts[num] = num;\n\t\tthis.model.set({num: num});\n\t\tthis.flushPending();\n\t\tvar header = $(main.oneeSama.header(msg));\n\t\tthis.$meta.replaceWith(header);\n\t\tthis.$meta = header;\n\t\tif (!this.isThread)\n\t\t\tthis.$el.addClass('editing');\n\n\t\t/*\n\t\t TODO: Hide threads that are over THREADS_PER_PAGE. Also would need to be\n\t\t removed from syncs client and server-side. Hmm.\n\t\t */\n\n\t\tthis.$el.attr('id', 'p' + num);\n\n\t\tif (msg.image)\n\t\t\tthis.insertUploaded(msg.image);\n\n\t\tif (this.$uploadForm)\n\t\t\tthis.$uploadForm.append(this.$submit);\n\t\telse\n\t\t\tthis.$blockquote.after(this.$submit);\n\t\tif (this.isThread) {\n\t\t\tthis.$subject.siblings('label').andSelf().remove();\n\t\t\tthis.$blockquote.show();\n\t\t\tthis.resizeInput();\n\t\t\tthis.$input.focus();\n\t\t}\n\n\t\t/*\n\t\t Ensures you are nagged at by the browser, when navigating away from an\n\t\t unfinished allocated post.\n\t\t */\n\t\twindow.onbeforeunload = function() {\n\t\t\treturn \"You have an unfinished post.\";\n\t\t};\n\t},\n\t// Insert an image that has been uploaded and processed by the server\n\tinsertUploaded(info) {\n\t\tthis.renderImage(null, info);\n\t\tthis.$imageInput\n\t\t\t.siblings('strong')\n\t\t\t.andSelf()\n\t\t\t.remove();\n\t\tthis.$cancel.remove();\n\t\tthis.$uploadForm.find('#toggle').remove();\n\t\tthis.flushPending();\n\t\tthis.model.set({\n\t\t\tuploading: false,\n\t\t\tuploaded: true,\n\t\t\tsentAllocRequest: true\n\t\t});\n\n\t\t// Stop obnoxious wrap-around-image behaviour\n\t\tvar $img = this.$el.find('img');\n\t\tthis.$blockquote.css({\n\t\t\t'margin-left': $img.css('margin-right'),\n\t\t\t'padding-left': $img.width()\n\t\t});\n\n\t\tthis.resizeInput();\n\t},\n\t// Handle image upload status\n\tdispatch(msg) {\n\t\tconst a = msg.arg;\n\t\tswitch(msg.t) {\n\t\t\tcase 'alloc':\n\t\t\t\tthis.onImageAllocation(a);\n\t\t\t\tbreak;\n\t\t\tcase 'error':\n\t\t\t\tthis.uploadError(a);\n\t\t\t\tbreak;\n\t\t\tcase 'status':\n\t\t\t\tthis.uploadStatus(a);\n\t\t\t\tbreak;\n\t\t}\n\t},\n\tonImageAllocation(msg) {\n\t\tconst attrs = this.model.attributes;\n\t\tif (attrs.cancelled)\n\t\t\treturn;\n\t\tif (!attrs.num && !attrs.sentAllocRequest) {\n\t\t\tmain.send([common.INSERT_POST, this.allocationMessage(null, msg)]);\n\t\t\tthis.model.set({sentAllocRequest: true});\n\t\t}\n\t\telse\n\t\t\tmain.send([common.INSERT_IMAGE, msg]);\n\t},\n\tuploadError(msg) {\n\t\tif (this.model.get('cancelled'))\n\t\t\treturn;\n\t\tthis.model.set({\n\t\t\tuploadStatus: msg,\n\t\t\tuploading: false\n\t\t});\n\t\tif (this.$uploadForm)\n\t\t\tthis.$uploadForm.find('input[name=alloc]').remove();\n\t},\n\tuploadStatus(msg) {\n\t\tif (this.model.get('cancelled'))\n\t\t\treturn;\n\t\tthis.model.set('uploadStatus', msg);\n\t},\n\taddReference(num, sel) {\n\t\t// If a >>link exists, put this one on the next line\n\t\tvar val = this.$input.val();\n\t\tif (/^>>\\d+$/.test(val)) {\n\t\t\tthis.$input.val(val + '\\n');\n\t\t\tthis.onInput();\n\t\t\tval = this.$input.val();\n\t\t}\n\t\t// Quote selected text automatically\n\t\tif (sel) {\n\t\t\tsel = sel.split('\\n');\n\t\t\t// Prepend > to each line\n\t\t\tfor (let i = 0, len = sel.length; i < len; i++)\n\t\t\t\tsel[i] = '>' + sel[i];\n\t\t\tnum += '\\n' + sel.join('\\n') + '\\n';\n\t\t}\n\t\tthis.$input.val(val + '>>' + num);\n\t\tthis.$input[0].selectionStart = this.$input.val().length;\n\t\tthis.onInput();\n\t\tthis.$input.focus();\n\t},\n\tremove() {\n\t\tif (!this.preserve) {\n\t\t\tif (this.isThread)\n\t\t\t\tthis.$el.next('hr').remove();\n\t\t\tthis.$el.remove();\n\t\t}\n\t\tthis.$sizer.remove();\n\t\tif (this.$iframe) {\n\t\t\tthis.$iframe.remove();\n\t\t\tthis.$iframe = null;\n\t\t}\n\t\tthis.stopListening();\n\t\twindow.onbeforeunload = null;\n\t},\n\t// Extend with imager.js methods\n\trenderImage: imager.Hidamari.renderImage,\n\t// Overrides automatic image expansion, if any\n\tautoExpandImage() {\n\t\treturn this;\n\t},\n\tfun() {\n\t\t\n\t}\n});\nexports.ComposerView = ComposerView;\n\nfunction openPostBox(num) {\n\tpostSM.feed('new', document.query(`#p${num} aside.posting`));\n}\nmain.reply('openPostBox', openPostBox);\n\nwindow.addEventListener('message', function(event) {\n\tconst msg = event.data;\n\tif (msg !== 'OK' && postForm)\n\t\tpostForm.uploadError(msg);\n}, false);\n\nmain.$threads.on('click', 'a.quote', function(e) {\n\te.preventDefault();\n\n\t// TODO: Set highlighted post\n\n\t/*\n\t Make sure the selection both starts and ends in the quoted post's\n\t blockquote\n\t */\n\tconst post = e.target.closest('article, section'),\n\t\tgsel = getSelection(),\n\t\tnum = util.getNum(post);\n\n\tfunction isInside(prop) {\n\t\tconst el = gsel[prop] && gsel[prop].parentElement;\n\t\treturn  el\n\t\t\t&& el.closest('blockquote')\n\t\t\t&& el.closest('article, section') === post;\n\t}\n\n\tlet sel;\n\tif (isInside('baseNode') && isInside('focusNode'))\n\t\tsel = gsel.toString();\n\topenPostBox(util.getNum(post.closest('section')));\n\tpostForm.addReference(num, sel);\n});\n","/*\n * OP and thread related logic\n */\n\nconst main = require('../main'),\n\tPostCommon = require('./common'),\n\t{$, _, Backbone, util, oneeSama, state} = main;\n\nmodule.exports = PostCommon.extend({\n\ttagName: 'section',\n\trender() {\n\t\tconst attrs = this.model.attributes;\n\t\tthis.setElement(oneeSama.section(attrs)).insertIntoDOM();\n\n\t\t// Insert reply box into the new thread\n\t\tconst reply = util.parseDOM(oneeSama.replyBox());\n\t\tif (attrs.num in state.ownPosts || !!main.request('postForm'))\n\t\t\treply.style.display = 'none';\n\t\tthis.el.append(reply);\n\n\t\t// Remove next <hr>\n\t\tthis.el.nextElementSibling.remove();\n\t\treturn this;\n\t},\n\tinsertIntoDOM() {\n\t\tmain.$threads[0].query('aside')\n\t\t\t.after(this.el, document.createElement('hr'));\n\t\tthis.fun();\n\t},\n\trenderLocked(locked) {\n\t\tthis.el.classList[locked ? 'add' : 'remove']('locked');\n\t},\n\tremove() {\n\t\t// Remove next <hr>\n\t\tthis.el.nextElementSibling.remove();\n\t\tthis.el.remove();\n\t\tthis.stopListening();\n\t\treturn this;\n\t},\n\t/*\n\t Remove the top reply on board pages, if over limit, when a new reply is\n\t added\n\t */\n\tshiftReplies(postForm) {\n\t\tconst attrs = this.model.attributes,\n\t\t\t{replies} = attrs;\n\t\tlet lim = state.hotConfig.get('ABBREVIATED_REPLIES'),\n\t\t\tchanged;\n\t\tif (postForm)\n\t\t\tlim--;\n\t\t// Need a static length, because the original array get's modified\n\t\tconst len = replies.slice().length;\n\t\tfor (let i = len; i > lim; i--) {\n\t\t\tconst post = state.posts.get(replies.shift());\n\t\t\tif (!post)\n\t\t\t\tcontinue;\n\t\t\tif (post.get('image'))\n\t\t\t\tattrs.image_omit++;\n\t\t\tattrs.omit++;\n\t\t\tchanged = true;\n\t\t\tpost.remove();\n\t\t}\n\t\tif (changed)\n\t\t\tthis.renderOmit(attrs.omit, attrs.image_omit)\n\t},\n\t// Posts and images omited indicator\n\trenderOmit(omit = this.model.get('omit'),\n\t\timage_omit = this.model.get('image_omit')\n\t) {\n\t\tif (omit === 0)\n\t\t\treturn;\n\t\tconst {thread, href} = state.page.attributes;\n\t\tthis.el.query('.omit').innerHTML = oneeSama.lang.abbrev_msg(omit,\n\t\t\tthis.model.get('image_omit'), thread && href.split('?')[0]);\n\t},\n\t// Move thread to the top of the page\n\tbumpThread() {\n\t\tthis.el.nextElementSibling.remove();\n\t\tthis.el.remove();\n\t\tthis.insertIntoDOM();\n\t}\n});\n","/*\n * Various page scrolling logic\n */\n\nconst main = require('./main'),\n\t{$, Backbone, options, state} = main;\n\nconst {body} = document;\nlet atBottom, lockIndicator, isThread;\n\nfunction cacheState() {\n\tlockIndicator = document.query('#lock');\n\tisThread = !!state.posts.get('thread');\n}\n\n// Recache state on page change\nstate.page.on('change', cacheState);\ncacheState();\n\n// Sets the scroll lock position to a post or to bottom of the document\nfunction checkBottom() {\n\tatBottom = (body.scrollHeight - window.innerHeight) <= window.scrollY;\n\tif (lockIndicator)\n\t\tlockIndicator.style.visibility = atBottom ? 'visible' : 'hidden';\n}\n\ncheckBottom();\ndocument.addEventListener('scroll', checkBottom);\n\n/*\n Lock position to the bottom of a thread or keep the viewport from bumping\n on out of sight DOM mutation.\n */\n// Cache previous reference element to minimize DOM lookup\nlet referenceEl;\n\nfunction followDOM(func) {\n\tconst previous = referenceDistance(),\n\t\tret = func();\n\n\t// Prevent scrolling with new posts, if page isn't visible\n\tif (atBottom && (!document.hidden || options.get('alwaysLock')))\n\t\twindow.scrollTo(0,  body.scrollHeight);\n\telse {\n\t\t// Element was removed or something\n\t\tif (!elExists(referenceEl))\n\t\t\treturn ret;\n\n\t\t// Only compensate, if the height increased ~above the viewport\n\t\tconst delta = topDistance(referenceEl, true) - previous;\n\t\tif (delta)\n\t\t\twindow.scrollBy(0, delta);\n\t}\n\treturn ret;\n}\nmain.follow = followDOM;\n\n// Check if element reference exists and is in the DOM\nfunction elExists(el) {\n\treturn el && document.contains(el);\n}\n\n// Return element position dimentions against the viewport, if the element\n// is withing the viewport\nfunction topDistance(el, skipCheck) {\n\tconst {top} = el.getBoundingClientRect();\n\tif (skipCheck || (top >= 0 && top < window.innerHeight))\n\t\treturn top;\n\treturn null;\n}\n\nfunction referenceDistance() {\n\tif (elExists(referenceEl)) {\n\t\tconst bounds = topDistance(referenceEl);\n\t\tif (bounds !== null)\n\t\t\treturn bounds;\n\t}\n\n\t// Find new reference element (first inside viewport). Account for empty\n\t// threads and boards with no artciles or sections.\n\tfor (let selector of ['article', 'section', 'threads']) {\n\t\tfor (let el of main.$threads[0].queryAll(selector)) {\n\t\t\tconst bounds = topDistance(el);\n\t\t\tif (bounds !== null) {\n\t\t\t\treferenceEl = el;\n\t\t\t\treturn bounds;\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Account for banner height, when scrolling to an anchor\nfunction aboveBanner (){\n\tif (!/^#p\\d+$/.test(location.hash))\n\t\treturn;\n\tlet $anchor = $(location.hash);\n\tif (!$anchor.length)\n\t\treturn;\n\t$(window).scrollTop($anchor.offset().top - $('#banner').height());\n}\nmain.reply('scroll:aboveBanner', aboveBanner);\nwindow.onload = aboveBanner;\n","/*\n * Central model keeping the state of the page\n */\n\nimport {_, Backbone} from 'main'\nmain.state = module.exports\n\n// Read page state by parsing a URL\nexport function read(href) {\n\tconst state = {\n\t\tboard: href.match(/\\/([a-zA-Z0-9]+?)\\//)[1],\n\t\tthread: href.match(/\\/(\\d+)(:?#\\d+)?(?:[\\?&]\\w+=\\w+)*$/),\n\t\t// Displayed last N posts setting on thread pages\n\t\tlastN: href.match(/[\\?&]last=(\\d+)/)\n\t}\n\tfor (let key of ['thread', 'lastN']) {\n\t\tconst val = state[key]\n\t    state[key] = val ? parseInt(val[1]) : 0\n\t}\n\treturn state\n}\n\n// Initial page state\nexport const page = new Backbone.Model(read(location.href))\n\n// Hot-reloadable configuration\n\n// TODO: We need actual listeners to this model for hot reloads\n\n// Tracks the synchronisation counter of each thread\nexport let syncs = {}\n\n// Posts I made in this tab\nexport const ownPosts = {}\n\n// remember which posts are mine for two days\nexport const mine = new main.Memory('mine', 2, true)\n\n// All posts currently displayed\nexport const posts = new Backbone.Collection()\n\nmain.on('state:clear', () => {\n\t/*\n\t * Emptying the whole element should be faster than removing each post\n\t * individually through models and listeners\n\t */\n\tmain.$threads.innerHTML = ''\n\n\t// The <threads> tag has already been emptied, no need to perform\n\t// element removal with the default `.remove()` method\n\tmodels.each(model =>\n\t\tmodel.dispatch('stopListening'))\n\n\tposts.reset()\n\n\t// Prevent old threads from syncing\n\texports.syncs = {}\n\tmain.request('massExpander:unset')\n})\n\n// Post links verified server-side\nexport const links = {}\n\nexport function addLinks(addition) {\n\tif (addition) {\n\t\t_.extend(links, addition);\n\t}\n}\n","/*\nTimezone corrections, batch timestamp updates, syncwatch, util.\n */\n\nlet main = require('./main'),\n\t{$, Backbone, common, oneeSama, options, state} = main;\n\n// Get a more accurate server-client time offset, for interclient syncing\n// Does not account for latency, but good enough for our purposes\nvar serverTimeOffset = 0;\nmain.dispatcher[common.GET_TIME] = function(msg){\n\tif (!msg[0])\n\t\treturn;\n\tserverTimeOffset = msg[0] - Date.now();\n};\nmain.reply('time:offset', () => serverTimeOffset);\n\nlet renderTimer;\nfunction batcTimeRender(source, rtime = options.get('relativeTime')) {\n\tstate.posts.each(model => model.dispatch('renderTime'));\n\tif (renderTimer)\n\t\tclearTimeout(renderTimer);\n\tif (rtime)\n\t\trenderTimer = setTimeout(batcTimeRender, 60000)\n}\nmain.reply('time:render', batcTimeRender);\noptions.on('change:relativeTime', batcTimeRender);\n\n/* syncwatch */\nfunction timer_from_el(el) {\n\tif (!serverTimeOffset)\n\t\treturn;\n\tel.classList.add('timerTicking');\n\tconst start = el.getAttribute('start'),\n\t\tend = el.getAttribute('end'),\n\t\tmaxh = common.pad(el.getAttribute('hour')),\n\t\tmaxm = common.pad(el.getAttribute('min')),\n\t\tmaxs = common.pad(el.getAttribute('sec'));\n\n\t(function moumouikkai() {\n\t\t// Prevent memory leak\n\t\tif (!document.body.contains(el))\n\t\t\treturn;\n\t\tconst now = common.serverTime();\n\t\tif (now > end)\n\t\t\treturn el.textContent = main.lang.finished;\n\n\t\t// If the start time is in the future\n\t\tif (start > now) {\n\t\t\tconst countdown = Math.round((start - now) / 1000);\n\t\t\tif(countdown === 10)\n\t\t\t\tmain.request('time:syncwatch');\n\t\t\tel.textContent = 'Countdown: ' + countdown;\n\t\t\treturn setTimeout(moumouikkai, 1000);\n\t\t}\n\n\t\tlet diff = now - start;\n\t\tconst hour = Math.floor(diff / 1000 /60 / 60);\n\t\tdiff -= hour * 1000 * 60 * 60;\n\t\tconst min = Math.floor( diff / 1000 / 60);\n\t\tdiff -= min * 1000 * 60;\n\t\tconst sec = Math.floor(diff / 1000);\n\t\tel.textContent = common.pad(hour) + \":\" + common.pad(min) + \":\"\n\t\t\t+ common.pad(sec) + \" / \" + maxh + \":\" + maxm + \":\" + maxs;\n\t\treturn setTimeout(moumouikkai, 1000);\n\t})();\n}\n\nfunction mouikkai() {\n\tsetInterval(function() {\n\t\tconst els = document.getElementsByTagName('syncwatch');\n\t\tfor (let i = 0; i < els.length; i++) {\n\t\t\tif (els[i].classList.contains('timerTicking'))\n\t\t\t\tcontinue;\n\t\t\ttimer_from_el(els[i]);\n\t\t}\n\t}, 1000);\n}\n\nmain.defer(batcTimeRender)\n\t.defer(mouikkai)\n\t.defer(function() {\n\t\t// Append UTC clock to the top of the schedule\n\t\tlet seconds;\n\t\tlet el = document.getElementById('UTCClock').firstChild;\n\t\tel.addEventListener('click', handler);\n\n\t\tfunction handler() {\n\t\t\tseconds = true;\n\t\t\tthis.removeAttribute('title');\n\t\t\tthis.style.cursor = 'default';\n\t\t\tthis.removeEventListener('click', handler);\n\t\t\trender();\n\t\t}\n\n\t\tfunction render() {\n\t\t\tif (!serverTimeOffset)\n\t\t\t\treturn setTimeout(render, 1000);\n\t\t\tel.innerHTML = oneeSama\n\t\t\t\t.readableUTCTime(new Date(common.serverTime()), seconds);\n\t\t\tsetTimeout(render, seconds ? 1000 : 60000);\n\t\t}\n\n\t\trender();\n\t});\n","/*\n Client-side helper functions\n */\n\nimport {_, config, state} from 'main'\nmain.util = module.exports\n\n/**\n * Make spoiler tags toggleable on mobile\n * @param {Element}\n */\nexport function touchable_spoiler_tag(del) {\n\tdel.html = '<del onclick=\"void(0)\">'\n}\n\n/**\n * Return image upload URL\n * @returns {string}\n */\nexport function imageUploadURL() {\n\treturn (config.hard.HTTP.upload || '../upload/') + '?id='\n\t\t+ state.page.get('connID')\n}\n\n/**\n * Retrieve post number of post element\n * @param {Element} el\n * @returns {int}\n */\nexport function getNum(el) {\n\tif (!el) {\n\t    return 0\n\t}\n\treturn parseInt(el.getAttribute('id').slice(1), 10)\n}\n\n/**\n * Retrieve post number of closest parent post\n * @param {Element} el\n * @returns {int}\n */\nexport function getID(el) {\n\tif (!el) {\n    \treturn 0\n\t}\n\treturn getNum(el.closest('article, section'))\n}\n\n/**\n * Retrieve model of closest parent post\n * @param {Element} el\n * @returns {(Backbone.Model|null)}\n */\nexport function getModel(el) {\n\tconst id = getID(el)\n\tif (!id)\n\t\treturn null\n\treturn state.posts.get(id)\n}\n\n/**\n * Parse HTML string to node array\n * @param {string} string\n * @returns {Element[]}\n */\nexport function parseEls(string) {\n\tconst el = document.createElement('div')\n\tel.innerHTML = string\n\tconst children = el.childNodes\n\treturn Array.from(children)\n}\n\n/**\n * Parse HTML string to Element\n * @param {string} string\n * @returns {Element}\n */\nexport function parseEl(string) {\n\tconst el = document.createElement('div')\n\tel.innerHTML = string\n\treturn el.firstChild\n}\n\n/**\n * Add an event listener that filters targets according to a CSS selector\n * @param {Element} el - Target element\n * @param {string} type - Event type\n * @param {string} selector - CSS selector\n * @param {function} handler - Callback function\n */\nexport function listener(el, type, selector, handler) {\n\tel.addEventListener(type, function (event) {\n\t\tif (event.target.matches(selector))\n\t\t\thandler.call(this, event)\n\t})\n}\n\n/**\n * Add event listener to element, that will only be executed once\n * @param {Element} el - Target element\n * @param {string} type\t- Event type\n * @param {function} handler - Callback function\n */\nexport function once(el, type, handler) {\n\tel.addEventListener(type, function (event) {\n\t\thandler.call(this, event)\n\t\tel.removeEventListener(type, handler)\n\t})\n}\n\n/**\n * Return width of element with padding and margin\n * @param {Element} el\n * @returns {int}\n */\nexport function outerWidth(el) {\n\tconst style =  getComputedStyle(el),\n\t\tprops = ['marginLeft', 'marginRight', 'paddingLeft','paddingRight']\n\tlet width = 0\n\tfor (let prop of props) {\n\t\twidth += parseInt(style[prop]);\n\t}\n\treturn width\n}\n\n/**\n * Confirms email is saging\n * @param {string} email\n * @returns {bool}\n */\nexport function isSage(email) {\n\treturn email && email.trim() === 'sage'\n}\n\n\n// TODO: Refactor server time syncronisation\nlet cachedOffset;\nexport function serverTime() {\n\tconst d = Date.now();\n\tif (imports.isNode)\n\t\treturn d;\n\n\t// The offset is intialised as 0, so there is something to return, until\n\t// we get a propper number from the server.\n\tif (!cachedOffset)\n\t\tcachedOffset = imports.main.request('time:offset');\n\treturn d + cachedOffset;\n}\n\nexport function readable_dice(bit, dice) {\n\tlet inner;\n\tswitch (bit) {\n\t\tcase '#flip':\n\t\t\tinner = (dice[2] == 2).toString();\n\t\t\tbreak;\n\t\tcase '#8ball':\n\t\t\tinner = imports.hotConfig.EIGHT_BALL[dice[2] - 1];\n\t\t\tbreak;\n\t\tcase '#pyu':\n\t\tcase '#pcount':\n\t\tcase '#q':\n\t\t\tinner = dice[0];\n\t\t\tbreak;\n\t}\n\tif (inner !== undefined)\n\t\treturn _.escape(`${bit} (${inner})`);\n\tif (/^#sw/.test(bit))\n\t\treturn readableSyncwatch(dice[0]);\n\treturn readableRegularDice(bit, dice);\n}\n\nfunction readableSyncwatch(dice) {\n\tdice.class = 'embed';\n\treturn parseHTML\n\t\t`<syncwatch ${dice}>\n\t\t\tsyncwatch\n\t\t</syncwatch>`;\n}\n\nfunction readableRegularDice(bit, [max, bias, ...rolls]) {\n\tbit += ' (';\n\tconst eq = rolls.length > 1 || bias;\n\tif (eq)\n\t\tbit += rolls.join(', ');\n\tif (bias)\n\t\tbit += (bias < 0 ? ' - ' + (-bias) : ' + ' + bias);\n\tlet sum = bias;\n\tfor (let roll of rolls) {\n\t\tsum += roll;\n\t}\n\treturn bit + (eq ? ' = ' : '') + sum + ')';\n}\n\nexport function pick_spoiler(metaIndex) {\n\tconst imgs = imports.config.SPOILER_IMAGES,\n\t\tn = imgs.length;\n\tlet i;\n\tif (metaIndex < 0)\n\t\ti = Math.floor(Math.random() * n);\n\telse\n\t\ti = metaIndex % n;\n\treturn {\n\t\tindex: imgs[i],\n\t\tnext: (i + 1) % n\n\t};\n}\n\nexport const thumbStyles = ['small', 'sharp', 'hide']\n\nexport function readable_filesize(size) {\n\t/* Dealt with it. */\n\tif (size < 1024)\n\t\treturn size + ' B';\n\tif (size < 1048576)\n\t\treturn Math.round(size / 1024) + ' KB';\n\tsize = Math.round(size / 104857.6).toString();\n\treturn size.slice(0, -1) + '.' + size.slice(-1) + ' MB';\n}\n\nexport function pad(n) {\n\treturn (n < 10 ? '0' : '') + n;\n}\n\n// Various UI-related links wrapped in []\nexport function action_link_html(href, name, id, cls) {\n\treturn parseHTML\n\t\t`<span class=\"act\">\n\t\t\t<a href=\"${href}\"\n\t\t\t\t${id && ` id=\"${id}\"`}\n\t\t\t\t${cls && ` class=\"${cls}\"`}\n\t\t\t>\n\t\t\t\t${name}\n\t\t\t</a>\n\t\t</span>`;\n}\n\n/**\n * Confirm last N posts to view setting matches bounds\n * @param {int} n\n * @returns {bool}\n */\nexport function resonableLastN(n) {\n\treturn Number.isInteger(n) && n <= 500\n}\n\nexport function parse_name(name) {\n\tvar tripcode = '', secure = '';\n\tvar hash = name.indexOf('#');\n\tif (hash >= 0) {\n\t\ttripcode = name.substr(hash + 1);\n\t\tname = name.substr(0, hash);\n\t\thash = tripcode.indexOf('#');\n\t\tif (hash >= 0) {\n\t\t\tsecure = _.escape(tripcode.substr(hash + 1));\n\t\t\ttripcode = tripcode.substr(0, hash);\n\t\t}\n\t\ttripcode = _.escape(tripcode);\n\t}\n\tname = name.trim().replace(imports.hotConfig.EXCLUDE_REGEXP, '');\n\treturn [\n\t\tname.substr(0, 100), tripcode.substr(0, 128),\n\t\tsecure.substr(0, 128)\n\t];\n}\n\n/**\n * Generate a random alphannumeric string of lower and upper case hexadecimal\n * characters\n * @param {int} len\t- String length\n * @returns {string}\n */\nexport function randomID(len) {\n\tlet id = ''\n\tfor (let i = 0; i < len; i++) {\n\t\tlet char = (Math.random() * 36).toString(36)[0]\n\t\tif (Math.random() < 0.5)\n\t\t\tchar = char.toUpperCase()\n\t\tid += char\n\t}\n\treturn id\n}\n\n/**\n * Template string tag function for HTML. Strips indentation and trailing\n * newlines. Based on https://gist.github.com/zenparsing/5dffde82d9acef19e43c\n * @param {*}\n * @returns {string}\n */\nexport function parseHTML(callSite) {\n\t// if argumennts.length === 1\n\tif (typeof callSite === 'string')\n\t\treturn formatHTML(callSite);\n\tif (typeof callSite === 'function')\n\t\treturn formatHTML(callSite(args))\n\n\t/*\n\t Slicing the arguments object is deoptimising, so we construct a new array\n\t instead.\n\t */\n\tconst len = arguments.length;\n\tlet args = [];\n\tfor (let i = 1; i < len; i++) {\n\t\targs[i - 1] = arguments[i]\n\t}\n\n\tconst output = callSite\n\t\t.slice(0, len)\n\t\t.map((text, i) => {\n\t\t\tconst arg = args[i - 1]\n\t\t\tlet result;\n\t\t\t/*\n\t\t\t Simplifies conditionals. If the placeholder returns a non-zero\n\t\t\t falsy value, it is ommitted.\n\t\t\t */\n\t\t\tif (i === 0 || (!arg && arg !== 0))\n\t\t\t\tresult = ''\n\t\t\telse if (arg instanceof Object)\n\t\t\t\tresult = elementAttributes(arg)\n\t\t\telse\n\t\t\t\tresult = arg\n\n\t\t\treturn result + text\n\t\t})\n\t\t.join('')\n\n\treturn formatHTML(output)\n}\n\n/**\n * Strip leading indentation from HTML string\n */\nfunction formatHTML(str) {\n\tlet size = -1;\n\treturn str\n\t\t.replace(/\\n(\\s+)/g, (m, m1) => {\n\t\t\tif (size < 0)\n\t\t\t\tsize = m1.replace(/\\t/g, '    ').length\n\t\t\treturn m1.slice(Math.min(m1.length, size))\n\t\t})\n\t\t// Remove empty lines\n\t\t.replace(/^\\s*\\n/gm, '')\n}\n\n/**\n * Generate an HTML element attribute list\n */\nfunction elementAttributes(attrs) {\n\tlet html = '';\n\tfor (let key in attrs) {\n\t\thtml += ' '\n\t\tconst val = attrs[key]\n\t\tif (val === true)\n\t\t\thtml += key\n\t\telse if (val || val === 0)\n\t\t\thtml += `${key}=\"${val}\"`\n\t}\n\treturn html\n}\n\n/**\n * Makes a ', ' seperated list out of on array of strings\n * @param {string[]} items\n * @returns {string}\n */\nexport function commaList(items) {\n\tlet html = ''\n\tfor (let item of items) {\n\t\t// Falsy value. Skip item.\n\t\tif (!item && item !== 0)\n\t\t\tcontinue\n\t\tif (html)\n\t\t\thtml += ', '\n\t\thtml += item\n\t}\n\treturn html\n}\n\n/**\n * Acertains client has the proper authorisation to perfrom task. This is only\n * for rendering. The same validation is performed server-side.\n * @param {string} action - Privilidged action to check permission for\n * @returns {bool}\n */\nexport function checkAuth(action) {\n\tconst cls = config.staff.classes[main.ident && main.ident.auth]\n    return cls && !!cls.rights[action]\n}\n","/*\n * Loads the depandancies in order and aggregates exports from various modules\n */\n\n// NOTE: The entire bundle uses strict mode through the Babel transpiler\n\n/*\n * Because we are going to attach listeners to these all over the place, have\n * to load soome core modules in specific order. Also avoids nasty circular\n * dependancy, by placing some of the exports here and not in child modules.\n */\nconst _ = require('underscore'),\n\tBackbone = require('backbone'),\n\tCookie = require('js-cookie'),\n\tradio = require('backbone.radio')\n\nimport FSM from './fsm'\n\n// Load standard library ES6 polyfills\nrequire('core-js')\n// Load DOM level 4 polyfill\nrequire('dom4')\n// Load Backbone.View native JS replacement\nrequire('backbone.nativeview')\nBackbone.View = Backbone.NativeView\n\n// Central aplication object and message bus\nlet main = module.exports = radio.channel('main')\n\n_.extend(main, {\n\t// Bind dependancies to main object for pretier destructuring requires\n\t_, Backbone, Cookie, FSM,\n\t$script: require('scriptjs'),\n\tSockJS: require('sockjs-client'),\n\n\t/*\n\t Ofload expensive and not that neccessary initialisation logic till\n\t after the core modules are started\n\t */\n\t_deferred: [],\n\tdefer(func) {\n\t\tmain._deferred.push(func)\n\t\treturn main\n\t},\n\texecDefered() {\n\t\tfor (let func of this._deferred) {\n\t\t\tfunc()\n\t\t}\n\t},\n\n\t// Websocket call handler map. Store them here, to avoid requiring\n\t// modules in the wrong order.\n\tdispatcher: {}\n})\n\n// Import configuration variables from the template HTML\n_.extend(main, {config, configHash, clientHash, isMobile})\n\n// Clear cookies, if versions mismatch. Get regenerated each client start\n// anyway.\nconst cookieVersion = 3\nif (localStorage.cookieVersion != cookieVersion) {\n\tfor (let cookie in Cookie.get()) {\n\n\t\t// Clear legacy cookies that were set for each board separatly.\n\t\t// Otherwise, they would override the new ones.\n\t\tconst paths = main.config.boards.enabled.slice()\n\t\tpaths.push('')\n\t\tfor (let path of paths) {\n\t\t\tCookie.remove(cookie, {path})\n\t\t}\n\t}\n\tlocalStorage.cookieVersion = cookieVersion\n}\n\n// You can invoke the client-side debug mode with the `debug=true` query string\nif (/[&\\?]debug=true/.test(location.href))\n\tmain.config.hard.debug = true\nif (main.config.hard.debug) {\n\tradio.DEBUG = true\n\twindow.Backbone = Backbone // Export Backbone instance for easier debugging\n\tradio.tuneIn('main') // Log all channel traffic\n}\n\nmain.send = main.request.bind(main, 'send') // Shorthand\n\n/*\n Core modules. The other will be more or less decoupled, but these are the\n monolithic foundation.\n */\nmain.Memory = require('./memory')\nconst lang = main.lang = require('lang'),\n\tstate = require('./state'),\n\tutil = require('./util'),\n\tcommon = main.common = require('./common')\n\n/*\n// Initialise main rendering object\nlet oneeSama = main.oneeSama = new common.OneeSama({\n\top: state.page.get('thread'),\n\tlang,\n\t// Core post link handler\n\ttamashii(num) {\n\t\tlet frag;\n\t\tconst op = state.links[num];\n\t\tif (op) {\n\t\t\tconst desc = num in state.mine.readAll() && this.lang.you;\n\t\t\tfrag = this.postRef(num, op, desc);\n\t\t}\n\t\telse\n\t\t\tfrag = '>>' + num;\n\t\treturn frag;\n\t}\n});\n*/\nmain.options = require('./options')\nmain.scroll = require('./scroll')\nstate.page.set('tabID', common.randomID(32))\n\n// Load language-specific CSS\ndocument.head.appendChild(util.parseDOM(common.parseHTML\n\t`<style>\n\t\t.locked:after {\n\t\t\tcontent: \"${lang.thread_locked}\";\n\t\t}\n\t\t.locked > header nav:after {\n\t\t\tcontent: \" (${lang.locked})\";\n\t\t}\n\t</style>`));\n\n_.extend(main, {\n\t// Cached DOM elements\n\t$threads: document.query('threads'),\n\t$name: document.query('input[name=name]'),\n\t$email: document.query('input[name=email]'),\n\n\tconnSM: new FSM('load'),\n\tpostSM: new FSM('none')\n});\n\n// 2nd tier dependacy modules. These are needed before the websocket\n// connection is opened, because they populate the dispatcher handler object.\n_.extend(main, {\n\tloop: require('./loop'),\n\ttime: require('./time'),\n\tamusement: require('./amusement')\n});\n\n// Load post models and views\nmain.posts = require('./posts')\nmain.Extract = require('./extract')\n// Start the client\nmain.client = require('./client')\nmain.conection = require('./connection')\n\n// Load independant auxilary modules\n_.extend(main, {\n\thistory: require('./history'),\n\thide: require('./hide')\n})\n\nmain.execDefered()\nmain.request('loading:hide')\n"]}