"use strict";System.register([],function(e){function n(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function t(e,n){if(e){var t=l.mine.readAll();for(var r in e)r in t&&s.request("repliedToMe",n)}}function r(e,n){var t=l.posts.get(e);t&&n(t)}var i,o,s,u,a,c,d,f,l,p;return{setters:[],execute:function(){o=function(){function e(e,n){var t=[],r=!0,i=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(r=(s=u.next()).done)&&(t.push(s.value),!n||t.length!==n);r=!0);}catch(a){i=!0,o=a}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=require("./main"),u=s._,a=s.common,c=s.dispatcher,d=s.util,f=s.posts,l=s.state,p=document.query("#onlineCount"),u.extend(c,(i={},n(i,a.INSERT_POST,function(e){var n=o(e,2),r=n[0],i=n[1];i=i&&l.page.get("live");var u=!r.op,a=r.num;u&&(l.syncs[a]=1),r.editing=!0;var c=void 0,d=r.nonce;delete r.nonce;var p=s.request("nonce:get")[d];if(p&&p.tab===l.page.get("tabID")){l.ownPosts[a]=!0,s.oneeSama.trigger("insertOwnPost",r),s.postSM.feed("alloc",r),i=!1,s.request("nonce:destroy",d);var g=s.request("postForm");g&&g.el&&(c=g.el)}p&&(r.mine=!0,l.mine.write(a)),l.addLinks(r.links);var v=new f.models[u?"Thread":"Post"](r),m=new f[u?"Section":"Article"]({model:v,el:c,id:a});if(c||m.render().insertIntoDOM(),m.clientInit(),t(r.links,a),s.request("post:inserted",v),!u){var I=l.posts.get(r.op);I&&(I.get("replies").push(a),l.page.get("thread")||(I.dispatch("shiftReplies"),i&&I.dispatch("bumpThread")))}}),n(i,a.INSERT_IMAGE,function(e){var n=o(e,2),t=n[0],i=n[1],u=s.request("postModel"),a=u&&u.get("num")==t;a&&s.request("postForm").insertUploaded(i),r(t,function(e){return e.setImage(i,a)})}),n(i,a.UPDATE_POST,function(e){var n=o(e,3),i=n[0],u=n[1],a=n[2],c=void 0===a?{}:a;r(i,function(e){l.addLinks(c.links),e.update(u,c),t(c.links,i),i in l.ownPosts?s.oneeSama.trigger("insertOwnPost",c):e.dispatch("updateBody",u)})}),n(i,a.FINISH_POST,function(e){var n=o(e,1),t=n[0];delete l.ownPosts[t],r(t,function(e){e.set("editing",!1),e.dispatch("renderEditing",!1)})}),n(i,a.DELETE_POSTS,function(e){r(e[0],function(n){return n.deletePost(e[1])})}),n(i,a.LOCK_THREAD,function(e){r(e[0],function(n){return n.toggleLocked(!0,e[1])})}),n(i,a.UNLOCK_THREAD,function(e){r(e[0],function(n){return n.toggleLocked(!1,e[1])})}),n(i,a.DELETE_IMAGES,function(e){r(e[0],function(n){return n.removeImage(e[1])})}),n(i,a.SPOILER_IMAGES,function(e){r(e[0],function(n){return n.setSpoiler(e[1],e[2])})}),n(i,a.BAN,function(e){var n=o(e,2),t=n[0],i=n[1];if(!t){if(!i)return;i=JSON.parse(i),t=i.num}r(t,function(e){return e.setBan(t,i)})}),n(i,a.BACKLINK,function(e){r(e[0],function(n){return n.addBacklink(e[1],e[2])})}),n(i,a.ONLINE_COUNT,function(e){p.textContent="["+e[0]+"]"}),n(i,a.HOT_INJECTION,function(e){var n=o(e,3),t=n[0],r=n[1],i=n[2];t||r===l.configHash?t&&(l.configHash=r,l.hotConfig.set(i)):s.send([a.HOT_INJECTION,!0])}),i)),c[a.SYNCHRONIZE]=s.connSM.feeder("sync"),c[a.INVALID]=s.connSM.feeder("invalid"),d.listener(document,"click","del",function(e){e.spoilt||(e.spoilt=!0,e.target.classList.toggle("reveal"))})}}});
//# sourceMappingURL=maps/client.js.map
