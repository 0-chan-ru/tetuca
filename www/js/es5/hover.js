"use strict";System.register([],function(e){var t,i,n,s,r,o,a,h,c,l,d,u,m;return{setters:[],execute:function(){t=require("./main"),i=t.posts.Article,n=t.$,s=t.Backbone,r=t.etc,o=t.options,a=t.state,h=new s.Model,c=s.View.extend({initialize:function(){var e=this;this.listenTo(this.model,"change:event",this.check),t.reply("imager:clicked",function(){return e.$el.empty()})},check:function(e,t){if(o.get("imageHover")){var i=n(t.target);if(!i.is("img")||i.hasClass("expanded"))return this.$el.children().remove("img,video");var s=i.closest("a").attr("href"),r=/\.webm$/.test(s);return/\.pdf$/.test(s)||/\.mp3$/.test(s)||r&&!o.get("webmHover")?this.$el.empty():void n(r?"<video/>":"<img/>",{src:s,autoplay:!0,loop:!0}).appendTo(this.$el.empty())}}}),l=i.extend({initialize:function(e){this.parentNum=e.parentNum,this.listenTo(this.model,"dispatch",this.redirect).render().$el.addClass("preview"),this.update()},update:function(){this.num||(this.num=r.getID(this.el)),m.render(this.$el,this.parentNum)}}),d=s.View.extend({initialize:function(){this.listenTo(this.model,"change:event",this.check)},check:function(e,t){var i=this,s=n(t.target);if(s.is("a.history")){var o=s.text().match(/^>>(\d+)/);if(o){var h=a.posts.get(o[1]);h&&(this.targetPos=s.offset(),this.previewView=new l({model:h,parentNum:r.getID(t.target)}),s.one("mouseleave click",function(){return i.remove()}))}}},remove:function(){this.previewView&&(this.targetPos=null,this.previewView.remove(),this.stopListening(this.previewView),this.$el.children().remove(".preview"),this.previewView=null)},render:function(e,t){e.find("a.history").filter(function(){return this.text.includes(">>"+t)}).each(function(){n(this).addClass("referenced")}),e.css(this.position(e)).appendTo(this.$el.empty())},position:function(e){e.hide(),n(document.body).append(e);var t=e.width(),i=e.height();e.detach().show();var s=n(window),r=this.targetPos.left-s.scrollLeft(),o=this.targetPos.top-s.scrollTop()-i-17;0>o&&(o+=i+34);var a=r+t-s.innerWidth();return a>-30&&(r=Math.max(0,r-a-30)),{left:r,top:o}}}),u=void 0,m=void 0,t.isMobile||t.defer(function(){t.$doc.on("mousemove",function(e){e.target!=u&&(h.set("event",e),u=e.target)});var e=document.getElementById("hover_overlay");new c({model:h,el:e}),m=new d({model:h,el:e})})}}});
//# sourceMappingURL=maps/hover.js.map
