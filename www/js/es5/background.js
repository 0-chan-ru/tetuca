"use strict";System.register([],function(e){function n(e,n){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}var r,a,t,o,i,d,g,s,c,l,u,h;return{setters:[],execute:function(){r=n(["#user_bg {\n				background: url(",") no-repeat fixed center;\n				background-size: cover;\n			}"],["#user_bg {\n				background: url(",") no-repeat fixed center;\n				background-size: cover;\n			}"]),a=n([".glass {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.glass.editing, .editing .background {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.background {\n				padding: 10px;\n				margin: 2px;\n			}"],[".glass {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.glass.editing, .editing .background {\n				background:\n					linear-gradient(",", ","),\n					url(",") center fixed no-repeat;\n				background-size: cover;\n			}\n			.background {\n				padding: 10px;\n				margin: 2px;\n			}"]),t=n(["<video autoplay loop ",'>\n				<source src="','" type="video/webm">\n				<source src="','" type="video/mp4">\n			</video>'],["<video autoplay loop ",'>\n				<source src="','" type="video/webm">\n				<source src="','" type="video/mp4">\n			</video>']),o=require("./main"),i=o.Backbone,d=o.common,g=o.etc,s=o.oneeSama,c=o.options,l=o.stackBlur,u=o.state,h=i.View.extend({tagName:"style",colourMap:{glass:{normal:"rgba(40, 42, 46, 0.5)",editing:"rgba(145, 145, 145, 0.5)"},ocean:{normal:"rgba(28, 29, 34, 0.781)",editing:"rgba(44, 57, 71, 0.88)"}},initialize:function(){document.head.append(this.el),document.body.append(g.parseDOM('<div id="user_bg"></div>')),this.render(),o.reply("background:store",this.store,this),this.listenTo(c,{"change:userBG":this.render,"change:illyaBGToggle":this.render,"change:illyaMuteToggle":this.render,"change:theme":this.render,workModeTOG:this.render})},store:function(e){var n=this;o.request("loading:show");var r=new FileReader;r.readAsDataURL(e.files[0]),r.onload=function(e){var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,r.width,r.height),localStorage.background=e.toDataURL("image/jpeg",.95),l.canvas(e,0,0,r.width,r.height,10),localStorage.blurred=e.toDataURL("image/jpeg",.95),o.request("loading:hide"),c.get("userBG")&&n.render()},r.src=e.target.result}},render:function(){var e=this.el;e.innerHTML="",c.get("illyaBGToggle")&&u.hotConfig.get("ILLYA_DANCE")?this.renderIllya():c.get("userBG")&&!o.oneeSama.workMode&&this.renderBackground()},renderBackground:function(){var e=localStorage.background;if(e){var n=d.parseHTML(r,e),a=o.oneeSama.workMode?u.hotConfig.get("DEFAULT_CSS"):c.get("theme");if("glass"===a||"ocean"===a){var t=localStorage,i=t.blurred;i&&(n+=" "+this.renderGlass(a,i))}this.el.innerHTML=n}},renderGlass:function(e,n){var r=this.colourMap[e],t=r.normal,o=r.editing;return d.parseHTML(a,t,t,n,o,o,n)},renderIllya:function(){var e=o.config.MEDIA_URL+"illya.";this.el.innerHTML=d.parseHTML(t,c.get("illyaMuteToggle")&&"muted",e+"webm",e+"mp4")}}),o.defer(function(){return module.exports=new h})}}});
//# sourceMappingURL=maps/background.js.map
