"use strict";System.register([],function(t){function e(t,e,n){e||(e={allowFullScreen:"true"}),e.allowScriptAccess="always";var a={autohide:1,fs:1,modestbranding:1,origin:document.location.origin,rel:0,showinfo:0};return n&&(a.start=n),e.autoplay&&(a.autoplay=e.autoplay),e.loop&&(a.loop="1",a.playlist=t),o("<iframe></iframe>",{type:"text/html",src:encodeURI("https://www.youtube.com/embed/"+t)+"?"+o.param(a),frameborder:"0",attr:r(),"class":"youtube-player"})}function r(){return window.screen&&screen.width<=320?{width:250,height:150}:{width:560,height:340}}function n(t,e,r){var n="https://soundcloud.com/oembed?url="+encodeURIComponent(t.getAttribute("href"))+("&maxwidth="+e+"&maxheight=166&auto_play=true&format=json")+"&show_comments=false",a=new XMLHttpRequest;a.open("GET",n),a.responseType="json",a.onload=function(){return 200!==this.status?r(this.status):void r(null,this.response)},a.send()}var a,o,i,s,u,d,c,h,l;return{setters:[],execute:function(){a=require("../main"),o=a.$,i=a.util,s=exports.youtube_url_re=/(?:>>>*?)?(?:https?:\/\/)?(?:www\.|m.)?youtube\.com\/watch\/?\?((?:[^\s#&=]+=[^\s#&]*&)*)?v=([\w-]{11})((?:&[^\s#&=]+=[^\s#&]*)*)&?(#t=[\dhms]{1,9})?/,u=exports.youtube_short_re=/(?:>>>*?)?(?:https?:\/\/)?(?:www\.|m.)?youtu.be\/([\w-]{11})\??(t=[\dhms]{1,9})?/,d=exports.youtube_time_re=/^#t=(?:(\d\d?)h)?(?:(\d{1,3})m)?(?:(\d{1,3})s)?$/,c=exports.youtube_short_time_re=/^t=(?:(\d\d?)h)?(?:(\d{1,3})m)?(?:(\d{1,3})s)?$/,a.$threads.on("click",".watch",function(t){function n(t,n,o){var i=0;if(n){var s=n.match(o);s&&(s[1]&&(i+=3600*parseInt(s[1],10)),s[2]&&(i+=60*parseInt(s[2],10)),s[3]&&(i+=parseInt(s[3],10)))}a.css("width",r().width).append("<br>",e(t,null,i))}if(!(t.which>1||t.metaKey||t.ctrlKey||t.altKey||t.shiftKey)){var a=o(t.target);if(a.is("a")){var i=a.find("iframe");if(i.length)return i.siblings("br").andSelf().remove(),a.css("width","auto"),!1;if(!a.data("noembed")){var h=a.attr("href").match(s);if(!h){if(h=a.attr("href").match(u),!h)return;n(h[1],h[2],c)}return n(h[2],h[4],d),!1}}}}),a.$threads.on("mouseenter",".watch",function(t){function e(t){var e=t&&t.data&&t.data.title;e?(n.textContent=a+": "+e,r.css({color:"black"})):n.textContent=a+" (gone?)",t&&t.data&&t.data.accessControl&&"denied"===t.data.accessControl.embed&&(n.textContent+=" (EMBEDDING DISABLED)",r.data("noembed",!0))}var r=o(t.target);if(!r.data("requestedTitle")){r.data("requestedTitle",!0);var n=r.contents().filter(function(){return 3===this.nodeType})[0];if(n){var a=n.textContent;n.textContent=a+"...";var i=r.attr("href").match(s);if(!i){if(i=r.attr("href").match(u),!i)return;o.ajax({url:"//gdata.youtube.com/feeds/api/videos/"+i[1],data:{v:"2",alt:"jsonc"},dataType:"json",success:e,error:function(){n.textContent=a+"???"}})}o.ajax({url:"//gdata.youtube.com/feeds/api/videos/"+i[2],data:{v:"2",alt:"jsonc"},dataType:"json",success:e,error:function(){n.textContent=a+"???"}})}}}),h=exports.soundcloud_url_re=/(?:>>>*?)?(?:https?:\/\/)?(?:www\.)?soundcloud\.com\/([\w-]{1,40}\/[\w-]{1,80})\/?/,a.$threads.on("click",".soundcloud",function(t){if(!(t.which>1||t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)){var e=t.target,r=e.query("iframe");if(t.preventDefault(),r)return r.previousElementSibling.remove(),void r.remove();var a=Math.round(.75*window.innerWidth);n(e,a,function(t,r){return t?alert(t):(e.append(document.createElement("br")),e.append(i.parseDOM(r.html)),void(e.style.width=a+"px"))})}}),a.$threads.on("mouseenter",".soundcloud:not(.fetched)",function(t){var e=t.target,r=e.firstChild,a=r.textContent;r.textContent=a+" ...",n(e,1e3,function(t,n){return t?r.textContent=a+": Error: "+t:(r.textContent=a+": "+n.title,e.style.color="black",void e.classList.add("fetched"))})}),l=exports.pastebin_re=/(?:>>>*?)?(?:https?:\/\/)?(?:www\.|m.)?pastebin\.com\/(.*)/,o(document).on("click",".pastebin",function(t){if(!(t.which>1||t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)){var e=o(t.target),r=e.find("iframe");if(r.length)return r.siblings("br").andSelf().remove(),e.css({width:"auto",height:"auto"}),!1;var n=e.attr("href").match(l);if(n){var a=o(window),i=Math.round(.65*a.innerWidth()),s=Math.round(.65*a.innerHeight());return e.css({width:i,height:s}).append("<br>",o("<iframe></iframe>",{type:"text/html",src:"https://pastebin.com/embed_iframe.php?i="+n[1],frameborder:"0",width:i,height:s})),!1}}})}}});
//# sourceMappingURL=../maps/posts/embed.js.map
