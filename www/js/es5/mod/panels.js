"use strict";System.register([],function(e){function t(e,t){var n="<table>",r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var l=o.value;n+="<tr>";var d=!0,u=!1,c=void 0;try{for(var h,m=t(l)[Symbol.iterator]();!(d=(h=m.next()).done);d=!0){var f=h.value;n+="<td>"+f+"</td>"}}catch(v){u=!0,c=v}finally{try{!d&&m["return"]&&m["return"]()}finally{if(u)throw c}}n+="</tr>"}}catch(v){i=!0,a=v}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw a}}return n+="</table>"}var n,r,i,a,o,s,l,d,u,c,h,m,f,v,p;return{setters:[],execute:function(){n=require("main"),r=n._,i=n.Backbone,a=n.common,o=n.dispatcher,s=n.etc,l=n.oneeSama,d=n.lang,u=n.modals,c=n.Memory,h=n.state,m=i.View.extend({className:"modal mod panel glass",initialize:function(){var e=this;this.$el.appendTo(n.$overlay),u[this.type]=this,o[this.kind]=function(t){return e.render(t[0])},n.send([this.kind])},render:function(e){return e.length?(this.el.innerHTML=this.renderContents(e),this.postRender&&this.postRender(),this.el.scrollTop=this.el.scrollHeight,this):this.el.innerHTML="God's in his Heaven. All's right with the world."},kill:function(){delete o[this.kind],delete u[this.type],this.remove()}}),f=m.extend({type:"log",kind:a.MOD_LOG,renderContents:function(e){return t(e,function(e){return[e.num?l.postRef(e.num,e.op):"",d.mod.formatLog(e),l.time(e.time)]})}}),exports.log=f,v=m.extend({type:"adminPanel",id:"adminPanel",kind:a.ADMIN_PANEL,events:{"click .unban":"unban"},renderContents:function(e){var n=this;return this.banCount=0,t(e,function(e){return n.banCount++,[l.mnemonic(e[0]),l.time(e[1]),'<a class="unban" data-id="'+e[0]+'">'+d.mod.unban+"</a>"]})},unban:function(e){var t=e.target;n.send([a.UNBAN,t.getAttribute("data-id")]),t.parentElement.parentElement.remove(),--this.banCount||this.kill()}}),exports.adminPanel=v,p=m.extend({type:"djPanel",events:{"click .close":"removeRequest","click #rescan":"scan"},initialize:function(){n.$overlay[0].append(this.el),u[this.type]=this,this.removed=new c("request",2),this.scan()},scan:function(){var e=this.removed.readAll(),t=[],n=!0,i=!1,a=void 0;try{for(var o,s=h.posts.models[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value.attributes;if(!(l.num in e)){var d=l.body.match(/\/r\/[^\n]+$/gm);if(d){var u=!0,c=!1,m=void 0;try{for(var f,v=d[Symbol.iterator]();!(u=(f=v.next()).done);u=!0){var p=f.value;p=p.replace("/r/","").trim(),t.push([l.num,l.mnemonic,p])}}catch(y){c=!0,m=y}finally{try{!u&&v["return"]&&v["return"]()}finally{if(c)throw m}}}}}}catch(y){i=!0,a=y}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return this.render(r.sortBy(t,1))},renderContents:function(e){return t(e,function(e){return[l.postRef(e[0],l.op).safe,l.mnemonic(e[1]),e[2],'<a class="close" data-id="'+e[0]+'">X</a>']})},postRender:function(){this.el.append(s.parseDOM('<a id="rescan">'+d.rescan+"</a>")[0])},removeRequest:function(e){e.preventDefault();var t=e.target;this.removed.write(t.getAttribute("data-id")),t.closest("tr").remove()}}),exports.djPanel=p}}});
//# sourceMappingURL=../maps/mod/panels.js.map
