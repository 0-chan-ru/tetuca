{"version":3,"sources":["options/opts.js"],"names":["System","register","_export","_context","toggleHeadStyle","id","css","toggle","document","getElementById","head","appendChild","parseEl","disabled","Cookie","thumbStyles","resonableLastN","config","isMobile","langApplied","notMobile","opts","_arr","_i","engine","shorts","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_iterator","_step","short","setters","_jsCookie","_util","_state","_lang","execute","type","lang","enabled","tab","default","execOnStart","exec","alert","location","reload","load","notifToggle","Notification","permission","requestPermission","radio","send","illyaDance","defaultCSS","theme","setAttribute","upload","validation","length","push","undefined","Symbol","iterator","next","done","value","err"],"mappings":"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","file":"options/opts.js","sourcesContent":["import * as Cookie from 'js-cookie'\nimport {thumbStyles, resonableLastN, parseEl} from '../util'\nimport {config, isMobile} from '../state'\nimport {langApplied} from 'lang'\n\n// TODO: Send function\n\n/*\n * Full schema of the option interface\n *\n * - id: Identifier of the option. Used for DOM element and localStorage tagging\n * - type: 'checkbox'/'number'/'image'/'shortCut'/array of options\n *\tarrays become a selection list. Defaults to 'checkbox', if omitted.\n * - default: Default value. false, if omitted.\n * - tab: Index of the tab the option belong to.\n * - exec: Function to execute on option change.\n * - execOnStart: Boolean. Should the function be executed on model population?\n *\tDefaults to true.\n * - load: Condition to display and execute the option. Defaults to true(always)\n * - validation: Function that validates the users input. Returns a boolean.\n * - hidden: If true this option won't be shown to the user. Defaults to false\n *\n * Tooltips and lables are defined per language in `lang/`.\n * All arguments except for `id` and `tab` are optional.\n */\n\nconst notMobile = !isMobile\n\nconst opts = [\n\t// LANGUAGE SELECTION\n\t{\n\t\tid: 'lang',\n\t\ttype: config.lang.enabled,\n\t\ttab: 0,\n\t\tdefault: config.lang.default,\n\t\texecOnStart: false,\n\t\texec(type) {\n\t\t\talert(langApplied)\n\t\t\tlocation.reload()\n\t\t}\n\t},\n\t// INLINE EXPANSION\n\t{\n\t\tid: 'inlinefit',\n\t\ttype: ['none', 'full', 'width', 'height', 'both'],\n\t\ttab: 1,\n\t\tdefault: 'width'\n\t},\n\t// THUMBNAIL MODE\n\t{\n\t\tid: 'thumbs',\n\t\ttype: thumbStyles,\n\t\ttab: 1,\n\t\tdefault: 'small'\n\t},\n\t// IMAGE HOVER EXPANSION\n\t{\n\t\tid: 'imageHover',\n\t\tdefault: true,\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t{\n\t\tid: 'webmHover',\n\t\tload: notMobile,\n\t\ttab: 0\n\t},\n\t// Autogif TOGGLE\n\t{\n\t\tid: 'autogif',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t// SPOILER TOGGLE\n\t{\n\t\tid: 'spoilers',\n\t\ttab: 1,\n\t\tdefault: true\n\t},\n\t// LINKIFY TEXT URLS\n\t{\n\t\tid: 'linkify',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// DESKTOP NOTIFICATIONS\n\t{\n\t\tid: 'notification',\n\t\tload: notMobile,\n\t\ttab: 0,\n\t\texec(notifToggle) {\n\t\t\tif (notifToggle && (Notification.permission !== \"granted\"))\n\t\t\t\tNotification.requestPermission()\n\t\t}\n\t},\n\t// ANONIMISE ALL POSTER NAMES\n\t{\n\t\tid: 'anonymise',\n\t\ttab: 0\n\t},\n\t// RELATIVE POST TIMESTAMPS\n\t{\n\t\tid: 'relativeTime',\n\t\ttab: 0,\n\t\tdefault: true\n\t},\n\t// R/A/DIO NOW PLAYING BANNER\n\t{\n\t\tid: 'nowPlaying',\n\t\tload: notMobile && config.radio,\n\t\ttab: 3,\n\t\tdefault: true,\n\t\texec(toggle) {\n\t\t\tif (toggle) {\n\t\t\t\t// Query the server for current stream info\n\t\t\t\tsend({type: 'radio'})\n\t\t\t} else {\n\n\t\t\t\t// TODO: System.import().then()\n\t\t\t\t//events.request('banner:radio:clear');\n\t\t\t}\n\t\t}\n\t},\n\t// ILLYA DANCE\n\t{\n\t\tid: 'illyaBGToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t{\n\t\tid: 'illyaMuteToggle',\n\t\tload: notMobile && config.illyaDance,\n\t\ttab: 3\n\t},\n\t// HORIZONTAL POSTING\n\t{\n\t\tid: 'horizontalPosting',\n\t\ttab: 3,\n\t\texec: toggleHeadStyle(\n\t\t\t'horizontal',\n\t\t\t'article,aside{display:inline-block;}'\n\t\t)\n\t},\n\t// REPLY AT RIGHT\n\t{\n\t\tid: 'replyright',\n\t\ttab: 1,\n\t\texec: toggleHeadStyle(\n\t\t\t'reply-at-right',\n\t\t\t'section>aside{margin: -26px 0 2px auto;}'\n\t\t)\n\t},\n\t// THEMES\n\t{\n\t\tid: 'theme',\n\t\ttype: [\n\t\t\t'moe', 'gar', 'mawaru', 'moon', 'ashita', 'console', 'tea',\n\t\t\t'higan', 'ocean', 'rave', 'tavern', 'glass'\n\t\t],\n\t\ttab: 1,\n\t\tdefault: config.defaultCSS,\n\t\texecOnStart: false,\n\t\texec(theme) {\n\t\t\tif (!theme) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tdocument.getElementById('theme')\n\t\t\t\t.setAttribute(\n\t\t\t\t\t'href',\n\t\t\t\t\t`/ass/css/${theme}.css`\n\t\t\t\t)\n\t\t}\n\t},\n\t// CUSTOM USER-SET BACKGROUND\n\t{\n\t\tid: 'userBG',\n\t\tload: notMobile,\n\t\ttab: 1\n\t},\n\t{\n\t\tid: 'userBGimage',\n\t\tload: notMobile,\n\t\ttype: 'image',\n\t\ttab: 1,\n\t\texecOnStart: false,\n\t\texec(upload) {\n\t\t\t// TODO: System.import().then()\n\t\t\t//events.request('background:store', upload)\n\t\t}\n\t},\n\t// LAST N CONFIG\n\t{\n\t\tid: 'lastn',\n\t\ttype: 'number',\n\t\ttab: 0,\n\t\tvalidation: resonableLastN,\n\t\tdefault: 100\n\t},\n\t// KEEP THREAD LENGTH WITHIN LASTN\n\t/*\n\t Disabled, until dependancy features are implemnted (see issue #280)\n\t{\n\t\tid: 'postUnloading',\n\t\ttab: 0\n\t},*/\n\t// LOCK TO BOTTOM EVEN WHEN DOCUMENT HIDDEN\n\t{\n\t\tid: 'alwaysLock',\n\t\ttab: 0\n\t}\n]\n\n// IMAGE SEARCH LINK TOGGLE\nfor (let engine of ['google', 'iqdb', 'saucenao', 'desustorage', 'exhentai']) {\n\topts.push({\n\t\tid: engine,\n\t\t// Use a custom internatiolisation function\n\t\tlang: 'imageSearch',\n\t\ttab: 2,\n\t\tdefault: engine === 'google',\n\t\texec: toggleHeadStyle(engine + 'Toggle', `.${engine}{display:initial;}`)\n\t})\n}\n\n// SHORTCUT KEYS\nconst shorts = [\n\t{id: 'new', default: 78},\n\t{id: 'togglespoiler', default: 73},\n\t{id: 'textSpoiler', default: 68},\n\t{id: 'done', default: 83},\n\t{id: 'expandAll', default: 69},\n\t{id: 'workMode', default: 66}\n]\nfor (let short of shorts) {\n\tshort.type = 'shortcut'\n\tshort.tab = 4\n\tshort.load = notMobile\n\topts.push(short)\n}\n\n/**\n * Create a function to append and toggle a style element in <head>\n */\nfunction toggleHeadStyle(id, css) {\n\treturn toggle => {\n\t\tif (!document.getElementById(id)) {\n\t\t\tdocument.head.appendChild(\n\t\t\t\tparseEl(`<style id=\"${id}\">${css}</style>`)\n\t\t\t)\n\t\t}\n\n\t\t// The disabled property only exists on elements in the DOM, so we do\n\t\t// another query\n\t\tdocument.getElementById(id).disabled = !toggle\n\t}\n}\n\n/**\n * Exports the generated option model templates\n */\nexport default opts\n"],"sourceRoot":"/source/"}