{"version":3,"sources":["options/view.js"],"names":["System","register","_export","_context","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","BannerModal","renderContents","optionModels","each","find","options","_importConfigs","defer","_createClass","OptionsPanel","setters","_modal","_render","_models","_vendorUnderscore","_options","_lang","importConfigs","_defer","execute","defineProperties","target","props","i","length","descriptor","defineProperty","key","protoProps","staticProps","_BannerModal","this","_this","getPrototypeOf","id","onClick",".tab_link","#export","#import","#hidden","onAll","el","innerHTML","assignValues","hidden","query","model","type","val","get","checked","Array","String","fromCharCode","toUpperCase","event","preventDefault","children","classList","remove","add","lastChild","li","contains","getAttribute","undefined","parseInt","charCodeAt","validate","set","a","document","getElementById","setAttribute","window","URL","createObjectURL","Blob","JSON","stringify","localStorage","click","util","once","reader","FileReader","readAsText","input","files","onload","json","parse","result","err","alert","corrupt","clear","location","reload","count","textContent","replace","main","request","renderHidden","tick","clicked","style","opacity","out","now","requestAnimationFrame","optionsSeen","addEventListener"],"mappings":"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","file":"options/view.js","sourcesContent":["'use strict';System.register(['../modal','./render','./models','../../vendor/underscore','../options','lang','../defer'],function(_export,_context){var BannerModal,renderContents,optionModels,each,find,options,_importConfigs,defer,_createClass,OptionsPanel;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}return {setters:[function(_modal){BannerModal=_modal.BannerModal;},function(_render){renderContents=_render.default;},function(_models){optionModels=_models.optionModels;},function(_vendorUnderscore){each=_vendorUnderscore.each;find=_vendorUnderscore.find;},function(_options){options=_options.default;},function(_lang){_importConfigs=_lang.importConfigs;},function(_defer){defer=_defer.defer;}],execute:function(){_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\" in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();OptionsPanel=function(_BannerModal){_inherits(OptionsPanel,_BannerModal);function OptionsPanel(){_classCallCheck(this,OptionsPanel);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(OptionsPanel).call(this,{id:'options-panel'}));_this.onClick({'.tab_link':'switchTab','#export':'exportConfigs','#import':'importConfigs','#hidden':'clearHidden'});_this.onAll('change','applyChange');return _this;}_createClass(OptionsPanel,[{key:'render',value:function render(){this.el.innerHTML=renderContents();this.assignValues();this.hidden=this.el.query('#hidden');}},{key:'assignValues',value:function assignValues(){for(var id in optionModels){var model=optionModels[id],el=this.el.query('#'+id);var type=model.type;var val=model.get();if(type==='checkbox'){el.checked=val;}else if(type==='number'||type instanceof Array){el.value=val;}else if(type==='shortcut'){el.value=String.fromCharCode(val).toUpperCase();}}}},{key:'switchTab',value:function switchTab(event){event.preventDefault();var el=event.target;each(this.el.children,function(el){return el.query('.tab_sel').classList.remove('tab_sel');});el.classList.add('tab_sel');find(this.el.lastChild.children,function(li){return li.classList.contains(el.getAttribute('data-content'));}).classList.add('tab_sel');}},{key:'applyChange',value:function applyChange(event){var el=event.target,id=el.getAttribute('id'),model=optionModels[id];var val=undefined;switch(model.type){case 'checkbox':val=el.checked;break;case 'number':val=parseInt(el.value);break;case 'shortcut':val=el.value.toUpperCase().charCodeAt(0);break;default:val=el.value;}if(!model.validate(val)){el.value='';}else {options.set(id,val);}}},{key:'exportConfigs',value:function exportConfigs(){var a=document.getElementById('export');a.setAttribute('href',window.URL.createObjectURL(new Blob([JSON.stringify(localStorage)],{type:'octet/stream'})));a.setAttribute('download','meguca-config.json');}},{key:'importConfigs',value:function importConfigs(event){event.preventDefault();var el=document.query('#importSettings');el.click();util.once(el,'change',function(){var reader=new FileReader();reader.readAsText(input.files[0]);reader.onload=function(event){var json=undefined;try{json=JSON.parse(event.target.result);}catch(err){alert(_importConfigs.corrupt);return;}localStorage.clear();for(var key in json){localStorage[key]=json[key];}alert(_importConfigs.corrupt);location.reload();};});}},{key:'renderHidden',value:function renderHidden(count){var el=this.hidden;el.textContent=el.textContent.replace(/\\d+$/,count);}},{key:'clearHidden',value:function clearHidden(){main.request('hide:clear');this.renderHidden(0);}}]);return OptionsPanel;}(BannerModal);_export('default',OptionsPanel);(function(){if(localStorage.optionsSeen){return;}var el=document.query('#options');el.style.opacity=1;var out=true,clicked=undefined;el.addEventListener(\"click\",function(){clicked=true;localStorage.optionsSeen=1;});tick();function tick(){if(clicked){el.style.opacity=1;return;}el.style.opacity=+el.style.opacity+(out?-0.02:0.02);var now=+el.style.opacity;if(out&&now<=0||!out&&now>=1){out=!out;}requestAnimationFrame(tick);}})();}};});"],"sourceRoot":"/source/"}