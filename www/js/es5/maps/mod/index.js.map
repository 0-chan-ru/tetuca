{"version":3,"sources":["mod/index.js"],"names":["System","register","_export","_context","main","$","config","ident","staff","setters","execute","require","window","IDENT","loggedInUser","email","x_csrf","csrf","$overlay","appendTo","modals","rel","href","MEDIA_URL","cssHash","STAFF_BOARD","children","last","after"],"mappings":"AAAA,YAAaA,QAAOC,YAAY,SAASC,EAAQC,GAAU,GAAIC,GAAKC,EAAEC,EAAOC,EAAMC,CAAM,QAAQC,WAAWC,QAAQ,WAI9GN,EAAOO,QAAQ,QACnBN,EAAaD,EAAbC,EAAGC,EAAUF,EAAVE,OAMCC,EAAQH,EAAKG,MAAQK,OAAOC,MAGlCD,OAAOE,aAAeP,EAAMQ,MAC5BH,OAAOI,OAAST,EAAMU,KAGtBb,EAAKc,SAAWb,EAAE,+BAA+Bc,SAAS,QAG1Df,EAAKgB,UAELT,QAAQ,WACRA,QAAQ,aAERN,EAAE,WACDgB,IAAK,aACLC,KAAShB,EAAOiB,UAAP,iBAAiCnB,EAAKoB,UAC7CL,SAAS,QAGNX,EAAQF,EAAOmB,YACrBpB,EAAE,WACAqB,SAAS,KACTC,OACAC,MAHF,gBAGwBpB,EAAA,sBAA2BA,EAAA","file":"mod/index.js","sourcesContent":["/*\nClient-side administration logic\n */\n\nconst main = require('main'),\n\t{$, config} = main;\n\n//XXX: This module in general is not very DRY. Need to refactor later.\n\n// Only used to affect some client rendering practises. Anything actually\n// needing security has stricter authorisation checks.\nconst ident = main.ident = window.IDENT;\n\n// Pass login status to ./www/js/login.js\nwindow.loggedInUser = ident.email;\nwindow.x_csrf = ident.csrf;\n\n// Container for all moderation modals\nmain.$overlay = $('<div id=\"modOverlay\"></div>').appendTo('body');\n\n// Open modal map\nmain.modals = {};\n\nrequire('./title');\nrequire('./toolbox');\n\n$('<link/>', {\n\trel: 'stylesheet',\n\thref: `${config.MEDIA_URL}css/mod.css?v=${main.cssHash}`\n}).appendTo('head');\n\n// Add staff board to board navigation\nconst staff = config.STAFF_BOARD;\n$('#navTop')\n\t.children('a')\n\t.last()\n\t.after(` / <a href=\"/${staff}/\" class=\"history\">${staff}</a>`);\n"],"sourceRoot":"/source/"}