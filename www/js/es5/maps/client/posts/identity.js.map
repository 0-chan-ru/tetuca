{"version":3,"sources":["client/posts/identity.js"],"names":["System","register","_export","_context","load","id","JSON","parse","localStorage","ident","name","$name","val","email","$email","e","propagate","postForm","main","request","renderIdentity","save","$","$script","_","common","config","setters","execute","require","debounce","LOGIN_KEYWORD","stringify","removeItem","defer","on"],"mappings":"AAAA,YAAaA,QAAOC,YAAY,SAASC,EAAQC,GAOjD,QAASC,KACR,IACC,GAAMC,GAAKC,KAAKC,MAAMC,aAAaC,MAC/BJ,GAAGK,MACNC,EAAMC,IAAIP,EAAGK,MACVL,EAAGQ,OACNC,EAAOF,IAAIP,EAAGQ,OALhB,MAOME,KARP,QAqCSC,KACR,GAAIC,GAAWC,EAAKC,QAAQ,WACxBF,IACHA,EAASG,iBADVC,IA9C0D,GAAIH,GAAKI,EAAEC,EAAQT,EAAOH,EAAMa,EAAEC,EAAOC,EAAOL,CA4C3G,QAAAM,WAAAC,QAAA,WAxCIV,EAAOW,QAAQ,WACjBP,EAAgDJ,EAAhDI,EAAGC,EAA6CL,EAA7CK,QAAST,EAAoCI,EAApCJ,OAAQH,EAA4BO,EAA5BP,MAAOa,EAAqBN,EAArBM,EAAGC,EAAkBP,EAAlBO,OAAQC,EAAUR,EAAVQ,OAapCL,EAAOG,EAAEM,SAAS,WACrB,IACC,GAAMpB,GAAOC,EAAMC,MACfC,EAAQC,EAAOF,KAEnB,IAAIC,IAAUa,EAAOK,gBACpBjB,EAAOF,IAAI,IADwBW,EAE3B,4BAF2BV,GAG3B,GAGLH,GAAQG,EAAO,CAClB,GAAIR,KACAK,KACHL,EAAGK,KAAOA,GACPG,IACHR,EAAGQ,MAAQA,GADZL,aAEaC,MAAQH,KAAK0B,UAAU3B,OAGpCG,cAAayB,WAAW,SAnB1B,MAqBMlB,MACJ,KAUHG,EAAKgB,MAAM,WACV9B,IADqBO,EAEfwB,GAAG,QAASnB,GAFGF,EAGdqB,GAAG,QAASnB","file":"client/posts/identity.js","sourcesContent":["/*\n Name, email, tripcode and staff title persistence and postform propagation\n */\n\nlet main = require('../main'),\n\t{$, $script, $email, $name, _, common, config} = main;\n\nfunction load() {\n\ttry {\n\t\tconst id = JSON.parse(localStorage.ident);\n\t\tif (id.name)\n\t\t\t$name.val(id.name);\n\t\tif (id.email)\n\t\t\t$email.val(id.email);\n\t}\n\tcatch(e) {}\n}\n\nlet save = _.debounce(function() {\n\ttry {\n\t\tconst name = $name.val();\n\t\tlet email = $email.val();\n\t\t// Staff login method\n\t\tif (email === config.LOGIN_KEYWORD) {\n\t\t\t$email.val('');\n\t\t\t$script('/ass/js/scripts/login.js');\n\t\t\temail = false;\n\t\t}\n\n\t\tif (name || email) {\n\t\t\tlet id = {};\n\t\t\tif (name)\n\t\t\t\tid.name = name;\n\t\t\tif (email)\n\t\t\t\tid.email = email;\n\t\t\tlocalStorage.ident = JSON.stringify(id);\n\t\t}\n\t\telse\n\t\t\tlocalStorage.removeItem('ident');\n\t}\n\tcatch(e) {}\n}, 1000);\n\n// Sync persistance and postForm with input changes\nfunction propagate() {\n\tlet postForm = main.request('postForm');\n\tif (postForm)\n\t\tpostForm.renderIdentity();\n\tsave();\n}\n\nmain.defer(function() {\n\tload();\n\t$name.on('input', propagate);\n\t$email.on('input', propagate);\n});\n"],"sourceRoot":"/source/"}