"use strict";System.register(["../vendor/underscore","../vendor/js-cookie"],function(e,t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i,n,o,u,a,s;return{setters:[function(e){i=e.isObject,n=e.isEmpty,o=e.size},function(e){u=e}],execute:function(){a=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),s=function(){function e(t,i,n){var o=this;r(this,e),this.key=t,this.expiry=i,this.needCookie=n,setTimeout(function(){return o.purgeExpired()},5e3)}return a(e,[{key:"bakeCookie",value:function(e){if(this.needCookie){var t=Object.keys(e);t.sort(function(e,t){return parseInt(e,10)-parseInt(t,10)}),u.set(this.key,t.join("/"))}}},{key:"now",value:function(){return Math.floor(Date.now()/1e3)}},{key:"purgeAll",value:function(){localStorage.removeItem(this.key),this.needCookie&&u.remove(this.key)}},{key:"readAll",value:function(){var e=localStorage.getItem(this.key);if(!e)return{};var t=void 0;try{t=JSON.parse(e)}catch(r){}return i(t)?t:{}}},{key:"writeAll",value:function(e){return n(e)?this.purgeAll():(localStorage.setItem(this.key,JSON.stringify(e)),void this.bakeCookie(e))}},{key:"write",value:function(e){var t=this.readAll();return t[e]=this.now(),this.writeAll(t),o(t)}},{key:"size",value:function(){return o(this.readAll())}},{key:"purgeExpired",value:function(){if(this.expiry){var e=this.readAll(),t=this.now(),r=86400*this.expiry,i=[];for(var n in e){var o=e[n];o&&t>o+r&&i.push(n)}if(i.length){for(var u=0,a=i.length;a>u;u++)delete e[i[u]];this.writeAll(e)}}}}]),e}(),e("default",s)}}});
//# sourceMappingURL=maps/memory.js.map
