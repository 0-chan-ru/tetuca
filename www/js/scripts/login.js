!function(){function o(o,n){i.text(o),s.toggleClass("orange","orange"==n),s.toggleClass("dark","dark"==n)}function n(){window.loggedInUser?(o("Logout","blue"),s.click(function(o){navigator.id.logout(),o.preventDefault()})):(o("Invoke your Persona","orange"),s.click(function(o){navigator.id.request(),o.preventDefault()})),s.focus()}function e(n){o("Invoking...","dark"),a.ajax({type:"POST",url:"../login",data:{assertion:n},dataType:"json",headers:{"Access-Control-Allow-Credentials":!0},success:function(n){n&&"okay"==n.status?(o("Success!","blue"),window.location.reload(!0)):o(n.message||"Unknown error.","dark")},error:function(n){o("Network error.","dark"),console.error(n)}})}function r(){o("Logging out...","dark"),a.ajax({type:"POST",url:"../logout",data:{csrf:window.x_csrf},dataType:"json",headers:{"Access-Control-Allow-Credentials":!0},success:function(n){n&&"okay"==n.status?(o("Logged out.","orange"),window.location.reload(!0)):o(n.message||"Unknown error.","dark")},error:function(n){o("Network error.","dark"),console.error(n)}})}var a=require("jquery"),t=require("scriptjs"),s=a("<a></a>",{href:"#",id:"login-button","class":"persona-button dark",css:{"margin-top":"0.5em"}}),i=a("<span>Loading...</span>").appendTo(s);s.appendTo("#identity"),t("https://login.persona.org/include.js?v="+imports.clientHash,function(){n(),navigator.id.watch({loggedInUser:window.loggedInUser||null,onlogin:e,onlogout:r})}),a("<link/>",{rel:"stylesheet",href:imports.config.MEDIA_URL+"css/persona-buttons.css?v="+imports.clientHash}).appendTo("head")}();
//# sourceMappingURL=maps/login.js.map
