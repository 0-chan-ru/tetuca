{"version":3,"sources":["loaderCommon.js"],"names":["check","func","eval","e","tests","legacy","i","length","this","initModuleLoader","cb","Promise","resolve","reject","meta","format","lang","System","config","baseURL","defaultJSExtensions","map","underscore","js-cookie","then","err"],"mappings":"CAIA,WAEC,QAASA,OAAMC,MACd,IACC,MAAOC,MAAK,eAAiBD,KAAO,SAErC,MAAME,GACL,OAAO,GA+BT,IAAK,GA3BDC,QAEH,wBAEA,uEAEA,oEAEA,yCAEA,iDAEA,6DAEA,0DAEA,sCAEA,2DAEA,8KAMGC,OACKC,EAAI,EAAGA,EAAIF,MAAMG,OAAQD,IACjC,IAAKN,MAAMI,MAAME,IAAK,CAErBD,QAAS,CACT,OAIFG,KAAKC,iBAAmB,SAAUC,GACjC,MAAO,IAAIC,SAAQ,SAAUC,EAASC,GAErC,GAAIC,KACJA,GAAK,SAAWA,EAAK,UAAYC,OAAQ,WAIzC,IAAIC,GAAO,aAEVA,GADGX,OACI,MAAQW,EAER,MAAQA,EAGhBC,OAAOC,QACNC,QAAS,UACTC,qBAAqB,EACrBC,KACCL,KAAMA,EACNM,WAAY,oBACZC,YAAa,oBAEdT,KAAMA,IAIHT,OACHY,OAAAA,UAAc,iBAAiBO,KAAK,WACnCZ,EAAQP,SACN,SAAUoB,GACZZ,EAAOY,KAGRb,EAAQP","file":"loaderCommon.js","sourcesContent":["/*\n Detects ES6 features and initialzes the module loader\n*/\n\n(function () {\n\t// Check for browser compatibility by trying to detect some ES6 features\n\tfunction check(func) {\n\t\ttry {\n\t\t\treturn eval('(function(){' + func + '})();')\n\t\t}\n\t\tcatch(e) {\n\t\t\treturn false\n\t\t}\n\t}\n\n\tvar tests = [\n\t\t// Arrow functions\n\t\t'return (()=>5)()===5;',\n\t\t// Block scopped const\n\t\t'\"use strict\";  const bar = 123; {const bar = 456;} return bar===123;',\n\t\t// Block-scoped let\n\t\t'\"use strict\"; let bar = 123;{ let bar = 456; }return bar === 123;',\n\t\t// Computed object properties\n\t\t\"var x='y';return ({ [x]: 1 }).y === 1;\",\n\t\t// Shorthand object properties\n\t\t\"var a=7,b=8,c={a,b};return c.a===7 && c.b===8;\",\n\t\t// Template strings\n\t\t'var a = \"ba\"; return `foo bar${a + \"z\"}` === \"foo barbaz\";',\n\t\t// for...of\n\t\t'var arr = [5]; for (var item of arr) return item === 5;',\n\t\t// Spread operator\n\t\t'return Math.max(...[1, 2, 3]) === 3',\n\t\t// Class statement\n\t\t'\"use strict\"; class C {}; return typeof C === \"function\"',\n\t\t// Super call\n\t\t'\"use strict\"; var passed = false;'\n\t\t\t+ 'class B {constructor(a) {  passed = (a === \"barbaz\")}};'\n\t\t\t+ 'class C extends B {constructor(a) {super(\"bar\" + a)}};'\n\t\t\t+ 'new C(\"baz\"); return passed;'\n\t]\n\n\tvar legacy\n\tfor (var i = 0; i < tests.length; i++) {\n\t\tif (!check(tests[i])) {\n\t\t\t// Load client with full ES5 compliance\n\t\t\tlegacy = true\n\t\t\tbreak\n\t\t}\n\t}\n\n\tthis.initModuleLoader = function (cb) {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\t// Load all client modules as precompiled System.register format modules\n\t\t\tvar meta = {}\n\t\t\tmeta['es5/*'] = meta['es6/*'] = {format: 'register'}\n\n\t\t\t// Alias the appropriate language pack to \"lang\"\n\t\t\t// TODO: Properly detect language, in some way\n\t\t\tvar lang = '/lang/' + \"en_GB\"\n\t\t\tif (legacy) {\n\t\t\t\tlang = 'es5' + lang\n\t\t\t} else {\n\t\t\t\tlang = 'es6' + lang\n\t\t\t}\n\n\t\t\tSystem.config({\n\t\t\t\tbaseURL: '/ass/js',\n\t\t\t\tdefaultJSExtensions: true,\n\t\t\t\tmap: {\n\t\t\t\t\tlang: lang,\n\t\t\t\t\tunderscore: 'vendor/underscore',\n\t\t\t\t\t'js-cookie': 'vendor/js-cookie'\n\t\t\t\t},\n\t\t\t\tmeta: meta\n\t\t\t})\n\n\t\t\t// Load core-js polyfill, if above tests fail\n\t\t\tif (legacy) {\n\t\t\t\tSystem.import('vendor/corejs').then(function () {\n\t\t\t\t\tresolve(legacy)\n\t\t\t\t}, function (err) {\n\t\t\t\t\treject(err)\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tresolve(legacy)\n\t\t\t}\n\t\t})\n\t}\n})()\n"],"sourceRoot":"/source/"}